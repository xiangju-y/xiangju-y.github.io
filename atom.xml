<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>相聚就是缘</title>
  
  <subtitle>生活不是一成不变的，而是不断在变化中寻找平衡</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-12-19T21:33:12.662Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>相聚就是缘</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/11/12/linux/gitlab/docker%20gitlab+%20gitlab-runnce%E9%83%A8%E7%BD%B2/"/>
    <id>http://example.com/2024/11/12/linux/gitlab/docker%20gitlab+%20gitlab-runnce%E9%83%A8%E7%BD%B2/</id>
    <published>2024-11-12T14:30:54.162Z</published>
    <updated>2024-12-19T21:33:12.662Z</updated>
    
    <content type="html"><![CDATA[<h1 id="docker-安装gitlab-gitlab-runnce并配置gitlab-pages"><a href="#docker-安装gitlab-gitlab-runnce并配置gitlab-pages" class="headerlink" title="docker 安装gitlab+gitlab-runnce并配置gitlab-pages"></a>docker 安装gitlab+gitlab-runnce并配置gitlab-pages</h1><blockquote><p>gitalb_pages需要两个网络,这里使用docker进行gitlab的安装</p></blockquote><h1 id="docker-gitlab-runnce安装"><a href="#docker-gitlab-runnce安装" class="headerlink" title="docker  gitlab-runnce安装"></a>docker  gitlab-runnce安装</h1><p>docker network create –subnet&#x3D;172.100.0.0&#x2F;24 gitlab-net</p><p>docker run <br>  -itd <br>  -p 9980:80 <br>  -p 9922:22 <br>  -p 8090:8090 <br>  –network gitlab-net –ip 172.100.0.100 <br>  -v &#x2F;home&#x2F;gitlab&#x2F;etc:&#x2F;etc&#x2F;gitlab <br>  -v &#x2F;home&#x2F;gitlab&#x2F;log:&#x2F;var&#x2F;log&#x2F;gitlab <br>  -v &#x2F;home&#x2F;gitlab&#x2F;opt:&#x2F;var&#x2F;opt&#x2F;gitlab <br>  –restart always <br>  –privileged&#x3D;true <br>  –name gitlab <br>  gitlab&#x2F;gitlab-ce</p><p>docker network create –subnet&#x3D;172.100.1.0&#x2F;24 gitlab-net-secondary</p><p>docker network connect –ip 172.100.1.100 gitlab-net-secondary gitlab</p><p>docker run -d –name gitlab-runner –restart always <br>–network gitlab-net –ip 172.100.0.101 <br>  -p 8093:8093<br>  -v &#x2F;srv&#x2F;gitlab-runner&#x2F;config:&#x2F;etc&#x2F;gitlab-runner <br>  -v &#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock <br>  gitlab&#x2F;gitlab-runner:latest</p><p>docker exec -it gitlab ip addr show</p><p>docker exec -it gitlab-runner ip addr show</p><p>docker exec -it gitlab &#x2F;bin&#x2F;bash</p><h1 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h1><p>vi &#x2F;home&#x2F;gitlab&#x2F;etc&#x2F;gitlab.rb</p><h1 id="修改端口"><a href="#修改端口" class="headerlink" title="修改端口"></a>修改端口</h1><p>external_url ‘<a href="http://192.168.6.128:9980/">http://192.168.6.128:9980</a>‘</p><p>docker exec -it gitlab-runner &#x2F;bin&#x2F;bash<br>apt update -y<br>apt install vim -y<br>gitlab-runner register  –url <a href="http://172.100.0.100/">http://172.100.0.100</a>  –token glrt-S3Nxw3hq_W1kV-Jyzw9t</p><p>clone_url &#x3D; “<a href="http://172.100.0.100/">http://172.100.0.100</a>“</p><p>86074607129073</p><p>root@9820317c2e98:&#x2F;# cat &#x2F;etc&#x2F;gitlab&#x2F;initial_root_password </p><h1 id="WARNING-This-value-is-valid-only-in-the-following-conditions"><a href="#WARNING-This-value-is-valid-only-in-the-following-conditions" class="headerlink" title="WARNING: This value is valid only in the following conditions"></a>WARNING: This value is valid only in the following conditions</h1><h1 id="1-If-provided-manually-either-via-GITLAB-ROOT-PASSWORD-environment-variable-or-via-gitlab-rails-initial-root-password-setting-in-gitlab-rb-it-was-provided-before-database-was-seeded-for-the-first-time-usually-the-first-reconfigure-run"><a href="#1-If-provided-manually-either-via-GITLAB-ROOT-PASSWORD-environment-variable-or-via-gitlab-rails-initial-root-password-setting-in-gitlab-rb-it-was-provided-before-database-was-seeded-for-the-first-time-usually-the-first-reconfigure-run" class="headerlink" title="1. If provided manually (either via GITLAB_ROOT_PASSWORD environment variable or via gitlab_rails[&#39;initial_root_password&#39;] setting in gitlab.rb, it was provided before database was seeded for the first time (usually, the first reconfigure run)."></a>1. If provided manually (either via <code>GITLAB_ROOT_PASSWORD</code> environment variable or via <code>gitlab_rails[&#39;initial_root_password&#39;]</code> setting in <code>gitlab.rb</code>, it was provided before database was seeded for the first time (usually, the first reconfigure run).</h1><h1 id="2-Password-hasn’t-been-changed-manually-either-via-UI-or-via-command-line"><a href="#2-Password-hasn’t-been-changed-manually-either-via-UI-or-via-command-line" class="headerlink" title="2. Password hasn’t been changed manually, either via UI or via command line."></a>2. Password hasn’t been changed manually, either via UI or via command line.</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="If-the-password-shown-here-doesn’t-work-you-must-reset-the-admin-password-following-https-docs-gitlab-com-ee-security-reset-user-password-html-reset-your-root-password"><a href="#If-the-password-shown-here-doesn’t-work-you-must-reset-the-admin-password-following-https-docs-gitlab-com-ee-security-reset-user-password-html-reset-your-root-password" class="headerlink" title="If the password shown here doesn’t work, you must reset the admin password following https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password."></a>If the password shown here doesn’t work, you must reset the admin password following <a href="https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password">https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password</a>.</h1><p>Password: gTNngtW5SYvXYrA1de9HmPRK+BHHItMaLLyJxbKdaaU&#x3D;</p><h1 id="NOTE-This-file-will-be-automatically-deleted-in-the-first-reconfigure-run-after-24-hours"><a href="#NOTE-This-file-will-be-automatically-deleted-in-the-first-reconfigure-run-after-24-hours" class="headerlink" title="NOTE: This file will be automatically deleted in the first reconfigure run after 24 hours."></a>NOTE: This file will be automatically deleted in the first reconfigure run after 24 hours.</h1><p>root@79753321748f:&#x2F;# grep -vE ‘^#|^$’ &#x2F;etc&#x2F;gitlab&#x2F;gitlab.rb<br>external_url ‘<a href="http://gitlab.molu.com/">http://gitlab.molu.com</a>‘<br>nginx[‘listen_addresses’] &#x3D; [‘172.100.0.100’]<br>pages_external_url “<a href="http://pages.molu.com/">http://pages.molu.com/</a>“<br>gitlab_pages[‘enable’] &#x3D; true<br>gitlab_pages[‘external_http’] &#x3D; [‘172.100.1.100:80’]<br>gitlab_pages[‘log_verbose’] &#x3D; true<br>pages_nginx[‘enable’] &#x3D; true<br>root@79753321748f:&#x2F;#<br>[root@localhost admin]# grep -vE ‘^#|^$’ &#x2F;etc&#x2F;gitlab&#x2F;gitlab.rb<br>external_url ‘<a href="http://gitlab.moluren.com/">http://gitlab.moluren.com</a>‘<br>nginx[‘listen_addresses’] &#x3D; [‘192.168.206.134’]<br>pages_external_url “<a href="http://pages.moluren.com/">http://pages.moluren.com/</a>“<br>gitlab_pages[‘enable’] &#x3D; true<br>gitlab_pages[‘external_http’] &#x3D; [‘192.168.206.136:8080’]<br>pages_nginx[‘enable’] &#x3D; true<br>[root@localhost admin]# </p><p>cat &gt;&gt; &#x2F;etc&#x2F;hosts &lt;&lt;’EOF’<br>172.100.0.100 gitlab.molu.com<br>172.100.1.100 root.pages.molu.com<br>EOF</p><p>fatal: unable to access ‘<a href="http://gitlab.molu.com/root/blog.git/">http://gitlab.molu.com/root/blog.git/</a>‘: Could not resolve host: gitlab.molu.com<br>ERROR: Job failed: exit code 1</p><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="1-gitlab-runnce没有权限"><a href="#1-gitlab-runnce没有权限" class="headerlink" title="1.gitlab-runnce没有权限"></a>1.gitlab-runnce没有权限</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; npm run build:highlight </span><br><span class="line">npm ERR! path /root/.npm/_logs </span><br><span class="line">npm ERR! code EACCES </span><br><span class="line">npm ERR! errno -13 </span><br><span class="line">npm ERR! syscall scandir </span><br><span class="line">npm ERR! Error: EACCES: permission denied, scandir &#x27;/root/.npm/_logs&#x27; </span><br><span class="line">npm ERR!  &#123; [Error: EACCES: permission denied, scandir &#x27;/root/.npm/_logs&#x27;] </span><br><span class="line">npm ERR!   stack: </span><br><span class="line">npm ERR!    &#x27;Error: EACCES: permission denied, scandir \&#x27;/root/.npm/_logs\&#x27;&#x27;, </span><br><span class="line">npm ERR!   errno: -13, </span><br><span class="line">npm ERR!   code: &#x27;EACCES&#x27;, </span><br><span class="line">npm ERR!   syscall: &#x27;scandir&#x27;, </span><br><span class="line">npm ERR!   path: &#x27;/root/.npm/_logs&#x27; &#125; </span><br><span class="line">npm ERR!  </span><br><span class="line">npm ERR! The operation was rejected by your operating system. </span><br><span class="line">npm ERR! It is likely you do not have the permissions to access this file as the current user </span><br><span class="line">npm ERR!  </span><br><span class="line">npm ERR! If you believe this might be a permissions issue, please double-check the </span><br><span class="line">npm ERR! permissions of the file and its containing directories, or try running </span><br><span class="line">npm ERR! the command again as root/Administrator (though this is not recommended). </span><br><span class="line">glob error &#123; [Error: EACCES: permission denied, scandir &#x27;/root/.npm/_logs&#x27;] </span><br><span class="line">stack: </span><br><span class="line">&#x27;Error: EACCES: permission denied, scandir \&#x27;/root/.npm/_logs\&#x27;&#x27;, </span><br><span class="line">errno: -13, </span><br><span class="line">code: &#x27;EACCES&#x27;, </span><br><span class="line">syscall: &#x27;scandir&#x27;, </span><br><span class="line">path: &#x27;/root/.npm/_logs&#x27; &#125; </span><br><span class="line">&gt; hexo-util@3.3.0 build:highlight /usr/local/lib/node_modules/hexo-cli/node_modules/hexo-util </span><br><span class="line">&gt; node scripts/build_highlight_alias.js </span><br><span class="line">events.js:174 </span><br><span class="line">throw er; // Unhandled &#x27;error&#x27; event </span><br><span class="line">^ </span><br><span class="line">Error: EACCES: permission denied, open &#x27;highlight_alias.json&#x27; </span><br><span class="line">Emitted &#x27;error&#x27; event at: </span><br><span class="line">at lazyFs.open (internal/fs/streams.js:272:12) </span><br><span class="line">at FSReqWrap.args [as oncomplete] (fs.js:140:20) </span><br><span class="line"></span><br><span class="line">ERROR: Job failed: exit code 1</span><br></pre></td></tr></table></figure><h3 id="解决方法：重新安装将用户更改为root"><a href="#解决方法：重新安装将用户更改为root" class="headerlink" title="解决方法：重新安装将用户更改为root"></a>解决方法：重新安装将用户更改为root</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gitlab-runner uninstall</span><br><span class="line">gitlab-runner install --user=root --working-directory=/home/gitlab-runner</span><br><span class="line">gitlab-runner start</span><br></pre></td></tr></table></figure><h2 id="2-Gitlab-Runner执行CI-CD时报错：fatal-unable-to-access-‘http-gitlab-xxxxxxxxxxxxx-gitlab-instance-xxxxxxx"><a href="#2-Gitlab-Runner执行CI-CD时报错：fatal-unable-to-access-‘http-gitlab-xxxxxxxxxxxxx-gitlab-instance-xxxxxxx" class="headerlink" title="2.Gitlab Runner执行CI&#x2F;CD时报错：fatal: unable to access ‘http://gitlab-xxxxxxxxxxxxx/gitlab-instance-xxxxxxx"></a>2.Gitlab Runner执行CI&#x2F;CD时报错：fatal: unable to access ‘<a href="http://gitlab-xxxxxxxxxxxxx/gitlab-instance-xxxxxxx">http://gitlab-xxxxxxxxxxxxx/gitlab-instance-xxxxxxx</a></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>参考链接：</p><p><a href="https://blog.csdn.net/qq_39940674/article/details/127616784">https://blog.csdn.net/qq_39940674/article/details/127616784</a> (解决GitLab-Runner执行脚本命令无权限)</p><p><a href="https://blog.csdn.net/mo_sss/article/details/135868430">https://blog.csdn.net/mo_sss/article/details/135868430</a> (Gitlab Runner执行CI&#x2F;CD时报错：fatal: unable to access ‘<a href="http://gitlab-xxxxxxxxxxxxx/gitlab-instance-xxxxxxx">http://gitlab-xxxxxxxxxxxxx/gitlab-instance-xxxxxxx</a>)</p><h2 id="3-Gitlab-Runner执行报错Failed-to-pull-image-with-policy-“always”-Error-response-from-daemon-Head"><a href="#3-Gitlab-Runner执行报错Failed-to-pull-image-with-policy-“always”-Error-response-from-daemon-Head" class="headerlink" title="3.Gitlab Runner执行报错Failed to pull image with policy “always”: Error response from daemon: Head"></a>3.Gitlab Runner执行报错Failed to pull image with policy “always”: Error response from daemon: Head</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WARNING: Failed to pull image with policy &quot;always&quot;: Error response from daemon: Head &quot;https://registry.gitlab.com/v2/gitlab-org/gitlab-runner/gitlab-runner-helper/manifests/x86_64-v17.4.0&quot;: Get &quot;https://gitlab.com/jwt/auth?scope=repository%3Agitlab-org%2Fgitlab-runner%2Fgitlab-runner-helper%3Apull&amp;service=container_registry&quot;: dial tcp 172.65.251.78:443: i/o timeout (manager.go:251:16s)</span><br><span class="line">ERROR: Job failed: failed to pull image &quot;registry.gitlab.com/gitlab-org/gitlab-runner/gitlab-runner-helper:x86_64-v17.4.0&quot; with specified policies [always]: Error response from daemon: Head &quot;https://registry.gitlab.com/v2/gitlab-org/gitlab-runner/gitlab-runner-helper/manifests/x86_64-v17.4.0&quot;: Get &quot;https://gitlab.com/jwt/auth?scope=repository%3Agitlab-org%2Fgitlab-runner%2Fgitlab-runner-helper%3Apull&amp;service=container_registry&quot;: dial tcp 172.65.251.78:443: i/o timeout (manager.go:251:16s)</span><br></pre></td></tr></table></figure><h3 id="解决方法：在-etc-gitlab-runner-config-toml文件中的"><a href="#解决方法：在-etc-gitlab-runner-config-toml文件中的" class="headerlink" title="解决方法：在&#x2F;etc&#x2F;gitlab-runner&#x2F;config.toml文件中的"></a>解决方法：在&#x2F;etc&#x2F;gitlab-runner&#x2F;config.toml文件中的</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[runners.docker]添加下面这句话</span><br><span class="line">  helper_image=&quot;gitlab/gitlab-runner-helper:x86_64-latest&quot;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240920034857959.png" alt="image-20240920034857959"></p><p>然后就会正常运行</p><h2 id="4-Gitlab-Runner执行CI-CD时报错：Could-not-resolve-host-域名"><a href="#4-Gitlab-Runner执行CI-CD时报错：Could-not-resolve-host-域名" class="headerlink" title="4.Gitlab Runner执行CI&#x2F;CD时报错：Could not resolve host: 域名"></a>4.Gitlab Runner执行CI&#x2F;CD时报错：Could not resolve host: 域名</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Fetching changes with git depth set to 20...</span><br><span class="line">Initialized empty Git repository in /builds/root/hexo/.git/</span><br><span class="line">Created fresh repository.</span><br><span class="line">fatal: unable to access &#x27;http://gitlab.molu.com/root/hexo.git/&#x27;: Could not resolve host: gitlab.molu.com</span><br><span class="line">ERROR: Job failed: exit code 1</span><br></pre></td></tr></table></figure><h3 id="解决方法：在-etc-gitlab-runner-config-toml文件中的-1"><a href="#解决方法：在-etc-gitlab-runner-config-toml文件中的-1" class="headerlink" title="解决方法：在&#x2F;etc&#x2F;gitlab-runner&#x2F;config.toml文件中的"></a>解决方法：在&#x2F;etc&#x2F;gitlab-runner&#x2F;config.toml文件中的</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[[runners]]</span><br><span class="line">  name = &quot;localhost.localdomain&quot;</span><br><span class="line">  url = &quot;http://192.168.206.134&quot;</span><br><span class="line">  id = 1</span><br><span class="line">  token = &quot;glrt-9Gwhs-9Cn2wxzqyPoysj&quot;</span><br><span class="line">  token_obtained_at = 2024-09-19T17:56:52Z</span><br><span class="line">  token_expires_at = 0001-01-01T00:00:00Z</span><br><span class="line">  executor = &quot;docker&quot;</span><br><span class="line">  </span><br><span class="line">  添加下面这句话，ip为gitlab的ip地址，如果是docker的尽量选docker网络的ip</span><br><span class="line">  clone_url = &quot;http://192.168.206.134&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;docker-安装gitlab-gitlab-runnce并配置gitlab-pages&quot;&gt;&lt;a href=&quot;#docker-安装gitlab-gitlab-runnce并配置gitlab-pages&quot; class=&quot;headerlink&quot; title=&quot;dock</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/11/12/linux/nginx/openssl/"/>
    <id>http://example.com/2024/11/12/linux/nginx/openssl/</id>
    <published>2024-11-12T14:30:54.131Z</published>
    <updated>2024-09-15T11:36:23.089Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum remove openssl -y</span><br><span class="line">yum install -y gcc gcc-c++ zlib-devel libtool autoconf automake perl perl-IPC-Cmd perl-Data-Dumper perl-CPAN wget</span><br><span class="line">wget https://www.openssl.org/source/openssl-3.3.1.tar.gz</span><br><span class="line">tar -zxvf openssl-3.3.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> openssl-3.3.1/</span><br><span class="line">./config --prefix=/usr/local/openssl-3.3.1 shared zlib-dynamic enable-ec_nistp_64_gcc_128</span><br><span class="line">make &amp;&amp; make install_sw</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/openssl-3.3.1/lib64/libcrypto.so.3 /usr/lib64/libcrypto.so.3</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/openssl-3.3.1/lib64/libssl.so.3 /usr/lib64/libssl.so.3</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/openssl-3.3.1/bin/openssl /usr/bin/openssl</span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; ~/.bash_profile&lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/openssl-3.3.1/bin</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> /usr/local/openssl-3.3.1/ssl</span><br><span class="line"><span class="built_in">mv</span> openssl-3.3.1.tar.gz/ssl/openssl.cnf /usr/local/openssl-3.3.1/ssl/</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; openssl.cnf &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># OpenSSL example configuration file.</span></span><br><span class="line"><span class="comment"># See doc/man5/config.pod for more info.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is mostly being used for generation of certificate requests,</span></span><br><span class="line"><span class="comment"># but may be used for auto loading of providers</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note that you can include other files from the main configuration</span></span><br><span class="line"><span class="comment"># file using the .include directive.</span></span><br><span class="line"><span class="comment">#.include filename</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This definition stops the following lines choking if HOME isn&#x27;t</span></span><br><span class="line"><span class="comment"># defined.</span></span><br><span class="line">HOME            = .</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use this in order to automatically load providers.</span></span><br><span class="line">openssl_conf = openssl_init</span><br><span class="line"></span><br><span class="line"><span class="comment"># Comment out the next line to ignore configuration errors</span></span><br><span class="line">config_diagnostics = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extra OBJECT IDENTIFIER info:</span></span><br><span class="line"><span class="comment"># oid_file       = $ENV::HOME/.oid</span></span><br><span class="line">oid_section = new_oids</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use this configuration file with the &quot;-extfile&quot; option of the</span></span><br><span class="line"><span class="comment"># &quot;openssl x509&quot; utility, name here the section containing the</span></span><br><span class="line"><span class="comment"># X.509v3 extensions to use:</span></span><br><span class="line"><span class="comment"># extensions        =</span></span><br><span class="line"><span class="comment"># (Alternatively, use a configuration file that has only</span></span><br><span class="line"><span class="comment"># X.509v3 extensions in its main [= default] section.)</span></span><br><span class="line"></span><br><span class="line">[ new_oids ]</span><br><span class="line"><span class="comment"># We can add new OIDs in here for use by &#x27;ca&#x27;, &#x27;req&#x27; and &#x27;ts&#x27;.</span></span><br><span class="line"><span class="comment"># Add a simple OID like this:</span></span><br><span class="line"><span class="comment"># testoid1=1.2.3.4</span></span><br><span class="line"><span class="comment"># Or use config file substitution like this:</span></span><br><span class="line"><span class="comment"># testoid2=$&#123;testoid1&#125;.5.6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Policies used by the TSA examples.</span></span><br><span class="line">tsa_policy1 = 1.2.3.4.1</span><br><span class="line">tsa_policy2 = 1.2.3.4.5.6</span><br><span class="line">tsa_policy3 = 1.2.3.4.5.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># For FIPS</span></span><br><span class="line"><span class="comment"># Optionally include a file that is generated by the OpenSSL fipsinstall</span></span><br><span class="line"><span class="comment"># application. This file contains configuration data required by the OpenSSL</span></span><br><span class="line"><span class="comment"># fips provider. It contains a named section e.g. [fips_sect] which is</span></span><br><span class="line"><span class="comment"># referenced from the [provider_sect] below.</span></span><br><span class="line"><span class="comment"># Refer to the OpenSSL security policy for more information.</span></span><br><span class="line"><span class="comment"># .include fipsmodule.cnf</span></span><br><span class="line"></span><br><span class="line">[openssl_init]</span><br><span class="line">providers = provider_sect</span><br><span class="line"></span><br><span class="line"><span class="comment"># List of providers to load</span></span><br><span class="line">[provider_sect]</span><br><span class="line">default = default_sect</span><br><span class="line"><span class="comment"># The fips section name should match the section name inside the</span></span><br><span class="line"><span class="comment"># included fipsmodule.cnf.</span></span><br><span class="line"><span class="comment"># fips = fips_sect</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If no providers are activated explicitly, the default one is activated implicitly.</span></span><br><span class="line"><span class="comment"># See man 7 OSSL_PROVIDER-default for more details.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If you add a section explicitly activating any other provider(s), you most</span></span><br><span class="line"><span class="comment"># probably need to explicitly activate the default provider, otherwise it</span></span><br><span class="line"><span class="comment"># becomes unavailable in openssl.  As a consequence applications depending on</span></span><br><span class="line"><span class="comment"># OpenSSL may not work correctly which could lead to significant system</span></span><br><span class="line"><span class="comment"># problems including inability to remotely access the system.</span></span><br><span class="line">[default_sect]</span><br><span class="line"><span class="comment"># activate = 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################################</span></span><br><span class="line">[ ca ]</span><br><span class="line">default_ca  = CA_default        <span class="comment"># The default ca section</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################################</span></span><br><span class="line">[ CA_default ]</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span>     = ./demoCA      <span class="comment"># Where everything is kept</span></span><br><span class="line">certs       = <span class="variable">$dir</span>/certs        <span class="comment"># Where the issued certs are kept</span></span><br><span class="line">crl_dir     = <span class="variable">$dir</span>/crl      <span class="comment"># Where the issued crl are kept</span></span><br><span class="line">database    = <span class="variable">$dir</span>/index.txt    <span class="comment"># database index file.</span></span><br><span class="line"><span class="comment">#unique_subject = no            # Set to &#x27;no&#x27; to allow creation of</span></span><br><span class="line">                    <span class="comment"># several certs with same subject.</span></span><br><span class="line">new_certs_dir   = <span class="variable">$dir</span>/newcerts     <span class="comment"># default place for new certs.</span></span><br><span class="line"></span><br><span class="line">certificate = <span class="variable">$dir</span>/cacert.pem   <span class="comment"># The CA certificate</span></span><br><span class="line">serial      = <span class="variable">$dir</span>/serial       <span class="comment"># The current serial number</span></span><br><span class="line">crlnumber   = <span class="variable">$dir</span>/crlnumber    <span class="comment"># the current crl number</span></span><br><span class="line">                    <span class="comment"># must be commented out to leave a V1 CRL</span></span><br><span class="line">crl     = <span class="variable">$dir</span>/crl.pem      <span class="comment"># The current CRL</span></span><br><span class="line">private_key = <span class="variable">$dir</span>/private/cakey.pem <span class="comment"># The private key</span></span><br><span class="line"></span><br><span class="line">x509_extensions = usr_cert      <span class="comment"># The extensions to add to the cert</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Comment out the following two lines for the &quot;traditional&quot;</span></span><br><span class="line"><span class="comment"># (and highly broken) format.</span></span><br><span class="line">name_opt    = ca_default        <span class="comment"># Subject Name options</span></span><br><span class="line">cert_opt    = ca_default        <span class="comment"># Certificate field options</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extension copying option: use with caution.</span></span><br><span class="line"><span class="comment"># copy_extensions = copy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs</span></span><br><span class="line"><span class="comment"># so this is commented out by default to leave a V1 CRL.</span></span><br><span class="line"><span class="comment"># crlnumber must also be commented out to leave a V1 CRL.</span></span><br><span class="line"><span class="comment"># crl_extensions    = crl_ext</span></span><br><span class="line"></span><br><span class="line">default_days    = 365           <span class="comment"># how long to certify for</span></span><br><span class="line">default_crl_days= 30            <span class="comment"># how long before next CRL</span></span><br><span class="line">default_md  = default       <span class="comment"># use public key default MD</span></span><br><span class="line">preserve    = no            <span class="comment"># keep passed DN ordering</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A few difference way of specifying how similar the request should look</span></span><br><span class="line"><span class="comment"># For type CA, the listed attributes must be the same, and the optional</span></span><br><span class="line"><span class="comment"># and supplied fields are just that :-)</span></span><br><span class="line">policy      = policy_match</span><br><span class="line"></span><br><span class="line"><span class="comment"># For the CA policy</span></span><br><span class="line">[ policy_match ]</span><br><span class="line">countryName     = match</span><br><span class="line">stateOrProvinceName = match</span><br><span class="line">organizationName    = match</span><br><span class="line">organizationalUnitName  = optional</span><br><span class="line">commonName      = supplied</span><br><span class="line">emailAddress        = optional</span><br><span class="line"></span><br><span class="line"><span class="comment"># For the &#x27;anything&#x27; policy</span></span><br><span class="line"><span class="comment"># At this point in time, you must list all acceptable &#x27;object&#x27;</span></span><br><span class="line"><span class="comment"># types.</span></span><br><span class="line">[ policy_anything ]</span><br><span class="line">countryName     = optional</span><br><span class="line">stateOrProvinceName = optional</span><br><span class="line">localityName        = optional</span><br><span class="line">organizationName    = optional</span><br><span class="line">organizationalUnitName  = optional</span><br><span class="line">commonName      = supplied</span><br><span class="line">emailAddress        = optional</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################################</span></span><br><span class="line">[ req ]</span><br><span class="line">default_bits        = 2048</span><br><span class="line">default_keyfile     = privkey.pem</span><br><span class="line">distinguished_name  = req_distinguished_name</span><br><span class="line">attributes      = req_attributes</span><br><span class="line">x509_extensions = v3_ca <span class="comment"># The extensions to add to the self signed cert</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Passwords for private keys if not present they will be prompted for</span></span><br><span class="line"><span class="comment"># input_password = secret</span></span><br><span class="line"><span class="comment"># output_password = secret</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This sets a mask for permitted string types. There are several options.</span></span><br><span class="line"><span class="comment"># default: PrintableString, T61String, BMPString.</span></span><br><span class="line"><span class="comment"># pkix   : PrintableString, BMPString (PKIX recommendation before 2004)</span></span><br><span class="line"><span class="comment"># utf8only: only UTF8Strings (PKIX recommendation after 2004).</span></span><br><span class="line"><span class="comment"># nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).</span></span><br><span class="line"><span class="comment"># MASK:XXXX a literal mask value.</span></span><br><span class="line"><span class="comment"># WARNING: ancient versions of Netscape crash on BMPStrings or UTF8Strings.</span></span><br><span class="line">string_mask = utf8only</span><br><span class="line"></span><br><span class="line"><span class="comment"># req_extensions = v3_req # The extensions to add to a certificate request</span></span><br><span class="line"></span><br><span class="line">[ req_distinguished_name ]</span><br><span class="line">countryName         = Country Name (2 letter code)</span><br><span class="line">countryName_default     = AU</span><br><span class="line">countryName_min         = 2</span><br><span class="line">countryName_max         = 2</span><br><span class="line"></span><br><span class="line">stateOrProvinceName     = State or Province Name (full name)</span><br><span class="line">stateOrProvinceName_default = Some-State</span><br><span class="line"></span><br><span class="line">localityName            = Locality Name (eg, city)</span><br><span class="line"></span><br><span class="line">0.organizationName      = Organization Name (eg, company)</span><br><span class="line">0.organizationName_default  = Internet Widgits Pty Ltd</span><br><span class="line"></span><br><span class="line"><span class="comment"># we can do this but it is not needed normally :-)</span></span><br><span class="line"><span class="comment">#1.organizationName     = Second Organization Name (eg, company)</span></span><br><span class="line"><span class="comment">#1.organizationName_default = World Wide Web Pty Ltd</span></span><br><span class="line"></span><br><span class="line">organizationalUnitName      = Organizational Unit Name (eg, section)</span><br><span class="line"><span class="comment">#organizationalUnitName_default =</span></span><br><span class="line"></span><br><span class="line">commonName          = Common Name (e.g. server FQDN or YOUR name)</span><br><span class="line">commonName_max          = 64</span><br><span class="line"></span><br><span class="line">emailAddress            = Email Address</span><br><span class="line">emailAddress_max        = 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># SET-ex3           = SET extension number 3</span></span><br><span class="line"></span><br><span class="line">[ req_attributes ]</span><br><span class="line">challengePassword       = A challenge password</span><br><span class="line">challengePassword_min       = 4</span><br><span class="line">challengePassword_max       = 20</span><br><span class="line"></span><br><span class="line">unstructuredName        = An optional company name</span><br><span class="line"></span><br><span class="line">[ usr_cert ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># These extensions are added when &#x27;ca&#x27; signs a request.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This goes against PKIX guidelines but some CAs do it and some software</span></span><br><span class="line"><span class="comment"># requires this to avoid interpreting an end user certificate as a CA.</span></span><br><span class="line"></span><br><span class="line">basicConstraints=CA:FALSE</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is typical in keyUsage for a client certificate.</span></span><br><span class="line"><span class="comment"># keyUsage = nonRepudiation, digitalSignature, keyEncipherment</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PKIX recommendations harmless if included in all certificates.</span></span><br><span class="line">subjectKeyIdentifier=<span class="built_in">hash</span></span><br><span class="line">authorityKeyIdentifier=keyid,issuer</span><br><span class="line"></span><br><span class="line"><span class="comment"># This stuff is for subjectAltName and issuerAltname.</span></span><br><span class="line"><span class="comment"># Import the email address.</span></span><br><span class="line"><span class="comment"># subjectAltName=email:copy</span></span><br><span class="line"><span class="comment"># An alternative to produce certificates that aren&#x27;t</span></span><br><span class="line"><span class="comment"># deprecated according to PKIX.</span></span><br><span class="line"><span class="comment"># subjectAltName=email:move</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy subject details</span></span><br><span class="line"><span class="comment"># issuerAltName=issuer:copy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is required for TSA certificates.</span></span><br><span class="line"><span class="comment"># extendedKeyUsage = critical,timeStamping</span></span><br><span class="line"></span><br><span class="line">[ v3_req ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions to add to a certificate request</span></span><br><span class="line"></span><br><span class="line">basicConstraints = CA:FALSE</span><br><span class="line">keyUsage = nonRepudiation, digitalSignature, keyEncipherment</span><br><span class="line">subjectAltName = @alt_names</span><br><span class="line"><span class="comment"># 这里是重点，需要将里面配置为最终服务端需要的域名或者IP</span></span><br><span class="line"><span class="comment"># 这里可以写多个，能够自行添加DNS.X = XXXXXX</span></span><br><span class="line">[ alt_names ]</span><br><span class="line">DNS.1 = molu.com</span><br><span class="line">DNS.2 = *.molu.com</span><br><span class="line">DNS.3 = 10.0.0.1</span><br><span class="line">DNS.4 = 10.0.0.3</span><br><span class="line">[ v3_ca ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions for a typical CA</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PKIX recommendation.</span></span><br><span class="line"></span><br><span class="line">subjectKeyIdentifier=<span class="built_in">hash</span></span><br><span class="line"></span><br><span class="line">authorityKeyIdentifier=keyid:always,issuer</span><br><span class="line"></span><br><span class="line">basicConstraints = critical,CA:<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Key usage: this is typical for a CA certificate. However since it will</span></span><br><span class="line"><span class="comment"># prevent it being used as an test self-signed certificate it is best</span></span><br><span class="line"><span class="comment"># left out by default.</span></span><br><span class="line"><span class="comment"># keyUsage = cRLSign, keyCertSign</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Include email address in subject alt name: another PKIX recommendation</span></span><br><span class="line"><span class="comment"># subjectAltName=email:copy</span></span><br><span class="line"><span class="comment"># Copy issuer details</span></span><br><span class="line"><span class="comment"># issuerAltName=issuer:copy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DER hex encoding of an extension: beware experts only!</span></span><br><span class="line"><span class="comment"># obj=DER:02:03</span></span><br><span class="line"><span class="comment"># Where &#x27;obj&#x27; is a standard or added object</span></span><br><span class="line"><span class="comment"># You can even override a supported extension:</span></span><br><span class="line"><span class="comment"># basicConstraints= critical, DER:30:03:01:01:FF</span></span><br><span class="line"></span><br><span class="line">[ crl_ext ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># CRL extensions.</span></span><br><span class="line"><span class="comment"># Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># issuerAltName=issuer:copy</span></span><br><span class="line">authorityKeyIdentifier=keyid:always</span><br><span class="line"></span><br><span class="line">[ proxy_cert_ext ]</span><br><span class="line"><span class="comment"># These extensions should be added when creating a proxy certificate</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This goes against PKIX guidelines but some CAs do it and some software</span></span><br><span class="line"><span class="comment"># requires this to avoid interpreting an end user certificate as a CA.</span></span><br><span class="line"></span><br><span class="line">basicConstraints=CA:FALSE</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is typical in keyUsage for a client certificate.</span></span><br><span class="line"><span class="comment"># keyUsage = nonRepudiation, digitalSignature, keyEncipherment</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PKIX recommendations harmless if included in all certificates.</span></span><br><span class="line">subjectKeyIdentifier=<span class="built_in">hash</span></span><br><span class="line">authorityKeyIdentifier=keyid,issuer</span><br><span class="line"></span><br><span class="line"><span class="comment"># This stuff is for subjectAltName and issuerAltname.</span></span><br><span class="line"><span class="comment"># Import the email address.</span></span><br><span class="line"><span class="comment"># subjectAltName=email:copy</span></span><br><span class="line"><span class="comment"># An alternative to produce certificates that aren&#x27;t</span></span><br><span class="line"><span class="comment"># deprecated according to PKIX.</span></span><br><span class="line"><span class="comment"># subjectAltName=email:move</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy subject details</span></span><br><span class="line"><span class="comment"># issuerAltName=issuer:copy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This really needs to be in place for it to be a proxy certificate.</span></span><br><span class="line">proxyCertInfo=critical,language:id-ppl-anyLanguage,pathlen:3,policy:foo</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################################</span></span><br><span class="line">[ tsa ]</span><br><span class="line"></span><br><span class="line">default_tsa = tsa_config1   <span class="comment"># the default TSA section</span></span><br><span class="line"></span><br><span class="line">[ tsa_config1 ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># These are used by the TSA reply generation only.</span></span><br><span class="line"><span class="built_in">dir</span>     = ./demoCA      <span class="comment"># TSA root directory</span></span><br><span class="line">serial      = <span class="variable">$dir</span>/tsaserial    <span class="comment"># The current serial number (mandatory)</span></span><br><span class="line">crypto_device   = <span class="built_in">builtin</span>       <span class="comment"># OpenSSL engine to use for signing</span></span><br><span class="line">signer_cert = <span class="variable">$dir</span>/tsacert.pem  <span class="comment"># The TSA signing certificate</span></span><br><span class="line">                    <span class="comment"># (optional)</span></span><br><span class="line">certs       = <span class="variable">$dir</span>/cacert.pem   <span class="comment"># Certificate chain to include in reply</span></span><br><span class="line">                    <span class="comment"># (optional)</span></span><br><span class="line">signer_key  = <span class="variable">$dir</span>/private/tsakey.pem <span class="comment"># The TSA private key (optional)</span></span><br><span class="line">signer_digest  = sha256         <span class="comment"># Signing digest to use. (Optional)</span></span><br><span class="line">default_policy  = tsa_policy1       <span class="comment"># Policy if request did not specify it</span></span><br><span class="line">                    <span class="comment"># (optional)</span></span><br><span class="line">other_policies  = tsa_policy2, tsa_policy3  <span class="comment"># acceptable policies (optional)</span></span><br><span class="line">digests     = sha1, sha256, sha384, sha512  <span class="comment"># Acceptable message digests (mandatory)</span></span><br><span class="line">accuracy    = secs:1, millisecs:500, microsecs:100  <span class="comment"># (optional)</span></span><br><span class="line">clock_precision_digits  = 0 <span class="comment"># number of digits after dot. (optional)</span></span><br><span class="line">ordering        = <span class="built_in">yes</span>   <span class="comment"># Is ordering defined for timestamps?</span></span><br><span class="line">                <span class="comment"># (optional, default: no)</span></span><br><span class="line">tsa_name        = <span class="built_in">yes</span>   <span class="comment"># Must the TSA name be included in the reply?</span></span><br><span class="line">                <span class="comment"># (optional, default: no)</span></span><br><span class="line">ess_cert_id_chain   = no    <span class="comment"># Must the ESS cert id chain be included?</span></span><br><span class="line">                <span class="comment"># (optional, default: no)</span></span><br><span class="line">ess_cert_id_alg     = sha256    <span class="comment"># algorithm to compute certificate</span></span><br><span class="line">                <span class="comment"># identifier (optional, default: sha256)</span></span><br><span class="line"></span><br><span class="line">[insta] <span class="comment"># CMP using Insta Demo CA</span></span><br><span class="line"><span class="comment"># Message transfer</span></span><br><span class="line">server = pki.certificate.fi:8700</span><br><span class="line"><span class="comment"># proxy = # set this as far as needed, e.g., http://192.168.1.1:8080</span></span><br><span class="line"><span class="comment"># tls_use = 0</span></span><br><span class="line">path = pkix/</span><br><span class="line"></span><br><span class="line"><span class="comment"># Server authentication</span></span><br><span class="line">recipient = <span class="string">&quot;/C=FI/O=Insta Demo/CN=Insta Demo CA&quot;</span> <span class="comment"># or set srvcert or issuer</span></span><br><span class="line">ignore_keyusage = 1 <span class="comment"># potentially needed quirk</span></span><br><span class="line">unprotected_errors = 1 <span class="comment"># potentially needed quirk</span></span><br><span class="line">extracertsout = insta.extracerts.pem</span><br><span class="line"></span><br><span class="line"><span class="comment"># Client authentication</span></span><br><span class="line">ref = 3078 <span class="comment"># user identification</span></span><br><span class="line">secret = pass:insta <span class="comment"># can be used for both client and server side</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generic message options</span></span><br><span class="line">cmd = ir <span class="comment"># default operation, can be overridden on cmd line with, e.g., kur</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Certificate enrollment</span></span><br><span class="line">subject = <span class="string">&quot;/CN=openssl-cmp-test&quot;</span></span><br><span class="line">newkey = insta.priv.pem</span><br><span class="line">out_trusted = apps/insta.ca.crt <span class="comment"># does not include keyUsage digitalSignature</span></span><br><span class="line">certout = insta.cert.pem</span><br><span class="line"></span><br><span class="line">[pbm] <span class="comment"># Password-based protection for Insta CA</span></span><br><span class="line"><span class="comment"># Server and client authentication</span></span><br><span class="line">ref = <span class="variable">$insta</span>::ref <span class="comment"># 3078</span></span><br><span class="line">secret = <span class="variable">$insta</span>::secret <span class="comment"># pass:insta</span></span><br><span class="line"></span><br><span class="line">[signature] <span class="comment"># Signature-based protection for Insta CA</span></span><br><span class="line"><span class="comment"># Server authentication</span></span><br><span class="line">trusted = <span class="variable">$insta</span>::out_trusted <span class="comment"># apps/insta.ca.crt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Client authentication</span></span><br><span class="line">secret = <span class="comment"># disable PBM</span></span><br><span class="line">key = <span class="variable">$insta</span>::newkey <span class="comment"># insta.priv.pem</span></span><br><span class="line">cert = <span class="variable">$insta</span>::certout <span class="comment"># insta.cert.pem</span></span><br><span class="line"></span><br><span class="line">[ir]</span><br><span class="line">cmd = ir</span><br><span class="line"></span><br><span class="line">[cr]</span><br><span class="line">cmd = cr</span><br><span class="line"></span><br><span class="line">[kur]</span><br><span class="line"><span class="comment"># Certificate update</span></span><br><span class="line">cmd = kur</span><br><span class="line">oldcert = <span class="variable">$insta</span>::certout <span class="comment"># insta.cert.pem</span></span><br><span class="line"></span><br><span class="line">[rr]</span><br><span class="line"><span class="comment"># Certificate revocation</span></span><br><span class="line">cmd = rr</span><br><span class="line">oldcert = <span class="variable">$insta</span>::certout <span class="comment"># insta.cert.pem</span></span><br><span class="line"></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>openssl genrsa -out myCA.key 2048<br>openssl req -utf8 -new -x509 -days 36500 <br>    -subj “&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;example&#x2F;OU&#x3D;Personal&#x2F;CN&#x3D;MyPersonal Root CA” <br>    -key myCA.key <br>    -out myCA.cer</p><p>openssl genrsa -out server.key 2048<br>openssl req -utf8 -config openssl.cnf -new -out server.req -key server.key<br>openssl x509 -req -extfile openssl.cnf -extensions v3_req -in server.req  -CAkey myCA.key -CA myCA.cer -sha384 -days 36500 -CAcreateserial -CAserial serial <br> -subj “&#x2F;C&#x3D;CN&#x2F;ST&#x3D;Beijing&#x2F;L&#x3D;Beijing&#x2F;O&#x3D;example&#x2F;OU&#x3D;Personal&#x2F;CN&#x3D;MyPersonal Root CA” <br> -out server.cer </p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum remove openssl -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum in</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>crontab</title>
    <link href="http://example.com/2024/09/20/linux/crontab/"/>
    <id>http://example.com/2024/09/20/linux/crontab/</id>
    <published>2024-09-20T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:24.343Z</updated>
    
    <content type="html"><![CDATA[<p><code>crontab -e</code>编辑当前用户的定时任务<br><code>crontab -l</code> 查看当前用户的定时任务</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;crontab -e&lt;/code&gt;编辑当前用户的定时任务&lt;br&gt;&lt;code&gt;crontab -l&lt;/code&gt; 查看当前用户的定时任务&lt;/p&gt;
</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>centos7 mysql配置</title>
    <link href="http://example.com/2024/09/20/linux/mysql/"/>
    <id>http://example.com/2024/09/20/linux/mysql/</id>
    <published>2024-09-19T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.010Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt;/etc/my.cnf&lt;&lt;&#x27;EOF&#x27; </span><br><span class="line">#by oldboy weixin:oldboy0102 </span><br><span class="line">[mysqld]</span><br><span class="line">user=mysql</span><br><span class="line">basedir=/app/tools/mysql/</span><br><span class="line">datadir=/app/data/3306/ </span><br><span class="line">port=3306 socket=/tmp/mysql.sock</span><br><span class="line">[client]</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=/app/tools/mysql/bin:$PATH&#x27;</span> &gt;&gt; /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqld initialize-insecure user=mysql \ --basedir=/app/tools/mysql/ --datadir=/app/data/3306/</span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;@rootA1234&#x27;;</span><br><span class="line">create user &#x27;root&#x27;@&#x27;%&#x27; identified with mysql_native_password by &#x27;@rootA1234&#x27;;</span><br><span class="line">grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; with grant option;</span><br><span class="line">flush privileges;</span><br><span class="line"> ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;rootA.1234&#x27;;</span><br><span class="line">create user exam@&#x27;172.16.1.%&#x27; identified with mysql_native_password by &#x27;@rootA1234&#x27;; </span><br><span class="line">#授权 </span><br><span class="line">grant all on exam.* to exam@&#x27;172.16.1.%&#x27; ; </span><br><span class="line">#测试 </span><br><span class="line">mysql -uexam -p1 -h 172.16.1.52</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat&gt; application-prod.yml &lt;&lt;&#x27;EOF&#x27; </span><br><span class="line">logging: path: /usr/log/xzs/ </span><br><span class="line">spring: </span><br><span class="line">datasource: </span><br><span class="line">url: jdbc:mysql: 172.16.1.52:3306/exam? </span><br><span class="line">useSSL=false&amp;useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=co nvertToNull&amp;allowPublicKeyRetrieval=true&amp;allowMultiQ ueries=true </span><br><span class="line">username: exam </span><br><span class="line">password: 1 </span><br><span class="line">driver-class-name: com.mysql.cj.jdbc.Driver </span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -Duser.timezone=Asia/Shanghai -jar -Dspring.profiles.active=prod xzs-3.9.0.jar</span><br><span class="line">nohup java -Duser.timezone=Asia/Shanghai -jar -Dspring.profiles.active=prod xzs-3.9.0.jar &gt; start1.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/nginx/conf.d/exam.conf &lt;&lt;&quot;EOF&quot;</span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name admin.oldboylinux.cn; </span><br><span class="line">root /app/code/exam/front/admin/; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.html; </span><br><span class="line">&#125; </span><br><span class="line">location /api/ &#123; </span><br><span class="line">proxy_pass http://localhost:8000; </span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name stu.oldboylinux.cn; </span><br><span class="line">root /app/code/exam/front/student/; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.html; </span><br><span class="line">&#125; </span><br><span class="line">location /api/ &#123; </span><br><span class="line">proxy_pass http://localhost:8000; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat &amp;gt;/etc/my.cnf&amp;lt;&amp;lt;&amp;#x27;EOF&amp;#x27; &lt;/span&gt;&lt;b</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="centos7" scheme="http://example.com/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>history去掉行号</title>
    <link href="http://example.com/2024/06/19/linux/history%E8%A1%8C%E5%8F%B7%E9%97%AE%E9%A2%98/"/>
    <id>http://example.com/2024/06/19/linux/history%E8%A1%8C%E5%8F%B7%E9%97%AE%E9%A2%98/</id>
    <published>2024-06-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:24.605Z</updated>
    
    <content type="html"><![CDATA[<p>history去掉行号</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">history | sed &#x27;s/^[ ]*[0-9]\+[ ]*//&#x27; &gt; /root/history.txt</span><br></pre></td></tr></table></figure><p>正则用这个匹配</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">^[ ]*[0-9]+[ ]*</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;history去掉行号&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;history | sed &amp;#x27;s/^[ ]*[0-9]&#92;+[ ]</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>centos7各种源配置</title>
    <link href="http://example.com/2024/05/19/linux/%E5%90%84%E7%A7%8D%E6%BA%90%E9%85%8D%E7%BD%AE/"/>
    <id>http://example.com/2024/05/19/linux/%E5%90%84%E7%A7%8D%E6%BA%90%E9%85%8D%E7%BD%AE/</id>
    <published>2024-05-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:25.645Z</updated>
    
    <content type="html"><![CDATA[<h2 id="centos7-yum源配置"><a href="#centos7-yum源配置" class="headerlink" title="centos7-yum源配置"></a>centos7-yum源配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;s|^mirrorlist=|#mirrorlist=|g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s|^#baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos|g&#x27;</span> \</span><br><span class="line">    -i.bak \</span><br><span class="line">    /etc/yum.repos.d/CentOS-*.repo</span><br></pre></td></tr></table></figure><h2 id="centos7-epel源配置"><a href="#centos7-epel源配置" class="headerlink" title="centos7-epel源配置"></a>centos7-epel源配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum makecache</span><br><span class="line">yum install epel-release -y</span><br><span class="line">sed -e <span class="string">&#x27;s!^metalink=!#metalink=!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!^#baseurl=!baseurl=!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;</span> \</span><br><span class="line">    -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update -y &amp;&amp; yum upgrade -y</span><br></pre></td></tr></table></figure><p>yum install -y vim tree wget bash-completion bashcompletion-extras lrzsz net-tools sysstat iotop iftop htop unzip nc nmap telnet bc psmisc httpd-tools bindutils nethogs expect cowsay sl</p><h2 id="debian11配置"><a href="#debian11配置" class="headerlink" title="debian11配置"></a>debian11配置</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/apt/sources.list &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line"></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-updates main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-backports main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-backports main contrib non-free</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb https://security.debian.org/debian-security bullseye-security main contrib non-free</span><br><span class="line"># deb-src https://security.debian.org/debian-security bullseye-security main contrib non-free</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>cat &gt; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo &lt;&lt;’EOF’</p><p>[base]<br>name&#x3D;CentOS-$releasever - Base<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/os/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/os/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#released updates<br>[updates]<br>name&#x3D;CentOS-$releasever - Updates<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/updates/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/updates/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#additional packages that may be useful<br>[extras]<br>name&#x3D;CentOS-$releasever - Extras<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/extras/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/extras/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#additional packages that extend functionality of existing packages<br>[centosplus]<br>name&#x3D;CentOS-$releasever - Plus<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/centosplus/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/centosplus/$basearch/</a><br>gpgcheck&#x3D;1<br>enabled&#x3D;0<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7<br>EOF</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;centos7-yum源配置&quot;&gt;&lt;a href=&quot;#centos7-yum源配置&quot; class=&quot;headerlink&quot; title=&quot;centos7-yum源配置&quot;&gt;&lt;/a&gt;centos7-yum源配置&lt;/h2&gt;&lt;figure class=&quot;highlight </summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>奇安信天擎旧版本退出有密码解决方案</title>
    <link href="http://example.com/2024/05/19/windows/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E9%80%80%E5%87%BA%E6%9C%89%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://example.com/2024/05/19/windows/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E9%80%80%E5%87%BA%E6%9C%89%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2024-05-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:23.740Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>不是最新版本的</p></blockquote><h1 id="奇安信天擎退出有密码解决方案"><a href="#奇安信天擎退出有密码解决方案" class="headerlink" title="奇安信天擎退出有密码解决方案"></a>奇安信天擎退出有密码解决方案</h1><p>打开程序根目录,这个是默认安装目录：<strong>C:\Program Files (x86)\QAX\360safe\EntClient\conf</strong></p><p>在<strong>360safe</strong> –&gt; <strong>EntClient</strong>—&gt;<strong>conf</strong></p><p>然后找到<strong>EntBase.dat</strong></p><p><img src="C:\Users\Administrator\Pictures\无标题.png" alt="无标题"></p><p>打开文件找到<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240504005752911.png" alt="image-20240504005752911"></p><p>改成0就可以了</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uienable=0</span><br><span class="line">qtenable=0</span><br></pre></td></tr></table></figure><p>保存以后程序就可以退出了，不需要密码</p><h2 id="把文件改成只读，防止再次配置"><a href="#把文件改成只读，防止再次配置" class="headerlink" title="把文件改成只读，防止再次配置"></a>把文件改成只读，防止再次配置</h2><p><strong>亲自测试：下面不把文件改成只读，软件再次打开需要在按照上面的操作再来一遍</strong></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240504005646829.png" alt="image-20240504005646829"></p><p><code>开机自启的话使用火绒进行关闭即可,实测可以,但是会造成卡顿</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;不是最新版本的&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;奇安信天擎退出有密码解决方案&quot;&gt;&lt;a href=&quot;#奇安信天擎退出有密码解决方案&quot; class=&quot;headerlink&quot; title=&quot;奇安信天擎退出有密码解决方案&quot;&gt;&lt;/a&gt;奇安</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>nginx相关配置</title>
    <link href="http://example.com/2024/05/11/linux/nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D/"/>
    <id>http://example.com/2024/05/11/linux/nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D/</id>
    <published>2024-05-10T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.431Z</updated>
    
    <content type="html"><![CDATA[<h2 id="主配置文件nginx-conf"><a href="#主配置文件nginx-conf" class="headerlink" title="主配置文件nginx.conf"></a>主配置文件nginx.conf</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ~]# cat /etc/nginx/nginx.conf </span><br><span class="line"></span><br><span class="line">user  nginx; #nginx用户(虚拟用户)</span><br><span class="line">worker_processes  auto;   #进程数</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log notice;  #失败日志</span><br><span class="line">pid        /var/run/nginx.pid; #pid文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024; 并发数</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;  #引用媒体的类型</span><br><span class="line">    default_type  application/octet-stream; ##媒体默认类型</span><br><span class="line"></span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;  #日志格式</span><br><span class="line">    </span><br><span class="line">    access_log  /var/log/nginx/access.log  main; #正常日志</span><br><span class="line">    </span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    </span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    </span><br><span class="line">    #gzip  on;</span><br><span class="line">    </span><br><span class="line">    include /etc/nginx/conf.d/*.conf;  #nginx的子配置文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="子配置文件default-conf"><a href="#子配置文件default-conf" class="headerlink" title="子配置文件default.conf"></a>子配置文件default.conf</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ~]# cat /etc/nginx/conf.d/default.conf </span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;  # 网站端口</span><br><span class="line">    server_name  localhost; 网站域名</span><br><span class="line"></span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;   #站点目录</span><br><span class="line">    </span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line">    </span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;  #500 502 503 504报错文件</span><br><span class="line">    </span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line">    </span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    root           html;</span><br><span class="line">    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    #    fastcgi_index  index.php;</span><br><span class="line">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    #    include        fastcgi_params;</span><br><span class="line">    #&#125;</span><br><span class="line">    </span><br><span class="line">    # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">    # concurs with nginx&#x27;s one</span><br><span class="line">    #</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;主配置文件nginx-conf&quot;&gt;&lt;a href=&quot;#主配置文件nginx-conf&quot; class=&quot;headerlink&quot; title=&quot;主配置文件nginx.conf&quot;&gt;&lt;/a&gt;主配置文件nginx.conf&lt;/h2&gt;&lt;figure class=&quot;highli</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>nginx安装与配置</title>
    <link href="http://example.com/2024/05/11/linux/nginx%E5%AE%89%E8%A3%85/"/>
    <id>http://example.com/2024/05/11/linux/nginx%E5%AE%89%E8%A3%85/</id>
    <published>2024-05-10T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.266Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、nginxg安装"><a href="#一、nginxg安装" class="headerlink" title="一、nginxg安装"></a>一、nginxg安装</h1><h2 id="1-yum安装"><a href="#1-yum安装" class="headerlink" title="1. yum安装"></a>1. yum安装</h2><h3 id="1-1-先决条件"><a href="#1-1-先决条件" class="headerlink" title="1.1 先决条件"></a>1.1 先决条件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install yum-utils</span><br></pre></td></tr></table></figure><h3 id="1-2-配置nginx的yum仓库"><a href="#1-2-配置nginx的yum仓库" class="headerlink" title="1.2 配置nginx的yum仓库"></a>1.2 配置nginx的yum仓库</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/yum.repos.d/nginx.repo &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line"></span><br><span class="line">[nginx-mainline]</span><br><span class="line">name=nginx mainline repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h3 id="1-3-安装nginx1-26"><a href="#1-3-安装nginx1-26" class="headerlink" title="1.3 安装nginx1.26"></a>1.3 安装nginx1.26</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install nginx-1.26.0 -y</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[root@web01 ~]# rpm -qa nginx</span><br><span class="line">nginx-1.26.0-1.el7.ngx.x86_64</span><br><span class="line">[root@web01 ~]# rpm -ql nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.1,nginx开机自启和启动</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl enable nginx &amp;&amp;systemctl start nginx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、nginxg安装&quot;&gt;&lt;a href=&quot;#一、nginxg安装&quot; class=&quot;headerlink&quot; title=&quot;一、nginxg安装&quot;&gt;&lt;/a&gt;一、nginxg安装&lt;/h1&gt;&lt;h2 id=&quot;1-yum安装&quot;&gt;&lt;a href=&quot;#1-yum安装&quot; class</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>vmware批量克隆虚拟机</title>
    <link href="http://example.com/2024/05/03/windows/vmware/"/>
    <id>http://example.com/2024/05/03/windows/vmware/</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在本地新建一个bat脚本如：1-bat-vmware-bat"><a href="#在本地新建一个bat脚本如：1-bat-vmware-bat" class="headerlink" title="在本地新建一个bat脚本如：1.bat,vmware.bat"></a>在本地新建一个bat脚本如：1.bat,vmware.bat</h1><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off  </span><br><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">chcp</span> <span class="number">65001</span> &gt;<span class="built_in">nul</span> </span><br><span class="line"></span><br><span class="line">:: 这个是你虚拟机的路径,自行填写,提醒目前只支持指定一台虚拟机进行批量克隆</span><br><span class="line"><span class="built_in">CD</span> &quot;C:\Program Files (x86)\VMware\VMware Workstation\&quot;</span><br><span class="line"></span><br><span class="line">:: 创建要克隆虚拟机的快照,<span class="number">12</span>是快照名</span><br><span class="line">vmrun -T ws snapshot &quot;D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx&quot; &quot;<span class="number">12</span>&quot;</span><br><span class="line"></span><br><span class="line">:: 这个是文件主机名和文件名例如：D:\vmkd\第二期环境\vmkd\web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span>\web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span>.vmx</span><br><span class="line">:: 这个vmlist格式为 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> 这样的中间要有空格</span><br><span class="line"><span class="built_in">set</span> &quot;vmList=web03-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">9</span> web02-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">8</span> web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span> m01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">61</span> <span class="number">1</span>b02-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">6</span> db01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">51</span> <span class="number">1</span>b01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">5</span> backup-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">41</span> nfs01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">31</span> web04-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">10</span>&quot; </span><br><span class="line"></span><br><span class="line">:: 这个路径D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx选择你要克隆的虚拟机</span><br><span class="line">:: 这个路径D:\vmkd\第二期环境\vmkds\<span class="variable">%%n</span>\<span class="variable">%%n</span>.vmx这个是存放位置  linked为链接克隆，full为完整克隆 snapshot=&quot;<span class="number">12</span>&quot;是克隆虚拟机的快照名字另这个cloneName=&quot;<span class="variable">%%n</span>&quot;是克隆后的虚拟机名称</span><br><span class="line"><span class="keyword">for</span> <span class="variable">%%n</span> <span class="keyword">in</span> (<span class="variable">%vmList%</span>) <span class="keyword">do</span> ( </span><br><span class="line">    vmrun.exe -T ws clone &quot;D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx&quot; &quot;D:\vmkd\第二期环境\vmkds\<span class="variable">%%n</span>\<span class="variable">%%n</span>.vmx&quot; linked -snapshot=&quot;<span class="number">12</span>&quot; -cloneName=&quot;<span class="variable">%%n</span>&quot;</span><br><span class="line"></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">endlocal</span></span><br></pre></td></tr></table></figure><p>python实现的 批量克隆虚拟机并修改虚拟机内部ip</p><p>流程是 拍快照 –&gt; 克隆快照 –&gt; 启动虚拟机 –&gt; 运行虚拟机里的shell脚本 –&gt; 关闭虚拟机 –&gt; 拍快照 </p><h1 id="下面是完整代码"><a href="#下面是完整代码" class="headerlink" title="下面是完整代码"></a>下面是完整代码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> concurrent.futures</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...（保留您原有的变量定义部分，这部分无需改动）</span></span><br><span class="line"></span><br><span class="line">hosts_info_2 = [</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;fz01&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.11&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;fz02&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.12&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;mysql01&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.31&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;mysql02&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.32&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;gitlab&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.61&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;jenkins&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.62&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Zabbix&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.71&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Prometheus&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.72&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Grafana&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.73&quot;</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># # VMware Workstation的vmrun路径（确保此路径正确无误）</span></span><br><span class="line">vmrun_path = <span class="string">r&quot;C:\Program Files (x86)\VMware\VMware Workstation\vmrun.exe&quot;</span></span><br><span class="line">vmx_path = <span class="string">r&quot;D:\vmkd\CentOS7主机克隆\CentOS7主机克隆.vmx&quot;</span></span><br><span class="line">script_path = <span class="string">&quot;/root/shell/ceshi_copy.sh&quot;</span>  <span class="comment">#shell脚本位置</span></span><br><span class="line">guest_username = <span class="string">&quot;root&quot;</span>  <span class="comment">##虚拟机用户名</span></span><br><span class="line">guest_password = <span class="string">&quot;1&quot;</span>  <span class="comment">##虚拟机密码</span></span><br><span class="line">kuaizhao = <span class="string">&quot;hosts_info_2&quot;</span>  <span class="comment">#快照名</span></span><br><span class="line">kuaizhao_zi = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">create_snapshot_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; snapshot &quot;<span class="subst">&#123;vmx_path&#125;</span>&quot; &quot;<span class="subst">&#123;kuaizhao&#125;</span>&quot;&#x27;</span></span><br><span class="line">create_snapshot_cmd_sed = subprocess.run(create_snapshot_cmd, shell=<span class="literal">True</span>, capture_output=<span class="literal">True</span>)  <span class="comment">##创建快照</span></span><br><span class="line"><span class="keyword">if</span> create_snapshot_cmd_sed.returncode:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;错误：名称为的<span class="subst">&#123;kuaizhao&#125;</span>快照已存在&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retry</span>(<span class="params">func, max_attempts=<span class="number">3</span>, wait_time=<span class="number">5</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;简单的重试装饰器&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_attempts + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">if</span> attempt == max_attempts:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;操作失败，已达到最大尝试次数<span class="subst">&#123;max_attempts&#125;</span>。错误信息：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">raise</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;操作失败，正在进行第<span class="subst">&#123;attempt&#125;</span>次重试。&quot;</span>)</span><br><span class="line">                time.sleep(wait_time * attempt)  <span class="comment"># 每次失败后等待时间逐渐增加</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clone_vm</span>(<span class="params">clone_vm_name, clone_vm_full_path</span>):</span><br><span class="line">    clone_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws clone &quot;<span class="subst">&#123;vmx_path&#125;</span>&quot; &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; linked -snapshot=&quot;<span class="subst">&#123;kuaizhao&#125;</span>&quot; -cloneName=&quot;<span class="subst">&#123;clone_vm_name&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(clone_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_vm</span>(<span class="params">clone_vm_full_path</span>):</span><br><span class="line">    start_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws start &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(start_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_shell_in_guest</span>(<span class="params">clone_vm_full_path, host_info</span>):</span><br><span class="line">    run_shell_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws -gu <span class="subst">&#123;guest_username&#125;</span> -gp <span class="subst">&#123;guest_password&#125;</span> runScriptInGuest &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; &quot;/bin/bash&quot; &quot;<span class="subst">&#123;script_path&#125;</span> <span class="subst">&#123;host_info[<span class="string">&quot;hostname&quot;</span>]&#125;</span> <span class="subst">&#123;host_info[<span class="string">&quot;ip&quot;</span>].split(<span class="string">&quot;.&quot;</span>)[-<span class="number">1</span>]&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(run_shell_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_snapshot</span>(<span class="params">clone_vm_full_path, snapshot_name</span>):</span><br><span class="line">    create_snapshot_cmd_two = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; snapshot &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; &quot;<span class="subst">&#123;snapshot_name&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(create_snapshot_cmd_two, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_host</span>(<span class="params">host_info</span>):</span><br><span class="line">    clone_vm_name = host_info[<span class="string">&quot;hostname&quot;</span>] + <span class="string">&#x27;-&#x27;</span> + host_info[<span class="string">&quot;ip&quot;</span>]</span><br><span class="line">    clone_vm_path = <span class="string">fr&quot;D:\vmkd\xiangmo\Prometheus\&#123;clone_vm_name&#125;&quot;</span></span><br><span class="line">    clone_vm_full_path = os.path.join(clone_vm_path, clone_vm_name) + <span class="string">&quot;.vmx&quot;</span></span><br><span class="line">    time.sleep(random.randint(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line">    clone_vm(clone_vm_name, clone_vm_full_path)</span><br><span class="line">    time.sleep(random.randint(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># 确保克隆操作完成</span></span><br><span class="line"></span><br><span class="line">    start_vm(clone_vm_full_path)</span><br><span class="line">    time.sleep(random.randint(<span class="number">40</span>, <span class="number">50</span>))  <span class="comment"># 等待虚拟机启动稳定</span></span><br><span class="line"></span><br><span class="line">    run_shell_in_guest(clone_vm_full_path, host_info)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;clone_vm_name&#125;</span>运行shell完成&quot;</span>)</span><br><span class="line">    time.sleep(random.randint(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line">    run_stop = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws stop &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(run_stop, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">20</span>)  <span class="comment"># 等待虚拟机关机</span></span><br><span class="line"></span><br><span class="line">    create_snapshot(clone_vm_full_path, kuaizhao_zi)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">10</span>) <span class="keyword">as</span> executor:</span><br><span class="line">    futures = &#123;executor.submit(process_host, host_info) <span class="keyword">for</span> host_info <span class="keyword">in</span> hosts_info_2&#125;</span><br><span class="line">    <span class="keyword">for</span> future <span class="keyword">in</span> concurrent.futures.as_completed(futures):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            future.result()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;处理主机时出现错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在本地新建一个bat脚本如：1-bat-vmware-bat&quot;&gt;&lt;a href=&quot;#在本地新建一个bat脚本如：1-bat-vmware-bat&quot; class=&quot;headerlink&quot; title=&quot;在本地新建一个bat脚本如：1.bat,vmware.bat&quot;&gt;</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="vmware" scheme="http://example.com/tags/vmware/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>zabbix-agen2批量部署</title>
    <link href="http://example.com/2024/05/03/zabbix/zabbix/"/>
    <id>http://example.com/2024/05/03/zabbix/zabbix/</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.881Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>杂稿，记录一下，方便以后修改</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/nginx/conf.d/default.conf &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name zbx.molu.cn; </span><br><span class="line">root /app/code/zbx; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.php; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">fastcgi_index  index.php;</span><br><span class="line">fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">includefastcgi_params;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /app/code/zbx/index.php &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">&lt;?php </span><br><span class="line">phpinfo(); </span><br><span class="line">?&gt;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod -R 777 /app/code/zbx/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/yum.repos.d/MariaDB.repo &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/10.5/centos/$releasever/$basearch</span><br><span class="line">module_hotfixes = 1</span><br><span class="line">gpgkey = https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck = 1</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum makecache -y &amp;&amp; yum update -y</span><br><span class="line">yum install mariadb-server -y</span><br><span class="line">systemctl enable mariadb &amp;&amp;systemctl start mariadb</span><br><span class="line">msyql -uroot -p1</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mv zabbix-6.0.29.tar.gz ~</span><br><span class="line"></span><br><span class="line">tar xf zabbix-6.0.29.tar.gz </span><br><span class="line">cd zabbix-6.0.29/database/mysql/</span><br><span class="line">mysql zabbix &lt;schema.sql </span><br><span class="line">mysql zabbix &lt;images.sql </span><br><span class="line">mysql zabbix &lt;data.sql </span><br><span class="line">mysql zabbix &lt;double.sql </span><br><span class="line">mysql zabbix &lt;history_pk_prepare.sql</span><br><span class="line">测试</span><br><span class="line">mysql -e &#x27;show tables from zabbix;&#x27; |wc -l</span><br><span class="line">yum install -y mysql-devel pcre-devel openssl-devel zlib-devel libxml2-devel net-snmp-devel net-snmp libssh2-devel OpenIPMI-devel libevent-devel openldap-devel libcurl-devel</span><br><span class="line"></span><br><span class="line">./configure --sysconfdir=/etc/zabbix/ --enable-server --with-mysql --with-ssh2 --with-openipmi --with-net-snmp --with-libxml2 --with-zlib --with-libpthread --with-libevent --with-openssl --with-ldap --with-libcurl --with-libpcre</span><br><span class="line">make install</span><br><span class="line">echo $?</span><br><span class="line">vim /etc/zabbix/zabbix_server.conf</span><br><span class="line">grep -n &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_server.conf</span><br><span class="line">useradd -s /sbin/nologin -M zabbix</span><br><span class="line">zabbix_server</span><br><span class="line">ss -lntup | grep 10051</span><br><span class="line">ps -ef |grep zabbix</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /usr/lib/systemd/system/zabbix-server.service &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[Unit]</span><br><span class="line">Description=Zabbix Server with MySQL DB</span><br><span class="line">After=syslog.target network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/usr/local/sbin/zabbix_server -f</span><br><span class="line">User=zabbix</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl daemon-reload </span><br><span class="line">pkill zabbix_server</span><br><span class="line">ps -ef | grep zabbix</span><br><span class="line">ps -ef | grep 10015</span><br><span class="line">systemctl enable zabbix-server&amp;&amp; systemctl start zabbix-server &amp;&amp;systemctl status zabbix-server</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cp -r ui/* /app/code/zbx/</span><br><span class="line">ll /app/code/zbx/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/php.ini </span><br><span class="line">systemctl restart php-fpm.service </span><br><span class="line">yum install php-bcmath php-mbstring</span><br><span class="line">yum install php72w-common</span><br><span class="line">yum install php72w-bcmath</span><br><span class="line">systemctl restart php-fpm.service </span><br><span class="line">chmod -R 777 /app/code/zbx/</span><br><span class="line">cat /app/code/zbx/conf/zabbix.conf.php</span><br></pre></td></tr></table></figure><h1 id="zabbix-agen2批量部署"><a href="#zabbix-agen2批量部署" class="headerlink" title="zabbix-agen2批量部署"></a>zabbix-agen2批量部署</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -ivg https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/6.0/rhel/7/x86_64/zabbix-release-latest.el7.noarch.rpm</span><br><span class="line">sed -i &#x27;s#https://repo.zabbix.com/zabbix#https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/#g&#x27; /etc/yum.repos.d/zabbix.repo</span><br><span class="line">yum update</span><br><span class="line">yum install -y zabbix-agent2</span><br><span class="line">sed -i &#x27;s#Server=127.0.0.1#Server=172.16.1.63#g&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">systemctl enable zabbix-agent2.service &amp;&amp;systemctl start zabbix-agent2.service</span><br><span class="line">grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">ps -ef | grep agent2</span><br><span class="line">ss -lntup | grep agent2</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ]# </span><br><span class="line">mv /etc/nginx/conf.d</span><br><span class="line">cat &gt; /etc/nginx/conf.d/status.conf  &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">server &#123; </span><br><span class="line">  listen 8000; </span><br><span class="line">  location / &#123; </span><br><span class="line">stub_status; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">  [root@web01 /etc/nginx/conf.d]# </span><br><span class="line">  curl http: localhost:8000/ </span><br><span class="line">  Active connections: 1 server accepts </span><br><span class="line">  handled requests 111 Reading: 0 Writing: 1 Waiting: 0 </span><br><span class="line">  [root@web01 /etc/nginx/conf.d]# curl http: localhost:8000/dddddd </span><br><span class="line">  Active connections: 1 server accepts handled requests 222 </span><br><span class="line">  Reading: 0 Writing: 1 Waiting: 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="zabbix中文解决办法"><a href="#zabbix中文解决办法" class="headerlink" title="zabbix中文解决办法"></a>zabbix中文解决办法</h2><p>更好默认字体即可</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  mv /app/code/zbx/assets/fonts/DejaVuSans.ttf /app/code/zbx/assets/fonts/DejaVuSans</span><br><span class="line">cp MSYH.TTC /app/code/zbx/assets/fonts/DejaVuSans.ttf</span><br><span class="line">systemctl restart zabbix</span><br><span class="line">systemctl restart zabbix-server.service </span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/zabbix/zabbix_agent2.d/web.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#UserParameter=key,cmd </span><br><span class="line">#UserParameter=check.ngx,sh /server/scripts/xxx.sh </span><br><span class="line">UserParameter=check.ngx,ss -lntup|grep -w 80|wc -l</span><br><span class="line">EOF</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">LogFileSize=0 Server=172.16.1.63 ServerActive=172.16.1.63 </span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line">HostMetadataItem=system.uname </span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf </span><br><span class="line">ControlSocket=/tmp/agent.sock </span><br><span class="line">Include=./zabbix_agent2.d/plugins.d/*.conf</span><br><span class="line"></span><br><span class="line">PidFile=/run/zabbix/zabbix_agent2.pid</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_agent2.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">Server=172.16.1.63</span><br><span class="line">ServerActive=172.16.1.63</span><br><span class="line">Hostname=Zabbix server</span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line">HostMetadataItem=system.uname</span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf</span><br><span class="line">PluginSocket=/run/zabbix/agent.plugin.sock</span><br><span class="line">ControlSocket=/run/zabbix/agent.sock</span><br><span class="line">Include=./zabbix_agent2.d/plugins.d/*.conf</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;杂稿，记录一下，方便以后修改&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="zabbix" scheme="http://example.com/tags/zabbix/"/>
    
  </entry>
  
  <entry>
    <title>ssh免密登录配置</title>
    <link href="http://example.com/2024/05/02/windows/ssh/"/>
    <id>http://example.com/2024/05/02/windows/ssh/</id>
    <published>2024-05-01T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.304Z</updated>
    
    <content type="html"><![CDATA[<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="1-ERROR-Host-key-verification-failed"><a href="#1-ERROR-Host-key-verification-failed" class="headerlink" title="1.ERROR: Host key verification failed."></a>1.ERROR: Host key verification failed.</h2><p><code>ssh-copy-id -i ~/.ssh/id_ed25519.pub root@10.0.100.1</code></p><h3 id="1-1报错信息"><a href="#1-1报错信息" class="headerlink" title="1.1报错信息"></a>1.1报错信息</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/c/Users/Administrator/.ssh/id_ed25519.pub&quot;</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span><br><span class="line"></span><br><span class="line">/usr/bin/ssh-copy-id: ERROR: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line">ERROR: @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class="line">ERROR: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line">ERROR: IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class="line">ERROR: Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class="line">ERROR: It is also possible that a host key has just been changed.</span><br><span class="line">ERROR: The fingerprint for the ED25519 key sent by the remote host is</span><br><span class="line">ERROR: SHA256:hldheoaTxodVcyGltGuPUP+zQOiV7BsJw8I9WSX4OFc.</span><br><span class="line">ERROR: Please contact your system administrator.</span><br><span class="line">ERROR: Add correct host key in /c/Users/Administrator/.ssh/known_hosts to get rid of this message.</span><br><span class="line">ERROR: Offending ECDSA key in /c/Users/Administrator/.ssh/known_hosts:6  </span><br><span class="line">ERROR: Host key for 10.0.100.1 has changed and you have requested strict checking.</span><br><span class="line">ERROR: Host key verification failed.</span><br></pre></td></tr></table></figure><p>找到ssh文件下的known_hosts文件,将如有：<strong>10.0.100.1</strong>整行全部删除<br>known_hosts文件在<code>.ssh</code>下,不知道在哪，就看上面的报错信息</p><p>BBS-Go项目编译安装67</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;常见问题&quot;&gt;&lt;a href=&quot;#常见问题&quot; class=&quot;headerlink&quot; title=&quot;常见问题&quot;&gt;&lt;/a&gt;常见问题&lt;/h1&gt;&lt;h2 id=&quot;1-ERROR-Host-key-verification-failed&quot;&gt;&lt;a href=&quot;#1-ERROR-H</summary>
      
    
    
    
    <category term="ssh" scheme="http://example.com/categories/ssh/"/>
    
    
    <category term="ssh" scheme="http://example.com/tags/ssh/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>淘宝nginx安装与配置</title>
    <link href="http://example.com/2024/05/02/linux/%E6%B7%98%E5%AE%9Dnginx/"/>
    <id>http://example.com/2024/05/02/linux/%E6%B7%98%E5%AE%9Dnginx/</id>
    <published>2024-05-01T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.790Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>系统ubuntu20.04</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt update -y</span><br><span class="line">apt install wget -y</span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line">dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line"></span><br><span class="line">wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/</span><br><span class="line">tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/</span><br><span class="line">apt-get install -y wget libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev</span><br><span class="line"></span><br><span class="line">cd /tmp/tengine-3.1.0/</span><br><span class="line">./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-http_v2_module \</span><br><span class="line">--with-http_realip_module \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-http_mp4_module \</span><br><span class="line">--with-stream \</span><br><span class="line">--with-stream_ssl_module \</span><br><span class="line">--with-stream_realip_module \</span><br><span class="line">--add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">--add-module=modules/ngx_http_upstream_session_sticky_module</span><br><span class="line">make &amp;&amp;make install</span><br><span class="line">groupadd nginx&amp;&amp;useradd -g nginx nginx</span><br><span class="line"></span><br><span class="line">ln -s /app/tools/tengine-3.1.0 /app/tools/tengine</span><br><span class="line">ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br></pre></td></tr></table></figure><p>Dockerfile无变量</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM ubuntu:20.04</span><br><span class="line">LABEL author=&quot;相聚就是缘&quot;</span><br><span class="line"></span><br><span class="line">RUN apt update -y \</span><br><span class="line">    &amp;&amp; apt install wget -y</span><br><span class="line">RUN wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb \</span><br><span class="line">    &amp;&amp; dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line"></span><br><span class="line">RUN cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">RUN apt update -y &amp;&amp; apt upgrade -y \</span><br><span class="line">    &amp;&amp;wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/ \</span><br><span class="line">    &amp;&amp; tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/ \</span><br><span class="line">    &amp;&amp; apt-get install -y libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev \</span><br><span class="line">    &amp;&amp; cd /tmp/tengine-3.1.0/ \</span><br><span class="line">    &amp;&amp; ./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">    --user=nginx \</span><br><span class="line">    --group=nginx \</span><br><span class="line">    --with-http_ssl_module \</span><br><span class="line">    --with-http_v2_module \</span><br><span class="line">    --with-http_realip_module \</span><br><span class="line">    --with-http_stub_status_module \</span><br><span class="line">    --with-http_mp4_module \</span><br><span class="line">    --with-stream \</span><br><span class="line">    --with-stream_ssl_module \</span><br><span class="line">    --with-stream_realip_module \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_session_sticky_module \</span><br><span class="line">    &amp;&amp; make &amp;&amp;make install</span><br><span class="line">RUN groupadd nginx&amp;&amp;useradd -g nginx nginx \</span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine-3.1.0 /app/tools/tengine \   </span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br><span class="line">RUN rm -fr /var/cache/* &amp;&amp; rm -rf /tmp/*</span><br><span class="line">COPY index.html /app/tools/tengine/html</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD [ &quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot; ]</span><br></pre></td></tr></table></figure><p>Dockerfile有变量</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM ubuntu:20.04</span><br><span class="line">LABEL author=&quot;相聚就是缘&quot;</span><br><span class="line">ENV</span><br><span class="line">RUN apt update -y \</span><br><span class="line">    &amp;&amp; apt install wget -y</span><br><span class="line">RUN wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb \</span><br><span class="line">    &amp;&amp; dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line"></span><br><span class="line">RUN cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">RUN apt update -y &amp;&amp; apt upgrade -y \</span><br><span class="line">    &amp;&amp;wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/ \</span><br><span class="line">    &amp;&amp; tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/ \</span><br><span class="line">    &amp;&amp; apt-get install -y libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev \</span><br><span class="line">    &amp;&amp; cd /tmp/tengine-3.1.0/ \</span><br><span class="line">    &amp;&amp; ./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">    --user=nginx \</span><br><span class="line">    --group=nginx \</span><br><span class="line">    --with-http_ssl_module \</span><br><span class="line">    --with-http_v2_module \</span><br><span class="line">    --with-http_realip_module \</span><br><span class="line">    --with-http_stub_status_module \</span><br><span class="line">    --with-http_mp4_module \</span><br><span class="line">    --with-stream \</span><br><span class="line">    --with-stream_ssl_module \</span><br><span class="line">    --with-stream_realip_module \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_session_sticky_module \</span><br><span class="line">    &amp;&amp; make &amp;&amp;make install</span><br><span class="line">RUN groupadd nginx&amp;&amp;useradd -g nginx nginx \</span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine-3.1.0 /app/tools/tengine \   </span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br><span class="line">RUN rm -fr /var/cache/* &amp;&amp; rm -rf /tmp/*</span><br><span class="line">COPY index.html /app/tools/tengine/html</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD [ &quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot; ]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;系统ubuntu20.04&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apt </summary>
      
    
    
    
    <category term="ssh" scheme="http://example.com/categories/ssh/"/>
    
    
    <category term="ssh" scheme="http://example.com/tags/ssh/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>linux基础</title>
    <link href="http://example.com/2024/04/25/linux/linux/"/>
    <id>http://example.com/2024/04/25/linux/linux/</id>
    <published>2024-04-24T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.874Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-基础知识"><a href="#1-基础知识" class="headerlink" title="1 基础知识"></a>1 基础知识</h1><h2 id="1-1-linux发行版"><a href="#1-1-linux发行版" class="headerlink" title="1.1 linux发行版"></a>1.1 linux发行版</h2><blockquote><p>本文基于centos7</p></blockquote><p> <strong>Linux的发行版本可以大体分为两类，一类是商业公司维护的发行版本，一类是社区组织维护的发行版本</strong></p><p><strong>目前常用的还是centos和ubuntu</strong></p><h4 id="Debian系列"><a href="#Debian系列" class="headerlink" title="Debian系列"></a><strong>Debian系列</strong></h4><ul><li><p>Debian：以其稳定性著称，是许多其他发行版（如Ubuntu）的基础。它遵循严格的自由软件原则，有着庞大的软件包库。</p></li><li><p>Ubuntu：基于Debian，以其用户友好和广泛的社区支持而流行，适合桌面用户和云环境。Ubuntu有多个变种，如Kubuntu（使用KDE桌面环境）、Xubuntu（使用Xfce）等。</p></li><li><p>Linux Mint：基于Ubuntu和Debian的发行版，以其易用性和美观的界面而受到好评。</p></li><li><p>Deepin：基于Debian的发行版，提供现代化的桌面环境和丰富的功能。</p></li></ul><h4 id="Redhat系列"><a href="#Redhat系列" class="headerlink" title="Redhat系列"></a><strong>Redhat系列</strong></h4><ul><li>Red Hat Enterprise Linux (RHEL)：面向企业级市场的发行版，以其出色的稳定性和技术支持闻名。CentOS曾是它的免费克隆版，但CentOS项目已转向CentOS Stream，作为RHEL的上游开发分支。</li><li>Fedora：由Red Hat赞助，是创新技术和软件的试验场，很多新技术会在Fedora中先行测试，之后可能被纳入RHEL。</li><li>CentOS 是基于Red Hat Enterprise Linux源代码构建的开源Linux发行版，继承了RHEL的稳定性和可靠性，同时提供了丰富的软件包资源和灵活的定制选项。CentOS经过严格的测试和验证，确保系统的高度稳定性和可靠性，适用于企业级应用。</li></ul><h4 id="Arch-Linux系列："><a href="#Arch-Linux系列：" class="headerlink" title="Arch Linux系列："></a><strong>Arch Linux系列</strong>：</h4><ul><li>Arch Linux：面向高级用户和开发者，提供滚动更新的包管理系统和灵活的配置选项。</li><li>Manjaro：基于Arch Linux，但更注重用户友好性和易用性。</li></ul><h4 id="openSUSE系列"><a href="#openSUSE系列" class="headerlink" title="openSUSE系列"></a><strong>openSUSE系列</strong></h4><ul><li><p>openSUSE Leap：这是openSUSE的长期支持（LTS）版本，强调稳定性与安全性。Leap基于SUSE Linux Enterprise（SLE）的源代码，这意味着它拥有企业级的稳定性和兼容性。适合那些需要一个长期稳定环境的用户，如企业服务器部署或那些不希望频繁更新系统的桌面用户。</p></li><li><p>openSUSE Tumbleweed：这是一个滚动发布的版本，意味着用户可以获得最新的软件包和技术更新，无需等待新版本发布。Tumbleweed适合喜欢尝鲜、追求最新软件特性的开发者和爱好者。由于其滚动更新的特性，系统始终处于最新状态，但也可能包含较新的、未经长时间测试的软件包。</p></li></ul><h4 id="国产系统系列"><a href="#国产系统系列" class="headerlink" title="国产系统系列"></a><strong>国产系统系列</strong></h4><ul><li><p>优麒麟（UbuntuKylin）：基于Ubuntu的发行版，由中国CCN开源创新联合实验室与天津麒麟信息技术有限公司主导开发。它集成了大量符合中国用户习惯的软件和服务，如WPS Office、搜狗输入法等。</p></li><li><p>统一操作系统（UOS）：由多家中国企业如中国电子、武汉深之度、南京诚迈、中兴新支点等联合打造的Linux发行版，旨在提供一个统一、高效、安全的国产操作系统平台，广泛应用于政府、金融、教育等多个领域。</p></li><li><p>深度操作系统（Deepin）：由武汉深之度科技有限公司开发，以其美观的用户界面和良好的用户体验著称，特别适合桌面用户。Deepin操作系统内置了深度商店、深度音乐、深度影院等一整套自主开发的应用程序。</p></li><li><p>中标麒麟（NeoKylin）：由原中标软件和银河麒麟合并而成，主要面向中国政府和企业的服务器市场，提供高安全性、可靠性的解决方案。中标麒麟系统在政府机关、国防、能源、金融等行业有广泛应用。</p></li><li><p>红旗Linux：由中科红旗软件公司发行，属于Debian系，具有较长的历史，在国内有一定的市场份额，尤其在政府和教育行业有应用。</p></li></ul><h2 id="1-2-linux的目录结构"><a href="#1-2-linux的目录结构" class="headerlink" title="1.2 linux的目录结构"></a>1.2 linux的目录结构</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/：这是Linux文件系统的根目录，是所有其他目录的起点。</span><br><span class="line">/bin：此目录存放着用户二进制文件，也就是可执行文件。系统所需要的那些命令位于此目录或/sbin目录下。</span><br><span class="line">/boot：这个目录存放启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。</span><br><span class="line">/dev：此目录包含了Linux系统中所有的设备文件。如硬盘用系统的第一块硬盘称为/dev/hda，第二块称为/dev/hdb等；光驱称为/dev/hdc等。</span><br><span class="line">/etc：这个目录是整个Linux系统最为关键的一个目录，几乎所有的系统配置文件都在这里。例如用户账户和密码文件、各种服务的配置文件等。</span><br><span class="line">/home：此目录是用户的宿主目录，是用户自己的文件存放目录。每个用户都有自己的目录，名称通常是以用户的账号命名的。</span><br><span class="line">/lib：这个目录存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。</span><br><span class="line">/media：Linux系统会自动识别一些设备，例如U盘、光驱等，当识别后，Linux会把识别的设备挂载到这个目录下。</span><br><span class="line">/mnt：临时挂载文件系统的目录，系统管理员可以临时将别的文件系统挂在这个目录下。</span><br><span class="line">/opt：这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。</span><br><span class="line">/proc：此目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。</span><br><span class="line">/root：这是系统管理员（root）的家目录。</span><br><span class="line">/sbin：s就是Super User的意思，是超级用户使用的命令。这里存放的是系统管理员使用的系统管理程序。</span><br><span class="line">/srv：该目录存放一些服务启动之后需要提取的数据。</span><br><span class="line">/sys：这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。该文件系统是内核设备树的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。</span><br><span class="line">/tmp：这个目录是用来存放一些临时文件的。</span><br><span class="line">/usr：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。</span><br><span class="line">/var：这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。</span><br></pre></td></tr></table></figure><p>2.基础命令</p><p>man 命令</p><p>如：man ls</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd,ls</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">df,du,</span><br></pre></td></tr></table></figure><p>head,tail</p><p>history</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shutdown –h now</span><br><span class="line">init 0</span><br><span class="line">halt</span><br></pre></td></tr></table></figure><p>mkdir,touch创建文件和文件夹</p><p>sc,scp,mv复制 跨主机复制 ，移动</p><p>echo,sudo,cat输入，提权，查看文件内容</p><p>pwd，当前文件路径</p><p>yum,apt,dnf,yarn 软件源</p><p>less,more翻页</p><p>vim,vi 编辑文本</p><p>wget,curl 请求</p><p>awk,sed,grep</p><p>|,</p><p>tar,unzip,</p><p>systemctl</p><p>chmod</p><p>lscpu查看cpu信息</p><p>men,find</p><p>检查网口<br>ss -lntup |grep 80<br>#检查进程<br>ps -ef |grep nginx</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-基础知识&quot;&gt;&lt;a href=&quot;#1-基础知识&quot; class=&quot;headerlink&quot; title=&quot;1 基础知识&quot;&gt;&lt;/a&gt;1 基础知识&lt;/h1&gt;&lt;h2 id=&quot;1-1-linux发行版&quot;&gt;&lt;a href=&quot;#1-1-linux发行版&quot; class=&quot;head</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>vscode ssh连接报错</title>
    <link href="http://example.com/2024/04/25/windows/vscode/"/>
    <id>http://example.com/2024/04/25/windows/vscode/</id>
    <published>2024-04-24T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.601Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">运行命令 remote-explorer.configureSsh 错误: 发生了系统错误 (EPERM: operation not permitted, mkdir &#x27;C:\Users\Administrator&#x27;)。这可能是由提交 remote-explorer.configureSsh 的扩展引起的。</span><br></pre></td></tr></table></figure><p>解决方法</p><p>将vscode以管理员运行即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;运行命令 remote-explorer.configureSsh 错误: 发生了系统错误 (EPERM</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>shell脚本</title>
    <link href="http://example.com/2024/04/16/linux/shell%E8%84%9A%E6%9C%AC/"/>
    <id>http://example.com/2024/04/16/linux/shell%E8%84%9A%E6%9C%AC/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.533Z</updated>
    
    <content type="html"><![CDATA[<h4 id="批量获取ip地址的"><a href="#批量获取ip地址的" class="headerlink" title="批量获取ip地址的"></a>批量获取ip地址的</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip a s ens33 | awk -F &#x27;[ /]+&#x27; &#x27;NR==3&#123;print $3&#125;&#x27;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;批量获取ip地址的&quot;&gt;&lt;a href=&quot;#批量获取ip地址的&quot; class=&quot;headerlink&quot; title=&quot;批量获取ip地址的&quot;&gt;&lt;/a&gt;批量获取ip地址的&lt;/h4&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;t</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux - 笔记" scheme="http://example.com/tags/linux-%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>nfs安装与配置</title>
    <link href="http://example.com/2024/04/16/linux/nfs/"/>
    <id>http://example.com/2024/04/16/linux/nfs/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.150Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查看系统是否已安装NFS"><a href="#查看系统是否已安装NFS" class="headerlink" title="查看系统是否已安装NFS"></a>查看系统是否已安装NFS</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -qa | grep nfs</span><br><span class="line">rpm -qa | grep rpcbind</span><br></pre></td></tr></table></figure><h1 id="安装nfs相关服务软件包"><a href="#安装nfs相关服务软件包" class="headerlink" title="安装nfs相关服务软件包"></a>安装nfs相关服务软件包</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install -y nfs-utils rpcbind</span><br></pre></td></tr></table></figure><h1 id="验证系统是否成功安装NFS"><a href="#验证系统是否成功安装NFS" class="headerlink" title="验证系统是否成功安装NFS"></a>验证系统是否成功安装NFS</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@node2 ~]# rpm -qa | grep nfs</span><br><span class="line">libnfsidmap-0.25-19.el7.x86_64</span><br><span class="line">nfs-utils-1.3.0-0.68.el7.2.x86_64</span><br><span class="line">[root@node2 ~]# rpm -qa | grep rpcbind</span><br><span class="line">rpcbind-0.2.0-49.el7.x86_64</span><br></pre></td></tr></table></figure><h1 id="创建共享存储文件夹"><a href="#创建共享存储文件夹" class="headerlink" title="创建共享存储文件夹"></a>创建共享存储文件夹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p /pythons/nfs</span><br></pre></td></tr></table></figure><h1 id="配置nfs"><a href="#配置nfs" class="headerlink" title="配置nfs"></a>配置nfs</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 输入以下内容，格式为：nfs共享目录 nfs客户端地址1(param1, param2,...) nfs客户端地址2(param1, param2,...)</span><br><span class="line"># 如: /data/nfs 10.0.0.200/24(rw,async,no_root_squash)</span><br><span class="line"># 固定网段所有IP可挂载</span><br><span class="line">echo &quot;/pythons/nfs *(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"># 固定网段固定IP区间可挂载</span><br><span class="line">echo &quot;/data/nfs 10.0.0.200/24(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"></span><br><span class="line"># 所有客户端可挂载</span><br><span class="line">echo &quot;/data/nfs *(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"># 启动服务</span><br><span class="line"># 先启动rpc服务，再启动nfs服务</span><br><span class="line"># 加入开始自启动</span><br><span class="line">systemctl enable rpcbind &amp;&amp; systemctl start rpcbind</span><br><span class="line">systemctl enable nfs &amp;&amp; systemctl start nfs</span><br><span class="line"> </span><br><span class="line">#使nfs配置生效</span><br><span class="line">exportfs -r</span><br><span class="line"> </span><br><span class="line"># 查看服务状态</span><br><span class="line">systemctl status rpcbind</span><br><span class="line">systemctl status nfs</span><br></pre></td></tr></table></figure><h3 id="rsync报错解决rsync-mkstemp-failed-Permission-denied-13"><a href="#rsync报错解决rsync-mkstemp-failed-Permission-denied-13" class="headerlink" title="rsync报错解决rsync: mkstemp *******  failed: Permission denied (13)"></a>rsync报错解决rsync: mkstemp *******  failed: Permission denied (13)</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@backup tmp]#rsync -avz /etc/hostname rsync_backup@10.0.0.41::data</span><br><span class="line">Password: </span><br><span class="line">sending incremental file list</span><br><span class="line">hostname</span><br><span class="line">rsync: mkstemp <span class="string">&quot;.hostname.Qo7WQD&quot;</span> (<span class="keyword">in</span> data) failed: Permission denied (13)</span><br><span class="line"></span><br><span class="line">sent 101 bytes  received 122 bytes  63.71 bytes/sec</span><br><span class="line">total size is 7  speedup is 0.03</span><br><span class="line">rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1179) [sender=3.1.2]</span><br></pre></td></tr></table></figure><h4 id="1-data文件夹权限问题"><a href="#1-data文件夹权限问题" class="headerlink" title="1.data文件夹权限问题"></a>1.data文件夹权限问题</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@backup data]# <span class="built_in">ls</span> -ld</span><br><span class="line">drwxr-xr-x. 2 root root 6 Apr 13 01:16 .</span><br></pre></td></tr></table></figure><p>使用 <strong>sudo chmod 777 &#x2F;data</strong>即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;查看系统是否已安装NFS&quot;&gt;&lt;a href=&quot;#查看系统是否已安装NFS&quot; class=&quot;headerlink&quot; title=&quot;查看系统是否已安装NFS&quot;&gt;&lt;/a&gt;查看系统是否已安装NFS&lt;/h1&gt;&lt;figure class=&quot;highlight plaintex</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>docker安装和配置</title>
    <link href="http://example.com/2024/04/16/linux/dokcer/"/>
    <id>http://example.com/2024/04/16/linux/dokcer/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.497Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>基于centos7的安装与配置<br>yum install -y yum-utils device-mapper-persistentdata lvm2<br>#2.下载官方的docker yum源文件<br>yum-config-manager –add-repo <a href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a><br>#3.替换yum源地址 docker-ce.repo<br>#4.安装docker-ce<br>yum install -y docker-ce<br>systemctl enable –now docker<br>docker version<br>#配置镜像加速<br>yum-config-manager –add-repo <a href="http://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo">http://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo</a><br>yum install -y yum-utils<br>yum-config-manager –add-repo <a href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a><br>sed -i ‘s+<a href="https://download.docker.com+https//mirrors.tuna.tsinghua.edu.cn/docker-ce+">https://download.docker.com+https://mirrors.tuna.tsinghua.edu.cn/docker-ce+</a>‘ &#x2F;etc&#x2F;yum.repos.d&#x2F;docker-ce.repo</p></blockquote><p>sudo mkdir -p &#x2F;etc&#x2F;docker<br>cat &gt; &#x2F;etc&#x2F;docker&#x2F;daemon.json &lt;&lt;’EOF’<br>{<br>  “registry-mirrors”: [<br>    “<a href="https://registry.docker-cn.com/">https://registry.docker-cn.com</a>“,<br>    “<a href="http://hub-mirror.c.163.com/">http://hub-mirror.c.163.com</a>“,<br>    “<a href="https://dockerhub.azk8s.cn/">https://dockerhub.azk8s.cn</a>“,<br>    “<a href="https://mirror.ccs.tencentyun.com/">https://mirror.ccs.tencentyun.com</a>“,<br>    “<a href="https://registry.cn-hangzhou.aliyuncs.com/">https://registry.cn-hangzhou.aliyuncs.com</a>“,<br>    “<a href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a>“,<br>    “<a href="https://docker.m.daocloud.io/">https://docker.m.daocloud.io</a>“,<br>    “<a href="https://noohub.ru/">https://noohub.ru</a>“,<br>    “<a href="https://huecker.io/">https://huecker.io</a>“,<br>    “<a href="https://dockerhub.timeweb.cloud/">https://dockerhub.timeweb.cloud</a>“<br>  ]<br>}</p><p>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p><p>docker search 搜索镜像, 优先选官方,stars数量多<br>docker pull 拉取镜像(下载镜像)，注意版本<br>docker push 推送镜像(上传镜像)<br>docker load 导入镜像 例子:<br>    docker load -i docker_nginx.tar.gz docker save<br>导出镜像 例子:<br>    docker save centos:7 -o docker_centos7.tar.gz<br>docker images 查看镜像列表<br>docker rmi 删除镜像<br>docker tag 给镜像打标签</p><p>docker ps 查看容器列表 -a 查看所有容器<br>docker run 创建并运行容器<br>    例子:docker run -d -it -p 80:80 nginx:latest docker<br>create 创建容器<br>name docker start 启动容器<br>docker stop 停止容器<br>docker restart 重启容器<br>docker kill 强制停止容器<br>docker rm 删除容器 批量删除所有容器<br>docker rm -f <code>docker ps -a -q</code> docker exec 进入正在运行的容器(分配一个新终端) 例子:<br>    docker exec -it 容器id&#x2F;容器名字 &#x2F;bin&#x2F;bash(&#x2F;bin&#x2F;sh) docker attach 进入正在运行的容器(使用相同的终端),偷偷离开 的快捷键ctrl +p,ctrl +q<br>inspect stats</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">前台运行 nginx -g &#x27;daemon off;&#x27; nginx前台运行. /usr/sbin/php-fpm nodaemonize php前台运行. /usr/sbin/sshd -D  ssh前台运行. java -jar xxx.jar  java前台运行.</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@docker01 ~]# docker ps |awk &#x27;NR&gt;1&#123;print $1&#125;&#x27;</span><br><span class="line">a78b89faa502</span><br><span class="line">7f7b245ea594</span><br><span class="line">[root@docker01 ~]# docker ps -q</span><br><span class="line">a78b89faa502</span><br><span class="line">7f7b245ea594</span><br></pre></td></tr></table></figure><p>docker run -d name “oldboy_mysql5.7” -e MYSQL_ROOT_PASSWORD&#x3D;1 mysql:5.7-debian</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;基于centos7的安装与配置&lt;br&gt;yum install -y yum-utils device-mapper-persistentdata lvm2&lt;br&gt;#2.下载官方的docker yum源文件&lt;br&gt;yum-config-manager</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="centos7" scheme="http://example.com/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>ansible安装和配置</title>
    <link href="http://example.com/2024/04/16/linux/ansible/"/>
    <id>http://example.com/2024/04/16/linux/ansible/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.235Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、ansible安装和配置"><a href="#一、ansible安装和配置" class="headerlink" title="一、ansible安装和配置"></a>一、ansible安装和配置</h1><blockquote><p>Ansible 是一款 IT 自动化工具。主要应用场景有配置系统、软件部署、持续发布及不停服平滑滚动更新的高级任务编排。</p></blockquote><h2 id="1-1-检查epel是否安装，没安装即安装"><a href="#1-1-检查epel是否安装，没安装即安装" class="headerlink" title="1.1 检查epel是否安装，没安装即安装"></a>1.1 检查epel是否安装，没安装即安装</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum list | grep epel-release</span><br><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure><h2 id="1-2-配置epel清华镜像源"><a href="#1-2-配置epel清华镜像源" class="headerlink" title="1.2 配置epel清华镜像源"></a>1.2 配置epel清华镜像源</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sed -e &#x27;s!^metalink=!#metalink=!g&#x27;     -e &#x27;s!^#baseurl=!baseurl=!g&#x27;     -e &#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -e &#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure><h2 id="1-3-安装ansible"><a href="#1-3-安装ansible" class="headerlink" title="1.3 安装ansible"></a>1.3 安装ansible</h2>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install ansible –y</span><br></pre></td></tr></table></figure><h3 id="1-3-1-修改配置ansible配置文件"><a href="#1-3-1-修改配置ansible配置文件" class="headerlink" title="1.3.1 修改配置ansible配置文件"></a>1.3.1 修改配置ansible配置文件</h3><blockquote><p> <strong>vim &#x2F;etc&#x2F;ansible&#x2F;ansible.cfg</strong> 修改这个文件即可</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">71:host_key_checking = False </span><br><span class="line">111:log_path = /var/log/ansible.log </span><br></pre></td></tr></table></figure><h3 id="1-3-2-添加ansible的主机清单"><a href="#1-3-2-添加ansible的主机清单" class="headerlink" title="1.3.2 添加ansible的主机清单"></a>1.3.2 添加ansible的主机清单</h3><blockquote><p> <strong>vim &#x2F;etc&#x2F;ansible&#x2F;hosts</strong> 修改这个文件即可</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[web] </span><br><span class="line">172.16.1.7 </span><br><span class="line">[backup] </span><br><span class="line">172.16.1.41 </span><br><span class="line">[nfs] </span><br><span class="line">172.16.1.31</span><br></pre></td></tr></table></figure><h1 id="二、ansible命令模块"><a href="#二、ansible命令模块" class="headerlink" title="二、ansible命令模块"></a>二、ansible命令模块</h1><p>这是 <a href="https://docs.ansible.com/ansible/latest/module_plugin_guide/index.html">官方文档链接</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible-doc -l ##查看ansible已安装的模块</span><br><span class="line">ansible-doc 模块名 ##能看到模块详细信息</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m command -a &quot;hostname&quot;</span><br></pre></td></tr></table></figure><table><thead><tr><th><strong>all</strong></th><th><strong>指定所有主机,可以改为可以替换<code>all</code>为其他主机组的名称或者ip地址</strong></th></tr></thead><tbody><tr><td><strong>-m</strong></td><td><strong>指定要使用的模块</strong></td></tr><tr><td><strong>command</strong></td><td><strong>使用的模块</strong></td></tr><tr><td><strong>-a</strong></td><td><strong>传递给模块的参数</strong></td></tr><tr><td><strong>“hostname”</strong></td><td><strong>shell远程主机上执行的具体命令</strong></td></tr></tbody></table><h2 id="2-1-command模块"><a href="#2-1-command模块" class="headerlink" title="2.1 command模块"></a><strong>2.1 command模块</strong></h2><ul><li><strong>默认的模块，适合执行简单命令，不支持特殊符号</strong></li></ul><blockquote><p> <strong>2.1.1 例子：获取ip地址和主机名</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m command -a &quot;ip a s ens33&quot;</span><br><span class="line">ansible all -m command -a &quot;hostname&quot;</span><br></pre></td></tr></table></figure><h2 id="2-2-shell模块"><a href="#2-2-shell模块" class="headerlink" title="2.2 shell模块"></a><strong>2.2 shell模块</strong></h2><ul><li><strong>与command 类似，但是支持特殊符号</strong></li></ul><blockquote><h2 id="2-2-1-例子：ansible批量获取ip地址"><a href="#2-2-1-例子：ansible批量获取ip地址" class="headerlink" title="2.2.1 例子：ansible批量获取ip地址"></a><strong>2.2.1 例子：ansible批量获取ip地址</strong></h2></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m shell -a &quot;ip a s ens33 | awk -F &#x27;[ /]+&#x27; &#x27;NR==3&#123;print \$3&#125;&#x27;&quot;</span><br></pre></td></tr></table></figure><h2 id="2-3-script模块"><a href="#2-3-script模块" class="headerlink" title="2.3 script模块"></a><strong>2.3 script模块</strong></h2><ul><li><strong>分发脚本和运行脚本</strong></li></ul><blockquote><p> <strong>2.3.1例子 给前面几个还是比较相似的,分发脚本</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@m01 server_sh]# cat ansible_no.sh </span><br><span class="line">#!/bin/bash</span><br><span class="line">hostname</span><br><span class="line">hostname -I</span><br><span class="line">hostname -i</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m script -a &#x27;/root/server_sh/ansible_no.sh&#x27;</span><br></pre></td></tr></table></figure><h2 id="2-4-file模块"><a href="#2-4-file模块" class="headerlink" title="2.4 file模块"></a><strong>2.4 file模块</strong></h2><ul><li><strong>管理文件,管理目录,软连接</strong></li><li>详细看这个<a href="https://docs.ansible.com/ansible/2.9/modules/file_module.html">https://docs.ansible.com/ansible/2.9/modules/file_module.html</a></li></ul><blockquote><p> <strong>参数：ansible all -m file -a ‘path&#x3D;&#x2F;opt&#x2F;li.txt state&#x3D;touch’</strong></p></blockquote><table><thead><tr><th align="left"></th><th align="center"><strong>选项</strong></th></tr></thead><tbody><tr><td align="left"><strong>path 路径</strong></td><td align="center"><strong>文件或者目录的路径</strong></td></tr><tr><td align="left"><strong>state状态</strong></td><td align="center"><strong>➖touch创建文件<br />➖directory创建目录<br />➖absent删除目标文件<br />➖file(默认)更新文件<br /> ➖hard创建或更改硬链接与src一起使用<br />➖link创建或更改软链接与src一起使用<br /></strong></td></tr><tr><td align="left"><strong>src</strong></td><td align="center"><strong>要链接到的文件的路径</strong></td></tr><tr><td align="left"><strong>owner</strong></td><td align="center"><strong>设备目标文件的所属主</strong></td></tr><tr><td align="left"><strong>mode</strong></td><td align="center"><strong>生成的文件或目录应具有的权限</strong></td></tr><tr><td align="left"><strong>grounp</strong></td><td align="center"><strong>设备目标文件的所属组</strong></td></tr></tbody></table><blockquote><p>2.4.1 创建文件</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/opt/ceshi.txt state=touch&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.2 创建目录</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/app/a/b/ state=directory&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.3 软连接</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;src=/etc/hosts path=/opt/hosts state=link&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.4 创建文件,给予700权限,指定用户(前提:创建指定用户)</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/ans-backup/ owner=oldbo y group=oldboy mode=700 state=directory&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.5 删除文件夹</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/ans-backup/ state=absent&#x27;</span><br></pre></td></tr></table></figure><h2 id="2-5-copy"><a href="#2-5-copy" class="headerlink" title="2.5 copy"></a><strong>2.5 copy</strong></h2><ul><li><strong>远程分发文件,修改权限,所有者,备份 服务</strong> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m copy -a &#x27;src=/etc/hosts dest=/etc/hosts backup=yes&#x27;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-6-systemd"><a href="#2-6-systemd" class="headerlink" title="2.6 systemd"></a><strong>2.6 systemd</strong></h2><ul><li><strong>服务管理</strong></li></ul><h2 id="2-7-service-服务管理-了解-软件包"><a href="#2-7-service-服务管理-了解-软件包" class="headerlink" title="2.7 service 服务管理(了解) 软件包"></a><strong>2.7 service 服务管理(了解) 软件包</strong></h2><h2 id="2-8-yum源-yum-repository"><a href="#2-8-yum源-yum-repository" class="headerlink" title="2.8 yum源 yum_repository"></a><strong>2.8 yum源 yum_repository</strong></h2><h2 id="2-9-yum命令"><a href="#2-9-yum命令" class="headerlink" title="2.9 yum命令"></a><strong>2.9 yum命令</strong></h2><h2 id="get-url下载软件-系统管理"><a href="#get-url下载软件-系统管理" class="headerlink" title="get_url下载软件 系统管理"></a><strong>get_url下载软件 系统管理</strong></h2><h2 id="mount模块-挂载"><a href="#mount模块-挂载" class="headerlink" title="mount模块 挂载"></a><strong>mount模块 挂载</strong></h2><h2 id="cron模块-定时任务-用户管理"><a href="#cron模块-定时任务-用户管理" class="headerlink" title="cron模块 定时任务 用户管理"></a><strong>cron模块 定时任务 用户管理</strong></h2><h2 id="group模块-管理用户组"><a href="#group模块-管理用户组" class="headerlink" title="group模块 管理用户组"></a><strong>group模块 管理用户组</strong></h2><h2 id="user模块-管理用户"><a href="#user模块-管理用户" class="headerlink" title="user模块 管理用户"></a><strong>user模块 管理用户</strong></h2><h2 id="压缩解压-unarchive"><a href="#压缩解压-unarchive" class="headerlink" title="压缩解压(unarchive) ,"></a><strong>压缩解压(unarchive) ,</strong></h2><h2 id="rsync模块-synchronize"><a href="#rsync模块-synchronize" class="headerlink" title="rsync模块(synchronize),"></a><strong>rsync模块(synchronize),</strong></h2><h2 id="数据库模块-mysql-db-mysql-user"><a href="#数据库模块-mysql-db-mysql-user" class="headerlink" title="数据库模块(mysql_db,mysql_user)"></a><strong>数据库模块(mysql_db,mysql_user)</strong></h2><h2 id="ansible管理docker-k8s-zabbix-grafana"><a href="#ansible管理docker-k8s-zabbix-grafana" class="headerlink" title="ansible管理docker k8s zabbix grafana"></a><strong>ansible管理docker k8s zabbix grafana</strong></h2><h2 id="用于调试模块-ping-模块检查"><a href="#用于调试模块-ping-模块检查" class="headerlink" title="用于调试模块 ping 模块检查"></a><strong>用于调试模块 ping 模块检查</strong></h2><h2 id="ansible与其他节点连通性"><a href="#ansible与其他节点连通性" class="headerlink" title="ansible与其他节点连通性."></a><strong>ansible与其他节点连通性.</strong></h2><h2 id="debug-模块-用于检查-显示-变量"><a href="#debug-模块-用于检查-显示-变量" class="headerlink" title="debug 模块 用于检查&#x2F;显示 变量"></a><strong>debug 模块 用于检查&#x2F;显示 变量</strong></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、ansible安装和配置&quot;&gt;&lt;a href=&quot;#一、ansible安装和配置&quot; class=&quot;headerlink&quot; title=&quot;一、ansible安装和配置&quot;&gt;&lt;/a&gt;一、ansible安装和配置&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Ansible 是</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>linux python安装</title>
    <link href="http://example.com/2024/04/16/linux/linux%20python%E5%AE%89%E8%A3%85/"/>
    <id>http://example.com/2024/04/16/linux/linux%20python%E5%AE%89%E8%A3%85/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.715Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>注：本教程使用centos7进行安装</p></blockquote><h1 id="一、使用miniconda3-安装python"><a href="#一、使用miniconda3-安装python" class="headerlink" title="一、使用miniconda3 安装python"></a>一、使用miniconda3 安装python</h1><h3 id="1-1配置yum清华源（已配置跳过这步即可）"><a href="#1-1配置yum清华源（已配置跳过这步即可）" class="headerlink" title="1.1配置yum清华源（已配置跳过这步即可）"></a>1.1配置yum清华源（已配置跳过这步即可）</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sed -e &#x27;s|^mirrorlist=|#mirrorlist=|g&#x27; \</span><br><span class="line">    -e &#x27;s|^#baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos|g&#x27; \</span><br><span class="line">    -i.bak \</span><br><span class="line">    /etc/yum.repos.d/CentOS-*.repo</span><br></pre></td></tr></table></figure><blockquote><p>更新软件包缓存</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure><blockquote><p>安装一些包</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install wget vim net-tools -y</span><br></pre></td></tr></table></figure><h3 id="1-3开始安装miniconda3"><a href="#1-3开始安装miniconda3" class="headerlink" title="1.3开始安装miniconda3"></a>1.3开始安装miniconda3</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/miniconda3</span><br><span class="line">wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda3/miniconda.sh</span><br><span class="line">bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3</span><br><span class="line"><span class="built_in">rm</span> -rf ~/miniconda3/miniconda.sh</span><br><span class="line">~/miniconda3/bin/conda init bash</span><br><span class="line">~/miniconda3/bin/conda init zsh</span><br></pre></td></tr></table></figure><h4 id="1-3-1配置miniconda3清华源"><a href="#1-3-1配置miniconda3清华源" class="headerlink" title="1.3.1配置miniconda3清华源"></a>1.3.1配置miniconda3清华源</h4><p>vim ~&#x2F;.condarc</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - defaults</span><br><span class="line">show_channel_urls: true</span><br><span class="line">default_channels:</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span><br><span class="line">custom_channels:</span><br><span class="line">  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;注：本教程使用centos7进行安装&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;一、使用miniconda3-安装python&quot;&gt;&lt;a href=&quot;#一、使用miniconda3-安装python&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
</feed>
