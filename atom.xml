<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>相聚就是缘</title>
  
  <subtitle>生活不是一成不变的，而是不断在变化中寻找平衡</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-12-11T14:51:28.502Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>相聚就是缘</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/12/12/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/centos7-php7.2%E5%AE%89%E8%A3%85/"/>
    <id>http://example.com/2024/12/12/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/centos7-php7.2%E5%AE%89%E8%A3%85/</id>
    <published>2024-12-11T19:49:07.187Z</published>
    <updated>2024-12-11T14:51:28.502Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum -y install epel-release</span><br><span class="line">sed -e &#x27;s!^metalink=!#metalink=!g&#x27;     -e &#x27;s!^#baseurl=!baseurl=!g&#x27;     -e &#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -e &#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br><span class="line">yum update -y&amp;&amp; yum upgrade -y&amp;&amp; yum makecache -y</span><br><span class="line">yum install yum-utils -y</span><br><span class="line"></span><br><span class="line">yum install php72w php72w-cli php72w-devel php72w-common php72w-fpm php72w-opcache php72w-gd php72w-mysqlnd php72w-mbstring php72w-pecl-redis php72w-pecl-memcached -y</span><br><span class="line">systemctl enable php-fpm.service &amp;&amp; systemctl start php-fpm.service</span><br><span class="line"></span><br><span class="line">systemctl status php-fpm.service </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>mv &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default<br>cat &gt; &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf &lt;&lt;’EOF’<br>server {<br>    listen 80;<br>    server_name zbx.molu.cn;<br>    root &#x2F;app&#x2F;code&#x2F;zbx;<br>    location &#x2F; {<br>        index index.php;<br>    } </p><pre><code>location ~ \.php$ &#123;    fastcgi_pass   127.0.0.1:9000;    fastcgi_index  index.php;    fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;    include        fastcgi_params;&#125;</code></pre><p>EOF</p><p>sed -ri ‘&#x2F;^(user|group)&#x2F;s#apache#nginx#g’ &#x2F;etc&#x2F;php-fpm.d&#x2F;<a href="http://www.conf/">www.conf</a></p><p>cat &gt; &#x2F;app&#x2F;code&#x2F;zbx&#x2F;index.php &lt;&lt;’EOF’<br><?    php phpinfo(); ?><br>EOF</p><p>sed -ri ‘&#x2F;^(user|group)&#x2F;s#apache#nginx#g’ &#x2F;etc&#x2F;phpfpm.d&#x2F;<a href="http://www.conf/">www.conf</a><br>2. 进行检查<br>3. egrep ‘^(user|group)’ &#x2F;etc&#x2F;php-fpm.d&#x2F;<a href="http://www.conf/">www.conf</a></p><p>cat &gt; &#x2F;etc&#x2F;yum.repos.d&#x2F;MariaDB.repo &lt;&lt;”EOF”</p><h1 id="MariaDB-10-5-CentOS-repository-list-created-2024-05-21-06-00-UTC"><a href="#MariaDB-10-5-CentOS-repository-list-created-2024-05-21-06-00-UTC" class="headerlink" title="MariaDB 10.5 CentOS repository list - created 2024-05-21 06:00 UTC"></a>MariaDB 10.5 CentOS repository list - created 2024-05-21 06:00 UTC</h1><h1 id="https-mariadb-org-download"><a href="#https-mariadb-org-download" class="headerlink" title="https://mariadb.org/download/"></a><a href="https://mariadb.org/download/">https://mariadb.org/download/</a></h1><p>[mariadb]<br>name &#x3D; MariaDB</p><h1 id="rpm-mariadb-org-is-a-dynamic-mirror-if-your-preferred-mirror-goes-offline-See-https-mariadb-org-mirrorbits-for-details"><a href="#rpm-mariadb-org-is-a-dynamic-mirror-if-your-preferred-mirror-goes-offline-See-https-mariadb-org-mirrorbits-for-details" class="headerlink" title="rpm.mariadb.org is a dynamic mirror if your preferred mirror goes offline. See https://mariadb.org/mirrorbits/ for details."></a>rpm.mariadb.org is a dynamic mirror if your preferred mirror goes offline. See <a href="https://mariadb.org/mirrorbits/">https://mariadb.org/mirrorbits/</a> for details.</h1><h1 id="baseurl-https-rpm-mariadb-org-10-5-centos-releasever-basearch"><a href="#baseurl-https-rpm-mariadb-org-10-5-centos-releasever-basearch" class="headerlink" title="baseurl &#x3D; https://rpm.mariadb.org/10.5/centos/$releasever/$basearch"></a>baseurl &#x3D; <a href="https://rpm.mariadb.org/10.5/centos/$releasever/$basearch">https://rpm.mariadb.org/10.5/centos/$releasever/$basearch</a></h1><p>baseurl &#x3D; <a href="https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/10.5/centos/$releasever/$basearch">https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/10.5/centos/$releasever/$basearch</a><br>module_hotfixes &#x3D; 1</p><h1 id="gpgkey-https-rpm-mariadb-org-RPM-GPG-KEY-MariaDB"><a href="#gpgkey-https-rpm-mariadb-org-RPM-GPG-KEY-MariaDB" class="headerlink" title="gpgkey &#x3D; https://rpm.mariadb.org/RPM-GPG-KEY-MariaDB"></a>gpgkey &#x3D; <a href="https://rpm.mariadb.org/RPM-GPG-KEY-MariaDB">https://rpm.mariadb.org/RPM-GPG-KEY-MariaDB</a></h1><p>gpgkey &#x3D; <a href="https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB">https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB</a><br>gpgcheck &#x3D; 1<br>EOF</p><p>systemctl enable mariadb &amp;&amp;systemctl start mariadb</p><p>echo “&amp; y y 1 1 y y y y” | mysql_secure_installation<br>create database zabbix charset utf8 collate utf8_bin;</p><p>mysql zabbix &lt;schema.sql<br>mysql zabbix &lt;images.sql<br>mysql zabbix &lt;data.sql<br>mysql zabbix &lt;double.sql<br>mysql zabbix &lt;history_pk_prepare.sql</p><p>yum install -y mysql-devel pcre-devel openssl-devel zlib-devel libxml2-devel net-snmp-devel net-snmp libssh2-devel OpenIPMI-devel libevent-devel openldap-devel libcurl-devel</p><p>.&#x2F;configure –sysconfdir&#x3D;&#x2F;etc&#x2F;zabbix&#x2F; –enable-server –with-mysql –with-ssh2 –with-openipmi –with-net-snmp –with-libxml2 –with-zlib –with-libpthread –with-libevent –with-openssl –with-ldap –with-libcurl –with-libpcre</p><p>grep -n ‘^[a-Z]’ &#x2F;etc&#x2F;zabbix&#x2F;zabbix_server.conf</p><p>cat &gt; &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;zabbix-server.service &lt;&lt;”EOF”<br>[Unit]<br>Description&#x3D;Zabbix Server with MySQL DB<br>After&#x3D;syslog.target network.target<br>[Service]<br>Type&#x3D;simple<br>ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin&#x2F;zabbix_server -f<br>User&#x3D;zabbix<br>[Install]<br>WantedBy&#x3D;multi-user.target<br>EOF</p><p>systemctl enable zabbix-server&amp;&amp; systemctl start zabbix-server &amp;&amp;systemctl status zabbix-server</p><p>cp -r zabbix-6.0.5&#x2F;ui&#x2F;* &#x2F;app&#x2F;code&#x2F;zbx&#x2F;</p><p>egrep -n ‘^(max_.*_time|post_max)’ &#x2F;etc&#x2F;php.ini<br>368:max_execution_time &#x3D; 300 378:max_input_time &#x3D; 600 656:post_max_size &#x3D; 80M</p><p>sed -i ‘s#<a href="https://repo.zabbix.com/zabbix#https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/#g">https://repo.zabbix.com/zabbix#https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/#g</a>‘ &#x2F;etc&#x2F;yum.repos.d&#x2F;zabbix.repo</p><h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><pre><code> PHP不支持bcmath扩展(PHP配置参数--enable-bcmath).  yum install php72w-common php72w-bcmath -y</code></pre><h2 id="egrep-n-‘-max-time-post-max-’-etc-php-ini"><a href="#egrep-n-‘-max-time-post-max-’-etc-php-ini" class="headerlink" title="egrep -n ‘^(max_.*_time|post_max)’ &#x2F;etc&#x2F;php.ini"></a>egrep -n ‘^(max_.*_time|post_max)’ &#x2F;etc&#x2F;php.ini</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum -y install epel-release&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>crontab</title>
    <link href="http://example.com/2024/09/20/linux/crontab/"/>
    <id>http://example.com/2024/09/20/linux/crontab/</id>
    <published>2024-09-20T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:24.343Z</updated>
    
    <content type="html"><![CDATA[<p><code>crontab -e</code>编辑当前用户的定时任务<br><code>crontab -l</code> 查看当前用户的定时任务</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;crontab -e&lt;/code&gt;编辑当前用户的定时任务&lt;br&gt;&lt;code&gt;crontab -l&lt;/code&gt; 查看当前用户的定时任务&lt;/p&gt;
</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>centos7 mysql配置</title>
    <link href="http://example.com/2024/09/20/linux/mysql/"/>
    <id>http://example.com/2024/09/20/linux/mysql/</id>
    <published>2024-09-19T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.010Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt;/etc/my.cnf&lt;&lt;&#x27;EOF&#x27; </span><br><span class="line">#by oldboy weixin:oldboy0102 </span><br><span class="line">[mysqld]</span><br><span class="line">user=mysql</span><br><span class="line">basedir=/app/tools/mysql/</span><br><span class="line">datadir=/app/data/3306/ </span><br><span class="line">port=3306 socket=/tmp/mysql.sock</span><br><span class="line">[client]</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=/app/tools/mysql/bin:$PATH&#x27;</span> &gt;&gt; /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqld initialize-insecure user=mysql \ --basedir=/app/tools/mysql/ --datadir=/app/data/3306/</span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;@rootA1234&#x27;;</span><br><span class="line">create user &#x27;root&#x27;@&#x27;%&#x27; identified with mysql_native_password by &#x27;@rootA1234&#x27;;</span><br><span class="line">grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; with grant option;</span><br><span class="line">flush privileges;</span><br><span class="line"> ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;rootA.1234&#x27;;</span><br><span class="line">create user exam@&#x27;172.16.1.%&#x27; identified with mysql_native_password by &#x27;@rootA1234&#x27;; </span><br><span class="line">#授权 </span><br><span class="line">grant all on exam.* to exam@&#x27;172.16.1.%&#x27; ; </span><br><span class="line">#测试 </span><br><span class="line">mysql -uexam -p1 -h 172.16.1.52</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat&gt; application-prod.yml &lt;&lt;&#x27;EOF&#x27; </span><br><span class="line">logging: path: /usr/log/xzs/ </span><br><span class="line">spring: </span><br><span class="line">datasource: </span><br><span class="line">url: jdbc:mysql: 172.16.1.52:3306/exam? </span><br><span class="line">useSSL=false&amp;useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=co nvertToNull&amp;allowPublicKeyRetrieval=true&amp;allowMultiQ ueries=true </span><br><span class="line">username: exam </span><br><span class="line">password: 1 </span><br><span class="line">driver-class-name: com.mysql.cj.jdbc.Driver </span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -Duser.timezone=Asia/Shanghai -jar -Dspring.profiles.active=prod xzs-3.9.0.jar</span><br><span class="line">nohup java -Duser.timezone=Asia/Shanghai -jar -Dspring.profiles.active=prod xzs-3.9.0.jar &gt; start1.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/nginx/conf.d/exam.conf &lt;&lt;&quot;EOF&quot;</span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name admin.oldboylinux.cn; </span><br><span class="line">root /app/code/exam/front/admin/; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.html; </span><br><span class="line">&#125; </span><br><span class="line">location /api/ &#123; </span><br><span class="line">proxy_pass http://localhost:8000; </span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name stu.oldboylinux.cn; </span><br><span class="line">root /app/code/exam/front/student/; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.html; </span><br><span class="line">&#125; </span><br><span class="line">location /api/ &#123; </span><br><span class="line">proxy_pass http://localhost:8000; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat &amp;gt;/etc/my.cnf&amp;lt;&amp;lt;&amp;#x27;EOF&amp;#x27; &lt;/span&gt;&lt;b</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="centos7" scheme="http://example.com/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>history去掉行号</title>
    <link href="http://example.com/2024/06/19/linux/history%E8%A1%8C%E5%8F%B7%E9%97%AE%E9%A2%98/"/>
    <id>http://example.com/2024/06/19/linux/history%E8%A1%8C%E5%8F%B7%E9%97%AE%E9%A2%98/</id>
    <published>2024-06-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:24.605Z</updated>
    
    <content type="html"><![CDATA[<p>history去掉行号</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">history | sed &#x27;s/^[ ]*[0-9]\+[ ]*//&#x27; &gt; /root/history.txt</span><br></pre></td></tr></table></figure><p>正则用这个匹配</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">^[ ]*[0-9]+[ ]*</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;history去掉行号&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;history | sed &amp;#x27;s/^[ ]*[0-9]&#92;+[ ]</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>centos7各种源配置</title>
    <link href="http://example.com/2024/05/19/linux/%E5%90%84%E7%A7%8D%E6%BA%90%E9%85%8D%E7%BD%AE/"/>
    <id>http://example.com/2024/05/19/linux/%E5%90%84%E7%A7%8D%E6%BA%90%E9%85%8D%E7%BD%AE/</id>
    <published>2024-05-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:25.645Z</updated>
    
    <content type="html"><![CDATA[<h2 id="centos7-yum源配置"><a href="#centos7-yum源配置" class="headerlink" title="centos7-yum源配置"></a>centos7-yum源配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;s|^mirrorlist=|#mirrorlist=|g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s|^#baseurl=http://mirror.centos.org/centos|baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos|g&#x27;</span> \</span><br><span class="line">    -i.bak \</span><br><span class="line">    /etc/yum.repos.d/CentOS-*.repo</span><br></pre></td></tr></table></figure><h2 id="centos7-epel源配置"><a href="#centos7-epel源配置" class="headerlink" title="centos7-epel源配置"></a>centos7-epel源配置</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum makecache</span><br><span class="line">yum install epel-release -y</span><br><span class="line">sed -e <span class="string">&#x27;s!^metalink=!#metalink=!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!^#baseurl=!baseurl=!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;</span> \</span><br><span class="line">    -e <span class="string">&#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;</span> \</span><br><span class="line">    -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update -y &amp;&amp; yum upgrade -y</span><br></pre></td></tr></table></figure><p>yum install -y vim tree wget bash-completion bashcompletion-extras lrzsz net-tools sysstat iotop iftop htop unzip nc nmap telnet bc psmisc httpd-tools bindutils nethogs expect cowsay sl</p><h2 id="debian11配置"><a href="#debian11配置" class="headerlink" title="debian11配置"></a>debian11配置</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/apt/sources.list &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye main contrib non-free</span><br><span class="line"></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-updates main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-updates main contrib non-free</span><br><span class="line"></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-backports main contrib non-free</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-backports main contrib non-free</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb https://security.debian.org/debian-security bullseye-security main contrib non-free</span><br><span class="line"># deb-src https://security.debian.org/debian-security bullseye-security main contrib non-free</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>cat &gt; &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo &lt;&lt;’EOF’</p><p>[base]<br>name&#x3D;CentOS-$releasever - Base<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/os/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/os/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#released updates<br>[updates]<br>name&#x3D;CentOS-$releasever - Updates<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/updates/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/updates/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#additional packages that may be useful<br>[extras]<br>name&#x3D;CentOS-$releasever - Extras<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/extras/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/extras/$basearch/</a><br>gpgcheck&#x3D;1<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7</p><p>#additional packages that extend functionality of existing packages<br>[centosplus]<br>name&#x3D;CentOS-$releasever - Plus<br>#mirrorlist&#x3D;<a href="http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra">http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus&amp;infra=$infra</a><br>baseurl&#x3D;<a href="https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/centosplus/$basearch/">https://mirrors.ustc.edu.cn/centos-vault/centos/$releasever/centosplus/$basearch/</a><br>gpgcheck&#x3D;1<br>enabled&#x3D;0<br>gpgkey&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-CentOS-7<br>EOF</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;centos7-yum源配置&quot;&gt;&lt;a href=&quot;#centos7-yum源配置&quot; class=&quot;headerlink&quot; title=&quot;centos7-yum源配置&quot;&gt;&lt;/a&gt;centos7-yum源配置&lt;/h2&gt;&lt;figure class=&quot;highlight </summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>奇安信天擎旧版本退出有密码解决方案</title>
    <link href="http://example.com/2024/05/19/windows/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E9%80%80%E5%87%BA%E6%9C%89%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://example.com/2024/05/19/windows/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E9%80%80%E5%87%BA%E6%9C%89%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2024-05-19T07:44:14.000Z</published>
    <updated>2024-12-11T14:51:23.740Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>不是最新版本的</p></blockquote><h1 id="奇安信天擎退出有密码解决方案"><a href="#奇安信天擎退出有密码解决方案" class="headerlink" title="奇安信天擎退出有密码解决方案"></a>奇安信天擎退出有密码解决方案</h1><p>打开程序根目录,这个是默认安装目录：<strong>C:\Program Files (x86)\QAX\360safe\EntClient\conf</strong></p><p>在<strong>360safe</strong> –&gt; <strong>EntClient</strong>—&gt;<strong>conf</strong></p><p>然后找到<strong>EntBase.dat</strong></p><p><img src="C:\Users\Administrator\Pictures\无标题.png" alt="无标题"></p><p>打开文件找到<img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240504005752911.png" alt="image-20240504005752911"></p><p>改成0就可以了</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uienable=0</span><br><span class="line">qtenable=0</span><br></pre></td></tr></table></figure><p>保存以后程序就可以退出了，不需要密码</p><h2 id="把文件改成只读，防止再次配置"><a href="#把文件改成只读，防止再次配置" class="headerlink" title="把文件改成只读，防止再次配置"></a>把文件改成只读，防止再次配置</h2><p><strong>亲自测试：下面不把文件改成只读，软件再次打开需要在按照上面的操作再来一遍</strong></p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240504005646829.png" alt="image-20240504005646829"></p><p><code>开机自启的话使用火绒进行关闭即可,实测可以,但是会造成卡顿</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;不是最新版本的&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;奇安信天擎退出有密码解决方案&quot;&gt;&lt;a href=&quot;#奇安信天擎退出有密码解决方案&quot; class=&quot;headerlink&quot; title=&quot;奇安信天擎退出有密码解决方案&quot;&gt;&lt;/a&gt;奇安</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>nginx相关配置</title>
    <link href="http://example.com/2024/05/11/linux/nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D/"/>
    <id>http://example.com/2024/05/11/linux/nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D/</id>
    <published>2024-05-10T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.431Z</updated>
    
    <content type="html"><![CDATA[<h2 id="主配置文件nginx-conf"><a href="#主配置文件nginx-conf" class="headerlink" title="主配置文件nginx.conf"></a>主配置文件nginx.conf</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ~]# cat /etc/nginx/nginx.conf </span><br><span class="line"></span><br><span class="line">user  nginx; #nginx用户(虚拟用户)</span><br><span class="line">worker_processes  auto;   #进程数</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log notice;  #失败日志</span><br><span class="line">pid        /var/run/nginx.pid; #pid文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024; 并发数</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;  #引用媒体的类型</span><br><span class="line">    default_type  application/octet-stream; ##媒体默认类型</span><br><span class="line"></span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;  #日志格式</span><br><span class="line">    </span><br><span class="line">    access_log  /var/log/nginx/access.log  main; #正常日志</span><br><span class="line">    </span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    </span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    </span><br><span class="line">    #gzip  on;</span><br><span class="line">    </span><br><span class="line">    include /etc/nginx/conf.d/*.conf;  #nginx的子配置文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="子配置文件default-conf"><a href="#子配置文件default-conf" class="headerlink" title="子配置文件default.conf"></a>子配置文件default.conf</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ~]# cat /etc/nginx/conf.d/default.conf </span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;  # 网站端口</span><br><span class="line">    server_name  localhost; 网站域名</span><br><span class="line"></span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line">    </span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;   #站点目录</span><br><span class="line">    </span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line">    </span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;  #500 502 503 504报错文件</span><br><span class="line">    </span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line">    </span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    root           html;</span><br><span class="line">    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    #    fastcgi_index  index.php;</span><br><span class="line">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    #    include        fastcgi_params;</span><br><span class="line">    #&#125;</span><br><span class="line">    </span><br><span class="line">    # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class="line">    # concurs with nginx&#x27;s one</span><br><span class="line">    #</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;主配置文件nginx-conf&quot;&gt;&lt;a href=&quot;#主配置文件nginx-conf&quot; class=&quot;headerlink&quot; title=&quot;主配置文件nginx.conf&quot;&gt;&lt;/a&gt;主配置文件nginx.conf&lt;/h2&gt;&lt;figure class=&quot;highli</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>nginx安装与配置</title>
    <link href="http://example.com/2024/05/11/linux/nginx%E5%AE%89%E8%A3%85/"/>
    <id>http://example.com/2024/05/11/linux/nginx%E5%AE%89%E8%A3%85/</id>
    <published>2024-05-10T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.266Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、nginxg安装"><a href="#一、nginxg安装" class="headerlink" title="一、nginxg安装"></a>一、nginxg安装</h1><h2 id="1-yum安装"><a href="#1-yum安装" class="headerlink" title="1. yum安装"></a>1. yum安装</h2><h3 id="1-1-先决条件"><a href="#1-1-先决条件" class="headerlink" title="1.1 先决条件"></a>1.1 先决条件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install yum-utils</span><br></pre></td></tr></table></figure><h3 id="1-2-配置nginx的yum仓库"><a href="#1-2-配置nginx的yum仓库" class="headerlink" title="1.2 配置nginx的yum仓库"></a>1.2 配置nginx的yum仓库</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/yum.repos.d/nginx.repo &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line"></span><br><span class="line">[nginx-mainline]</span><br><span class="line">name=nginx mainline repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h3 id="1-3-安装nginx1-26"><a href="#1-3-安装nginx1-26" class="headerlink" title="1.3 安装nginx1.26"></a>1.3 安装nginx1.26</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install nginx-1.26.0 -y</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[root@web01 ~]# rpm -qa nginx</span><br><span class="line">nginx-1.26.0-1.el7.ngx.x86_64</span><br><span class="line">[root@web01 ~]# rpm -ql nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.1,nginx开机自启和启动</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl enable nginx &amp;&amp;systemctl start nginx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、nginxg安装&quot;&gt;&lt;a href=&quot;#一、nginxg安装&quot; class=&quot;headerlink&quot; title=&quot;一、nginxg安装&quot;&gt;&lt;/a&gt;一、nginxg安装&lt;/h1&gt;&lt;h2 id=&quot;1-yum安装&quot;&gt;&lt;a href=&quot;#1-yum安装&quot; class</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>综合架构搭建</title>
    <link href="http://example.com/2024/05/03/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/%E7%BB%BC%E5%90%88%E9%A1%B9%E7%9B%AE%E5%A4%A7%E5%85%A8/%E5%A4%A7%E8%87%B4%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    <id>http://example.com/2024/05/03/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/%E7%BB%BC%E5%90%88%E9%A1%B9%E7%9B%AE%E5%A4%A7%E5%85%A8/%E5%A4%A7%E8%87%B4%E8%99%9A%E6%8B%9F%E6%9C%BA/</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:45.584Z</updated>
    
    <content type="html"><![CDATA[<p><img src="C:\Users\zhang\Pictures\综合架构搭建.png" alt="综合架构搭建"></p><p><img src="C:\Users\zhang\Pictures\微信截图_20240531020950.png" alt="微信截图_20240531020950"><br>大致虚拟机</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1台防火墙</span><br><span class="line">2 台web-nginx主做负载均衡 </span><br><span class="line">4台web-nginx从</span><br><span class="line">2台数据库</span><br><span class="line">1台存储或者两台</span><br><span class="line">1台备份或者两台 和异地备份机器</span><br><span class="line">1台缓存redis</span><br><span class="line">1台gitlab</span><br><span class="line">1台jenkins</span><br><span class="line">3台监控Zabbix,Grafana,Prometheus</span><br><span class="line">1台vpn服务器,一台堡垒机,一台ansible批量管理主机</span><br><span class="line">cat &gt;&gt; /etc/hosts &lt;&lt; &#x27;EOF&#x27;</span><br><span class="line">firewalld-192.168.100.10  </span><br><span class="line">fz01-192.168.100.11       </span><br><span class="line">fz02-192.168.100.12       </span><br><span class="line">web01-192.168.100.21      </span><br><span class="line">web02-192.168.100.22      </span><br><span class="line">web03-192.168.100.23      |</span><br><span class="line">web04-192.168.100.24      |</span><br><span class="line">mysql01-192.168.100.31    |</span><br><span class="line">mysql02-192.168.100.32    |</span><br><span class="line">nfs01-192.168.100.41      |</span><br><span class="line">nfs02-192.168.100.42      |</span><br><span class="line">backup-192.168.100.51     |</span><br><span class="line">backup_vpn-192.168.100.52 |</span><br><span class="line">redis-192.168.100.53      |</span><br><span class="line">gitlab-192.168.100.61     |</span><br><span class="line">jenkins-192.168.100.62    |</span><br><span class="line">Zabbix-192.168.100.71     |</span><br><span class="line">Prometheus-192.168.100.72 |</span><br><span class="line">Grafana-192.168.100.73    |</span><br><span class="line">vpn-192.168.100.81        |</span><br><span class="line">jumpserver-192.168.100.91 |</span><br><span class="line">ansible-192.168.100.100   |</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><table><thead><tr><th>主机名称</th><th>ip 外网</th><th>ip内网</th><th>主机名</th><th>虚拟机名</th><th></th></tr></thead><tbody><tr><td>防火墙firewalld</td><td>10.0.0.10</td><td>192.168.100.10</td><td>firewalld</td><td>firewalld-192.168.100.10</td><td><strong>1核1GB</strong></td></tr><tr><td>负载均衡服务器fz01</td><td>10.0.0.11</td><td>192.168.100.11</td><td>fz01</td><td>fz01-192.168.100.11</td><td><strong>2核2GB</strong></td></tr><tr><td>负载均衡服务器fz02</td><td>10.0.0.12</td><td>192.168.100.12</td><td>fz02</td><td>fz02-192.168.100.12</td><td><strong>2核2GB</strong></td></tr><tr><td>web服务器01</td><td>10.0.0.21</td><td>192.168.100.21</td><td>web01</td><td>web01-192.168.100.21</td><td><strong>1核1GB</strong></td></tr><tr><td>web服务器02</td><td>10.0.0.22</td><td>192.168.100.22</td><td>web02</td><td>web02-192.168.100.22</td><td><strong>1核1GB</strong></td></tr><tr><td>web服务器03</td><td>10.0.0.23</td><td>192.168.100.23</td><td>web03</td><td>web03-192.168.100.23</td><td><strong>1核1GB</strong></td></tr><tr><td>web服务器04</td><td>10.0.0.24</td><td>192.168.100.24</td><td>web04</td><td>web04-192.168.100.24</td><td><strong>1核1GB</strong></td></tr><tr><td>mysql数据库01</td><td>10.0.0.31</td><td>192.168.100.31</td><td>mysql01</td><td>mysql01-192.168.100.31</td><td><strong>2核2GB</strong></td></tr><tr><td>mysql数据库02</td><td>10.0.0.32</td><td>192.168.100.32</td><td>mysql02</td><td>mysql02-192.168.100.32</td><td><strong>2核2GB</strong></td></tr><tr><td>nfs存储01</td><td>10.0.0.41</td><td>192.168.100.41</td><td>nfs01</td><td>nfs01-192.168.100.41</td><td><strong>1核1GB</strong></td></tr><tr><td>nfs存储02</td><td>10.0.0.42</td><td>192.168.100.42</td><td>nfs02</td><td>nfs02-192.168.100.42</td><td><strong>1核1GB</strong></td></tr><tr><td>backup备份机</td><td>10.0.0.51</td><td>192.168.100.51</td><td>backup</td><td>backup-192.168.100.51</td><td><strong>1核1GB</strong></td></tr><tr><td>异地备份机器backup_vpn</td><td>10.0.0.52</td><td>192.168.100.52</td><td>backup_vpn</td><td>backup_vpn-192.168.100.52</td><td><strong>1核1GB</strong></td></tr><tr><td>redis缓存服务器</td><td>10.0.0.53</td><td>192.168.100.53</td><td>redis</td><td>redis-192.168.100.53</td><td><strong>1核1GB</strong></td></tr><tr><td>gitlab 代码管理服务器</td><td>10.0.0.61</td><td>192.168.100.61</td><td>gitlab</td><td>gitlab-192.168.100.61</td><td><strong>2核2GB</strong></td></tr><tr><td>jenkins自动化服务器</td><td>10.0.0.62</td><td>192.168.100.62</td><td>jenkins</td><td>jenkins-192.168.100.62</td><td><strong>2核2GB</strong></td></tr><tr><td>监控服务器Zabbix</td><td>10.0.0.71</td><td>192.168.100.71</td><td>Zabbix</td><td>Zabbix-192.168.100.71</td><td><strong>2核2GB</strong></td></tr><tr><td>监控服务器Prometheus</td><td>10.0.0.72</td><td>192.168.100.72</td><td>Prometheus</td><td>Prometheus-192.168.100.72</td><td><strong>2核2GB</strong></td></tr><tr><td>监控服务器Grafana</td><td>10.0.0.73</td><td>192.168.100.73</td><td>Grafana</td><td>Grafana-192.168.100.73</td><td><strong>2核2GB</strong></td></tr><tr><td>vpn服务器</td><td>10.0.0.81</td><td>192.168.100.81</td><td>vpn</td><td>vpn-192.168.100.81</td><td><strong>1核1GB</strong></td></tr><tr><td>jumpserver堡垒机</td><td>10.0.0.91</td><td>192.168.100.91</td><td>jumpserver</td><td>jumpserver-192.168.100.91</td><td><strong>1核1GB</strong></td></tr><tr><td>ansible批量管理主机</td><td>10.0.0.100</td><td>192.168.100.100</td><td>ansible</td><td>ansible-192.168.100.100</td><td><strong>1核1GB</strong></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;C:&#92;Users&#92;zhang&#92;Pictures&#92;综合架构搭建.png&quot; alt=&quot;综合架构搭建&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;C:&#92;Users&#92;zhang&#92;Pictures&#92;微信截图_20240531020950.png&quot; alt=&quot;微信截图_2</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>vmware批量克隆虚拟机</title>
    <link href="http://example.com/2024/05/03/windows/vmware/"/>
    <id>http://example.com/2024/05/03/windows/vmware/</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在本地新建一个bat脚本如：1-bat-vmware-bat"><a href="#在本地新建一个bat脚本如：1-bat-vmware-bat" class="headerlink" title="在本地新建一个bat脚本如：1.bat,vmware.bat"></a>在本地新建一个bat脚本如：1.bat,vmware.bat</h1><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off  </span><br><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">chcp</span> <span class="number">65001</span> &gt;<span class="built_in">nul</span> </span><br><span class="line"></span><br><span class="line">:: 这个是你虚拟机的路径,自行填写,提醒目前只支持指定一台虚拟机进行批量克隆</span><br><span class="line"><span class="built_in">CD</span> &quot;C:\Program Files (x86)\VMware\VMware Workstation\&quot;</span><br><span class="line"></span><br><span class="line">:: 创建要克隆虚拟机的快照,<span class="number">12</span>是快照名</span><br><span class="line">vmrun -T ws snapshot &quot;D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx&quot; &quot;<span class="number">12</span>&quot;</span><br><span class="line"></span><br><span class="line">:: 这个是文件主机名和文件名例如：D:\vmkd\第二期环境\vmkd\web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span>\web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span>.vmx</span><br><span class="line">:: 这个vmlist格式为 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> 这样的中间要有空格</span><br><span class="line"><span class="built_in">set</span> &quot;vmList=web03-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">9</span> web02-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">8</span> web01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">7</span> m01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">61</span> <span class="number">1</span>b02-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">6</span> db01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">51</span> <span class="number">1</span>b01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">5</span> backup-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">41</span> nfs01-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">31</span> web04-<span class="number">10</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">10</span>&quot; </span><br><span class="line"></span><br><span class="line">:: 这个路径D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx选择你要克隆的虚拟机</span><br><span class="line">:: 这个路径D:\vmkd\第二期环境\vmkds\<span class="variable">%%n</span>\<span class="variable">%%n</span>.vmx这个是存放位置  linked为链接克隆，full为完整克隆 snapshot=&quot;<span class="number">12</span>&quot;是克隆虚拟机的快照名字另这个cloneName=&quot;<span class="variable">%%n</span>&quot;是克隆后的虚拟机名称</span><br><span class="line"><span class="keyword">for</span> <span class="variable">%%n</span> <span class="keyword">in</span> (<span class="variable">%vmList%</span>) <span class="keyword">do</span> ( </span><br><span class="line">    vmrun.exe -T ws clone &quot;D:\vmkd\第二期环境\CentOS <span class="number">7</span> <span class="number">64</span> 位备份.vmx&quot; &quot;D:\vmkd\第二期环境\vmkds\<span class="variable">%%n</span>\<span class="variable">%%n</span>.vmx&quot; linked -snapshot=&quot;<span class="number">12</span>&quot; -cloneName=&quot;<span class="variable">%%n</span>&quot;</span><br><span class="line"></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">endlocal</span></span><br></pre></td></tr></table></figure><p>python实现的 批量克隆虚拟机并修改虚拟机内部ip</p><p>流程是 拍快照 –&gt; 克隆快照 –&gt; 启动虚拟机 –&gt; 运行虚拟机里的shell脚本 –&gt; 关闭虚拟机 –&gt; 拍快照 </p><h1 id="下面是完整代码"><a href="#下面是完整代码" class="headerlink" title="下面是完整代码"></a>下面是完整代码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> concurrent.futures</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...（保留您原有的变量定义部分，这部分无需改动）</span></span><br><span class="line"></span><br><span class="line">hosts_info_2 = [</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;fz01&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.11&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;fz02&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.12&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;mysql01&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.31&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;mysql02&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.32&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;gitlab&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.61&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;jenkins&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.62&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Zabbix&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.71&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Prometheus&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.72&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hostname&quot;</span>: <span class="string">&quot;Grafana&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.100.73&quot;</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># # VMware Workstation的vmrun路径（确保此路径正确无误）</span></span><br><span class="line">vmrun_path = <span class="string">r&quot;C:\Program Files (x86)\VMware\VMware Workstation\vmrun.exe&quot;</span></span><br><span class="line">vmx_path = <span class="string">r&quot;D:\vmkd\CentOS7主机克隆\CentOS7主机克隆.vmx&quot;</span></span><br><span class="line">script_path = <span class="string">&quot;/root/shell/ceshi_copy.sh&quot;</span>  <span class="comment">#shell脚本位置</span></span><br><span class="line">guest_username = <span class="string">&quot;root&quot;</span>  <span class="comment">##虚拟机用户名</span></span><br><span class="line">guest_password = <span class="string">&quot;1&quot;</span>  <span class="comment">##虚拟机密码</span></span><br><span class="line">kuaizhao = <span class="string">&quot;hosts_info_2&quot;</span>  <span class="comment">#快照名</span></span><br><span class="line">kuaizhao_zi = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">create_snapshot_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; snapshot &quot;<span class="subst">&#123;vmx_path&#125;</span>&quot; &quot;<span class="subst">&#123;kuaizhao&#125;</span>&quot;&#x27;</span></span><br><span class="line">create_snapshot_cmd_sed = subprocess.run(create_snapshot_cmd, shell=<span class="literal">True</span>, capture_output=<span class="literal">True</span>)  <span class="comment">##创建快照</span></span><br><span class="line"><span class="keyword">if</span> create_snapshot_cmd_sed.returncode:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;错误：名称为的<span class="subst">&#123;kuaizhao&#125;</span>快照已存在&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retry</span>(<span class="params">func, max_attempts=<span class="number">3</span>, wait_time=<span class="number">5</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;简单的重试装饰器&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_attempts + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">if</span> attempt == max_attempts:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;操作失败，已达到最大尝试次数<span class="subst">&#123;max_attempts&#125;</span>。错误信息：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">raise</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;操作失败，正在进行第<span class="subst">&#123;attempt&#125;</span>次重试。&quot;</span>)</span><br><span class="line">                time.sleep(wait_time * attempt)  <span class="comment"># 每次失败后等待时间逐渐增加</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clone_vm</span>(<span class="params">clone_vm_name, clone_vm_full_path</span>):</span><br><span class="line">    clone_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws clone &quot;<span class="subst">&#123;vmx_path&#125;</span>&quot; &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; linked -snapshot=&quot;<span class="subst">&#123;kuaizhao&#125;</span>&quot; -cloneName=&quot;<span class="subst">&#123;clone_vm_name&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(clone_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_vm</span>(<span class="params">clone_vm_full_path</span>):</span><br><span class="line">    start_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws start &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(start_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_shell_in_guest</span>(<span class="params">clone_vm_full_path, host_info</span>):</span><br><span class="line">    run_shell_cmd = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws -gu <span class="subst">&#123;guest_username&#125;</span> -gp <span class="subst">&#123;guest_password&#125;</span> runScriptInGuest &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; &quot;/bin/bash&quot; &quot;<span class="subst">&#123;script_path&#125;</span> <span class="subst">&#123;host_info[<span class="string">&quot;hostname&quot;</span>]&#125;</span> <span class="subst">&#123;host_info[<span class="string">&quot;ip&quot;</span>].split(<span class="string">&quot;.&quot;</span>)[-<span class="number">1</span>]&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(run_shell_cmd, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_snapshot</span>(<span class="params">clone_vm_full_path, snapshot_name</span>):</span><br><span class="line">    create_snapshot_cmd_two = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; snapshot &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot; &quot;<span class="subst">&#123;snapshot_name&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(create_snapshot_cmd_two, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_host</span>(<span class="params">host_info</span>):</span><br><span class="line">    clone_vm_name = host_info[<span class="string">&quot;hostname&quot;</span>] + <span class="string">&#x27;-&#x27;</span> + host_info[<span class="string">&quot;ip&quot;</span>]</span><br><span class="line">    clone_vm_path = <span class="string">fr&quot;D:\vmkd\xiangmo\Prometheus\&#123;clone_vm_name&#125;&quot;</span></span><br><span class="line">    clone_vm_full_path = os.path.join(clone_vm_path, clone_vm_name) + <span class="string">&quot;.vmx&quot;</span></span><br><span class="line">    time.sleep(random.randint(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line">    clone_vm(clone_vm_name, clone_vm_full_path)</span><br><span class="line">    time.sleep(random.randint(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># 确保克隆操作完成</span></span><br><span class="line"></span><br><span class="line">    start_vm(clone_vm_full_path)</span><br><span class="line">    time.sleep(random.randint(<span class="number">40</span>, <span class="number">50</span>))  <span class="comment"># 等待虚拟机启动稳定</span></span><br><span class="line"></span><br><span class="line">    run_shell_in_guest(clone_vm_full_path, host_info)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;clone_vm_name&#125;</span>运行shell完成&quot;</span>)</span><br><span class="line">    time.sleep(random.randint(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line">    run_stop = <span class="string">f&#x27;&quot;<span class="subst">&#123;vmrun_path&#125;</span>&quot; -T ws stop &quot;<span class="subst">&#123;clone_vm_full_path&#125;</span>&quot;&#x27;</span></span><br><span class="line">    subprocess.run(run_stop, shell=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line">    time.sleep(<span class="number">20</span>)  <span class="comment"># 等待虚拟机关机</span></span><br><span class="line"></span><br><span class="line">    create_snapshot(clone_vm_full_path, kuaizhao_zi)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">10</span>) <span class="keyword">as</span> executor:</span><br><span class="line">    futures = &#123;executor.submit(process_host, host_info) <span class="keyword">for</span> host_info <span class="keyword">in</span> hosts_info_2&#125;</span><br><span class="line">    <span class="keyword">for</span> future <span class="keyword">in</span> concurrent.futures.as_completed(futures):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            future.result()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;处理主机时出现错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在本地新建一个bat脚本如：1-bat-vmware-bat&quot;&gt;&lt;a href=&quot;#在本地新建一个bat脚本如：1-bat-vmware-bat&quot; class=&quot;headerlink&quot; title=&quot;在本地新建一个bat脚本如：1.bat,vmware.bat&quot;&gt;</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="vmware" scheme="http://example.com/tags/vmware/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>zabbix-agen2批量部署</title>
    <link href="http://example.com/2024/05/03/zabbix/zabbix/"/>
    <id>http://example.com/2024/05/03/zabbix/zabbix/</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.881Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>杂稿，记录一下，方便以后修改</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/nginx/conf.d/default.conf &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">server &#123; </span><br><span class="line">listen 80; </span><br><span class="line">server_name zbx.molu.cn; </span><br><span class="line">root /app/code/zbx; </span><br><span class="line">location / &#123; </span><br><span class="line">index index.php; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">fastcgi_index  index.php;</span><br><span class="line">fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">includefastcgi_params;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /app/code/zbx/index.php &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">&lt;?php </span><br><span class="line">phpinfo(); </span><br><span class="line">?&gt;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod -R 777 /app/code/zbx/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/yum.repos.d/MariaDB.repo &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/10.5/centos/$releasever/$basearch</span><br><span class="line">module_hotfixes = 1</span><br><span class="line">gpgkey = https://mirrors.tuna.tsinghua.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck = 1</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum makecache -y &amp;&amp; yum update -y</span><br><span class="line">yum install mariadb-server -y</span><br><span class="line">systemctl enable mariadb &amp;&amp;systemctl start mariadb</span><br><span class="line">msyql -uroot -p1</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mv zabbix-6.0.29.tar.gz ~</span><br><span class="line"></span><br><span class="line">tar xf zabbix-6.0.29.tar.gz </span><br><span class="line">cd zabbix-6.0.29/database/mysql/</span><br><span class="line">mysql zabbix &lt;schema.sql </span><br><span class="line">mysql zabbix &lt;images.sql </span><br><span class="line">mysql zabbix &lt;data.sql </span><br><span class="line">mysql zabbix &lt;double.sql </span><br><span class="line">mysql zabbix &lt;history_pk_prepare.sql</span><br><span class="line">测试</span><br><span class="line">mysql -e &#x27;show tables from zabbix;&#x27; |wc -l</span><br><span class="line">yum install -y mysql-devel pcre-devel openssl-devel zlib-devel libxml2-devel net-snmp-devel net-snmp libssh2-devel OpenIPMI-devel libevent-devel openldap-devel libcurl-devel</span><br><span class="line"></span><br><span class="line">./configure --sysconfdir=/etc/zabbix/ --enable-server --with-mysql --with-ssh2 --with-openipmi --with-net-snmp --with-libxml2 --with-zlib --with-libpthread --with-libevent --with-openssl --with-ldap --with-libcurl --with-libpcre</span><br><span class="line">make install</span><br><span class="line">echo $?</span><br><span class="line">vim /etc/zabbix/zabbix_server.conf</span><br><span class="line">grep -n &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_server.conf</span><br><span class="line">useradd -s /sbin/nologin -M zabbix</span><br><span class="line">zabbix_server</span><br><span class="line">ss -lntup | grep 10051</span><br><span class="line">ps -ef |grep zabbix</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /usr/lib/systemd/system/zabbix-server.service &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[Unit]</span><br><span class="line">Description=Zabbix Server with MySQL DB</span><br><span class="line">After=syslog.target network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/usr/local/sbin/zabbix_server -f</span><br><span class="line">User=zabbix</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl daemon-reload </span><br><span class="line">pkill zabbix_server</span><br><span class="line">ps -ef | grep zabbix</span><br><span class="line">ps -ef | grep 10015</span><br><span class="line">systemctl enable zabbix-server&amp;&amp; systemctl start zabbix-server &amp;&amp;systemctl status zabbix-server</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cp -r ui/* /app/code/zbx/</span><br><span class="line">ll /app/code/zbx/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/php.ini </span><br><span class="line">systemctl restart php-fpm.service </span><br><span class="line">yum install php-bcmath php-mbstring</span><br><span class="line">yum install php72w-common</span><br><span class="line">yum install php72w-bcmath</span><br><span class="line">systemctl restart php-fpm.service </span><br><span class="line">chmod -R 777 /app/code/zbx/</span><br><span class="line">cat /app/code/zbx/conf/zabbix.conf.php</span><br></pre></td></tr></table></figure><h1 id="zabbix-agen2批量部署"><a href="#zabbix-agen2批量部署" class="headerlink" title="zabbix-agen2批量部署"></a>zabbix-agen2批量部署</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -ivg https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/6.0/rhel/7/x86_64/zabbix-release-latest.el7.noarch.rpm</span><br><span class="line">sed -i &#x27;s#https://repo.zabbix.com/zabbix#https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/#g&#x27; /etc/yum.repos.d/zabbix.repo</span><br><span class="line">yum update</span><br><span class="line">yum install -y zabbix-agent2</span><br><span class="line">sed -i &#x27;s#Server=127.0.0.1#Server=172.16.1.63#g&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">systemctl enable zabbix-agent2.service &amp;&amp;systemctl start zabbix-agent2.service</span><br><span class="line">grep &#x27;^[a-Z]&#x27; /etc/zabbix/zabbix_agent2.conf</span><br><span class="line">ps -ef | grep agent2</span><br><span class="line">ss -lntup | grep agent2</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@web01 ]# </span><br><span class="line">mv /etc/nginx/conf.d</span><br><span class="line">cat &gt; /etc/nginx/conf.d/status.conf  &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">server &#123; </span><br><span class="line">  listen 8000; </span><br><span class="line">  location / &#123; </span><br><span class="line">stub_status; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">  [root@web01 /etc/nginx/conf.d]# </span><br><span class="line">  curl http: localhost:8000/ </span><br><span class="line">  Active connections: 1 server accepts </span><br><span class="line">  handled requests 111 Reading: 0 Writing: 1 Waiting: 0 </span><br><span class="line">  [root@web01 /etc/nginx/conf.d]# curl http: localhost:8000/dddddd </span><br><span class="line">  Active connections: 1 server accepts handled requests 222 </span><br><span class="line">  Reading: 0 Writing: 1 Waiting: 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="zabbix中文解决办法"><a href="#zabbix中文解决办法" class="headerlink" title="zabbix中文解决办法"></a>zabbix中文解决办法</h2><p>更好默认字体即可</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  mv /app/code/zbx/assets/fonts/DejaVuSans.ttf /app/code/zbx/assets/fonts/DejaVuSans</span><br><span class="line">cp MSYH.TTC /app/code/zbx/assets/fonts/DejaVuSans.ttf</span><br><span class="line">systemctl restart zabbix</span><br><span class="line">systemctl restart zabbix-server.service </span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/zabbix/zabbix_agent2.d/web.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#UserParameter=key,cmd </span><br><span class="line">#UserParameter=check.ngx,sh /server/scripts/xxx.sh </span><br><span class="line">UserParameter=check.ngx,ss -lntup|grep -w 80|wc -l</span><br><span class="line">EOF</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">LogFileSize=0 Server=172.16.1.63 ServerActive=172.16.1.63 </span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line">HostMetadataItem=system.uname </span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf </span><br><span class="line">ControlSocket=/tmp/agent.sock </span><br><span class="line">Include=./zabbix_agent2.d/plugins.d/*.conf</span><br><span class="line"></span><br><span class="line">PidFile=/run/zabbix/zabbix_agent2.pid</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_agent2.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">Server=172.16.1.63</span><br><span class="line">ServerActive=172.16.1.63</span><br><span class="line">Hostname=Zabbix server</span><br><span class="line">HostnameItem=system.hostname</span><br><span class="line">HostMetadataItem=system.uname</span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf</span><br><span class="line">PluginSocket=/run/zabbix/agent.plugin.sock</span><br><span class="line">ControlSocket=/run/zabbix/agent.sock</span><br><span class="line">Include=./zabbix_agent2.d/plugins.d/*.conf</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;杂稿，记录一下，方便以后修改&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="zabbix" scheme="http://example.com/tags/zabbix/"/>
    
  </entry>
  
  <entry>
    <title>pig项目搭建部署</title>
    <link href="http://example.com/2024/05/02/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/java_pig/java_pig/"/>
    <id>http://example.com/2024/05/02/%E4%B8%80%E4%BA%9B%E6%96%87%E4%BB%B6/%E9%A1%B9%E7%9B%AE/java_pig/java_pig/</id>
    <published>2024-05-01T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:44.022Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装需要环境"><a href="#安装需要环境" class="headerlink" title="安装需要环境"></a>安装需要环境</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install epel-release wget -y</span><br><span class="line">cat &gt;&gt; /etc/hosts &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">127.0.0.1   pig-mysql</span><br><span class="line">127.0.0.1   pig-redis</span><br><span class="line">127.0.0.1   pig-gateway</span><br><span class="line">127.0.0.1   pig-register</span><br><span class="line">127.0.0.1   pig-sentinel</span><br><span class="line">127.0.0.1   pig-job</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">sed -e &#x27;s!^metalink=!#metalink=!g&#x27; \</span><br><span class="line">    -e &#x27;s!^#baseurl=!baseurl=!g&#x27; \</span><br><span class="line">    -e &#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27; \</span><br><span class="line">    -e &#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27; \</span><br><span class="line">    -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/yum.repos.d/nginx.repo &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line">[nginx-mainline]</span><br><span class="line">name=nginx mainline repo</span><br><span class="line">baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum update -y &amp;&amp; yum upgrade -y &amp;&amp; yum makecache -y</span><br></pre></td></tr></table></figure><h1 id="安装java和mysql-xdg-utils-mysql-nginx-redis"><a href="#安装java和mysql-xdg-utils-mysql-nginx-redis" class="headerlink" title="安装java和mysql,xdg-utils,mysql,nginx,redis"></a>安装java和mysql,xdg-utils,mysql,nginx,redis</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -c --tries=5 https://cdn.azul.com/zulu/bin/zulu17.44.15-ca-jdk17.0.8-linux.x86_64.rpm</span><br><span class="line"></span><br><span class="line">rpm -ivh zulu17.44.15-ca-jdk17.0.8-linux.x86_64.rpm</span><br><span class="line">java -version</span><br><span class="line">yum install -y fontconfig mkfontscale</span><br><span class="line">wget -c --tries=5 https://www.gitlink.org.cn/attachments/entries/get_file?download_url=https://www.gitlink.org.cn/api/lengleng/mirror/raw/mysql80-community-release-el7-11.noarch.rpm?ref=master -O mysql80-community-release-el7-7.noarch.rpm</span><br><span class="line">rpm -ivh mysql80-community-release-el7-7.noarch.rpm</span><br><span class="line"></span><br><span class="line"># 前端框架需要xdg-utils,mysql,nginx,redis</span><br><span class="line">yum install -y mysql mysql-server redis nginx  git xdg-utils -y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir -p /opt/code/run/&#123;dist,back_jar&#125;</span><br><span class="line">git clone https://gitee.com/log4j/pig.git /opt/code/build/pig-back-end -b jdk17</span><br><span class="line">git clone https://gitee.com/log4j/pig-ui.git /opt/code/build/pig-ui-web </span><br><span class="line"></span><br><span class="line">systemctl enable redis &amp;&amp; systemctl start redis </span><br><span class="line">systemctl enable nginx &amp;&amp; systemctl start nginx </span><br></pre></td></tr></table></figure><h2 id="mysql配置"><a href="#mysql配置" class="headerlink" title="mysql配置"></a>mysql配置</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">sed -i &#x27;5 a lower_case_table_names=1&#x27; /etc/my.cnf</span><br><span class="line">systemctl restart mysqld</span><br><span class="line"># mysql -uroot -p`grep password /var/log/mysqld.log | awk -F &quot;: &quot; &#x27;&#123;print $2&#125;&#x27; | grep -v &#x27; &#x27; `</span><br><span class="line">mysql --connect-expired-password -h localhost  -uroot -p`grep password /var/log/mysqld.log | awk -F &quot;: &quot; &#x27;&#123;print $2&#125;&#x27; | grep -v &#x27; &#x27; ` &lt;&lt;EOF</span><br><span class="line">alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;ZxcRoot123!@#&#x27;;</span><br><span class="line">set global validate_password.check_user_name=0;</span><br><span class="line">set global validate_password.policy=0;</span><br><span class="line">set global validate_password.length=1;</span><br><span class="line">alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;root&#x27;;</span><br><span class="line"></span><br><span class="line"># 修改为允许远程访问</span><br><span class="line">use mysql;</span><br><span class="line">update user set host = &#x27;%&#x27; where user = &#x27;root&#x27;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">source /opt/code/build/pig-back-end/db/pig.sql;</span><br><span class="line">source /opt/code/build/pig-back-end/db/pig_config.sql;</span><br><span class="line">quit</span><br><span class="line"></span><br><span class="line">EOF</span><br><span class="line">systemctl enable mysqld &amp;&amp; systemctl start mysqld </span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="安装maven和配置maven"><a href="#安装maven和配置maven" class="headerlink" title="安装maven和配置maven"></a>安装maven和配置maven</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p /usr/local/maven/</span><br><span class="line">wget -c --tries=5 https://dlcdn.apache.org/maven/maven-3/3.9.7/binaries/apache-maven-3.9.7-bin.tar.gz</span><br><span class="line"></span><br><span class="line">tar xf apache-maven-3.9.7-bin.tar.gz -C /usr/local/maven/</span><br><span class="line">ln -s /usr/local/maven/apache-maven-3.9.7/ /usr/local/maven/apache-maven</span><br><span class="line">cat &gt;&gt; /etc/profile &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">MAVEN_HOME=/usr/local/maven/apache-maven</span><br><span class="line">export PATH=$&#123;MAVEN_HOME&#125;/bin:$&#123;PATH&#125;</span><br><span class="line">EOF</span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">sed -i &#x27;/&lt;mirrors&gt;/a \</span><br><span class="line">    &lt;mirror&gt;\</span><br><span class="line">      &lt;id&gt;nexus-aliyun&lt;/id&gt;\</span><br><span class="line">      &lt;name&gt;Nexus Aliyun&lt;/name&gt;\</span><br><span class="line">      &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;\</span><br><span class="line">      &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;\</span><br><span class="line">    &lt;/mirror&gt;\</span><br><span class="line">&#x27; /usr/local/maven/apache-maven-3.9.7/conf/settings.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="配置nginx代理"><a href="#配置nginx代理" class="headerlink" title="配置nginx代理"></a>配置nginx代理</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /etc/nginx/conf.d &amp;&amp; rm -f default.conf</span><br><span class="line">cat &gt; /etc/nginx/conf.d/pig.conf &lt;&lt;&#x27;EOF&#x27;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name pig.molu.com; # 改为自己域名</span><br><span class="line"></span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_static on;     # 需要http_gzip_static_module 模块</span><br><span class="line">    gzip_min_length 1k;</span><br><span class="line">    gzip_comp_level 4;</span><br><span class="line">    gzip_proxied any;</span><br><span class="line">    gzip_types text/plain text/xml text/css;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_http_version   1.0; #兼容多层nginx 反代</span><br><span class="line">    gzip_disable &quot;MSIE [1-6]\.(?!.*SV1)&quot;;</span><br><span class="line"></span><br><span class="line">    # 打包好的dist目录文件，放置到这个目录下</span><br><span class="line">    root /opt/code/run/dist;</span><br><span class="line">    </span><br><span class="line">    # 注意维护新增微服务，gateway 路由前缀</span><br><span class="line">    location ^~/api/ &#123;</span><br><span class="line">        proxy_pass http://pig-gateway:9999/; #注意/后缀</span><br><span class="line">        proxy_connect_timeout 60s;</span><br><span class="line">        proxy_read_timeout 120s;</span><br><span class="line">        proxy_send_timeout 120s;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto http;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        proxy_set_header from &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    # 避免端点安全问题</span><br><span class="line">    if ($request_uri ~ &quot;/actuator&quot;)&#123;</span><br><span class="line">        return 403;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h2 id="安装node16-20"><a href="#安装node16-20" class="headerlink" title="安装node16.20"></a>安装node16.20</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -c --tries=5 https://mirror.tuna.tsinghua.edu.cn/nodejs-release/v16.20.2/node-v16.20.2-linux-x64.tar.gz</span><br><span class="line"></span><br><span class="line">tar xf node-v16.20.2-linux-x64.tar.gz </span><br><span class="line">mv node-v16.20.2-linux-x64 /opt/</span><br><span class="line">ln -sf /opt/node-v16.20.2-linux-x64/bin/npm /usr/local/bin/npm </span><br><span class="line">ln -sf /opt/node-v16.20.2-linux-x64/bin/node /usr/local/bin/node</span><br><span class="line">npm config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>##编译前端和后端程序</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /opt/code/build/pig-back-end</span><br><span class="line">mvn clean install -Pcloud</span><br><span class="line"></span><br><span class="line">find /opt/code -type f -name &quot;*.jar&quot;|xargs mv -t /opt/code/run/back_jar</span><br><span class="line"></span><br><span class="line">cd /opt/code/build/pig-ui-web </span><br><span class="line"></span><br><span class="line">npm install</span><br><span class="line">npm run build</span><br><span class="line">mv /opt/code/build/pig-ui-web/dist/* /opt/code/run/dist</span><br><span class="line"></span><br><span class="line">nginx -s reload</span><br><span class="line"></span><br><span class="line">cd /opt/code/run/back_jar</span><br></pre></td></tr></table></figure><h2 id="启动java程序"><a href="#启动java程序" class="headerlink" title="启动java程序"></a>启动java程序</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-register.jar &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-monitor.jar &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-gateway.jar &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-auth.jar &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-upms-biz.jar &gt; pig-upms-biz.log 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-codegen.jar &gt; pig-codegen.log 2&gt;&amp;1 &amp;</span><br><span class="line">nohup java -Dfile.encoding=utf-8 -jar pig-quartz.jar &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;安装需要环境&quot;&gt;&lt;a href=&quot;#安装需要环境&quot; class=&quot;headerlink&quot; title=&quot;安装需要环境&quot;&gt;&lt;/a&gt;安装需要环境&lt;/h1&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=</summary>
      
    
    
    
    <category term="ssh" scheme="http://example.com/categories/ssh/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>ssh免密登录配置</title>
    <link href="http://example.com/2024/05/02/windows/ssh/"/>
    <id>http://example.com/2024/05/02/windows/ssh/</id>
    <published>2024-05-01T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.304Z</updated>
    
    <content type="html"><![CDATA[<h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="1-ERROR-Host-key-verification-failed"><a href="#1-ERROR-Host-key-verification-failed" class="headerlink" title="1.ERROR: Host key verification failed."></a>1.ERROR: Host key verification failed.</h2><p><code>ssh-copy-id -i ~/.ssh/id_ed25519.pub root@10.0.100.1</code></p><h3 id="1-1报错信息"><a href="#1-1报错信息" class="headerlink" title="1.1报错信息"></a>1.1报错信息</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/c/Users/Administrator/.ssh/id_ed25519.pub&quot;</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span><br><span class="line"></span><br><span class="line">/usr/bin/ssh-copy-id: ERROR: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line">ERROR: @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class="line">ERROR: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line">ERROR: IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class="line">ERROR: Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class="line">ERROR: It is also possible that a host key has just been changed.</span><br><span class="line">ERROR: The fingerprint for the ED25519 key sent by the remote host is</span><br><span class="line">ERROR: SHA256:hldheoaTxodVcyGltGuPUP+zQOiV7BsJw8I9WSX4OFc.</span><br><span class="line">ERROR: Please contact your system administrator.</span><br><span class="line">ERROR: Add correct host key in /c/Users/Administrator/.ssh/known_hosts to get rid of this message.</span><br><span class="line">ERROR: Offending ECDSA key in /c/Users/Administrator/.ssh/known_hosts:6  </span><br><span class="line">ERROR: Host key for 10.0.100.1 has changed and you have requested strict checking.</span><br><span class="line">ERROR: Host key verification failed.</span><br></pre></td></tr></table></figure><p>找到ssh文件下的known_hosts文件,将如有：<strong>10.0.100.1</strong>整行全部删除<br>known_hosts文件在<code>.ssh</code>下,不知道在哪，就看上面的报错信息</p><p>BBS-Go项目编译安装67</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;常见问题&quot;&gt;&lt;a href=&quot;#常见问题&quot; class=&quot;headerlink&quot; title=&quot;常见问题&quot;&gt;&lt;/a&gt;常见问题&lt;/h1&gt;&lt;h2 id=&quot;1-ERROR-Host-key-verification-failed&quot;&gt;&lt;a href=&quot;#1-ERROR-H</summary>
      
    
    
    
    <category term="ssh" scheme="http://example.com/categories/ssh/"/>
    
    
    <category term="ssh" scheme="http://example.com/tags/ssh/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>淘宝nginx安装与配置</title>
    <link href="http://example.com/2024/05/02/linux/%E6%B7%98%E5%AE%9Dnginx/"/>
    <id>http://example.com/2024/05/02/linux/%E6%B7%98%E5%AE%9Dnginx/</id>
    <published>2024-05-01T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.790Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>系统ubuntu20.04</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt update -y</span><br><span class="line">apt install wget -y</span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line">dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line"></span><br><span class="line">wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/</span><br><span class="line">tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/</span><br><span class="line">apt-get install -y wget libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev</span><br><span class="line"></span><br><span class="line">cd /tmp/tengine-3.1.0/</span><br><span class="line">./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-http_v2_module \</span><br><span class="line">--with-http_realip_module \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-http_mp4_module \</span><br><span class="line">--with-stream \</span><br><span class="line">--with-stream_ssl_module \</span><br><span class="line">--with-stream_realip_module \</span><br><span class="line">--add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">--add-module=modules/ngx_http_upstream_session_sticky_module</span><br><span class="line">make &amp;&amp;make install</span><br><span class="line">groupadd nginx&amp;&amp;useradd -g nginx nginx</span><br><span class="line"></span><br><span class="line">ln -s /app/tools/tengine-3.1.0 /app/tools/tengine</span><br><span class="line">ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br></pre></td></tr></table></figure><p>Dockerfile无变量</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM ubuntu:20.04</span><br><span class="line">LABEL author=&quot;相聚就是缘&quot;</span><br><span class="line"></span><br><span class="line">RUN apt update -y \</span><br><span class="line">    &amp;&amp; apt install wget -y</span><br><span class="line">RUN wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb \</span><br><span class="line">    &amp;&amp; dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line"></span><br><span class="line">RUN cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">RUN apt update -y &amp;&amp; apt upgrade -y \</span><br><span class="line">    &amp;&amp;wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/ \</span><br><span class="line">    &amp;&amp; tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/ \</span><br><span class="line">    &amp;&amp; apt-get install -y libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev \</span><br><span class="line">    &amp;&amp; cd /tmp/tengine-3.1.0/ \</span><br><span class="line">    &amp;&amp; ./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">    --user=nginx \</span><br><span class="line">    --group=nginx \</span><br><span class="line">    --with-http_ssl_module \</span><br><span class="line">    --with-http_v2_module \</span><br><span class="line">    --with-http_realip_module \</span><br><span class="line">    --with-http_stub_status_module \</span><br><span class="line">    --with-http_mp4_module \</span><br><span class="line">    --with-stream \</span><br><span class="line">    --with-stream_ssl_module \</span><br><span class="line">    --with-stream_realip_module \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_session_sticky_module \</span><br><span class="line">    &amp;&amp; make &amp;&amp;make install</span><br><span class="line">RUN groupadd nginx&amp;&amp;useradd -g nginx nginx \</span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine-3.1.0 /app/tools/tengine \   </span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br><span class="line">RUN rm -fr /var/cache/* &amp;&amp; rm -rf /tmp/*</span><br><span class="line">COPY index.html /app/tools/tengine/html</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD [ &quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot; ]</span><br></pre></td></tr></table></figure><p>Dockerfile有变量</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM ubuntu:20.04</span><br><span class="line">LABEL author=&quot;相聚就是缘&quot;</span><br><span class="line">ENV</span><br><span class="line">RUN apt update -y \</span><br><span class="line">    &amp;&amp; apt install wget -y</span><br><span class="line">RUN wget https://mirrors.tuna.tsinghua.edu.cn/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb \</span><br><span class="line">    &amp;&amp; dpkg -i ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line"></span><br><span class="line">RUN cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换</span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># 预发布软件源，不建议启用</span><br><span class="line"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">RUN apt update -y &amp;&amp; apt upgrade -y \</span><br><span class="line">    &amp;&amp;wget https://tengine.taobao.org/download/tengine-3.1.0.tar.gz -P /tmp/ \</span><br><span class="line">    &amp;&amp; tar xf /tmp/tengine-3.1.0.tar.gz -C /tmp/ \</span><br><span class="line">    &amp;&amp; apt-get install -y libssl-dev make gcc pcre2-utils libpcre3-dev zlib1g-dev \</span><br><span class="line">    &amp;&amp; cd /tmp/tengine-3.1.0/ \</span><br><span class="line">    &amp;&amp; ./configure --prefix=/app/tools/tengine-3.1.0/ \</span><br><span class="line">    --user=nginx \</span><br><span class="line">    --group=nginx \</span><br><span class="line">    --with-http_ssl_module \</span><br><span class="line">    --with-http_v2_module \</span><br><span class="line">    --with-http_realip_module \</span><br><span class="line">    --with-http_stub_status_module \</span><br><span class="line">    --with-http_mp4_module \</span><br><span class="line">    --with-stream \</span><br><span class="line">    --with-stream_ssl_module \</span><br><span class="line">    --with-stream_realip_module \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_check_module/ \</span><br><span class="line">    --add-module=modules/ngx_http_upstream_session_sticky_module \</span><br><span class="line">    &amp;&amp; make &amp;&amp;make install</span><br><span class="line">RUN groupadd nginx&amp;&amp;useradd -g nginx nginx \</span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine-3.1.0 /app/tools/tengine \   </span><br><span class="line">    &amp;&amp;ln -s /app/tools/tengine/sbin/nginx /sbin/</span><br><span class="line">RUN rm -fr /var/cache/* &amp;&amp; rm -rf /tmp/*</span><br><span class="line">COPY index.html /app/tools/tengine/html</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD [ &quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot; ]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;系统ubuntu20.04&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apt </summary>
      
    
    
    
    <category term="ssh" scheme="http://example.com/categories/ssh/"/>
    
    
    <category term="ssh" scheme="http://example.com/tags/ssh/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>linux基础</title>
    <link href="http://example.com/2024/04/25/linux/linux/"/>
    <id>http://example.com/2024/04/25/linux/linux/</id>
    <published>2024-04-24T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.874Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-基础知识"><a href="#1-基础知识" class="headerlink" title="1 基础知识"></a>1 基础知识</h1><h2 id="1-1-linux发行版"><a href="#1-1-linux发行版" class="headerlink" title="1.1 linux发行版"></a>1.1 linux发行版</h2><blockquote><p>本文基于centos7</p></blockquote><p> <strong>Linux的发行版本可以大体分为两类，一类是商业公司维护的发行版本，一类是社区组织维护的发行版本</strong></p><p><strong>目前常用的还是centos和ubuntu</strong></p><h4 id="Debian系列"><a href="#Debian系列" class="headerlink" title="Debian系列"></a><strong>Debian系列</strong></h4><ul><li><p>Debian：以其稳定性著称，是许多其他发行版（如Ubuntu）的基础。它遵循严格的自由软件原则，有着庞大的软件包库。</p></li><li><p>Ubuntu：基于Debian，以其用户友好和广泛的社区支持而流行，适合桌面用户和云环境。Ubuntu有多个变种，如Kubuntu（使用KDE桌面环境）、Xubuntu（使用Xfce）等。</p></li><li><p>Linux Mint：基于Ubuntu和Debian的发行版，以其易用性和美观的界面而受到好评。</p></li><li><p>Deepin：基于Debian的发行版，提供现代化的桌面环境和丰富的功能。</p></li></ul><h4 id="Redhat系列"><a href="#Redhat系列" class="headerlink" title="Redhat系列"></a><strong>Redhat系列</strong></h4><ul><li>Red Hat Enterprise Linux (RHEL)：面向企业级市场的发行版，以其出色的稳定性和技术支持闻名。CentOS曾是它的免费克隆版，但CentOS项目已转向CentOS Stream，作为RHEL的上游开发分支。</li><li>Fedora：由Red Hat赞助，是创新技术和软件的试验场，很多新技术会在Fedora中先行测试，之后可能被纳入RHEL。</li><li>CentOS 是基于Red Hat Enterprise Linux源代码构建的开源Linux发行版，继承了RHEL的稳定性和可靠性，同时提供了丰富的软件包资源和灵活的定制选项。CentOS经过严格的测试和验证，确保系统的高度稳定性和可靠性，适用于企业级应用。</li></ul><h4 id="Arch-Linux系列："><a href="#Arch-Linux系列：" class="headerlink" title="Arch Linux系列："></a><strong>Arch Linux系列</strong>：</h4><ul><li>Arch Linux：面向高级用户和开发者，提供滚动更新的包管理系统和灵活的配置选项。</li><li>Manjaro：基于Arch Linux，但更注重用户友好性和易用性。</li></ul><h4 id="openSUSE系列"><a href="#openSUSE系列" class="headerlink" title="openSUSE系列"></a><strong>openSUSE系列</strong></h4><ul><li><p>openSUSE Leap：这是openSUSE的长期支持（LTS）版本，强调稳定性与安全性。Leap基于SUSE Linux Enterprise（SLE）的源代码，这意味着它拥有企业级的稳定性和兼容性。适合那些需要一个长期稳定环境的用户，如企业服务器部署或那些不希望频繁更新系统的桌面用户。</p></li><li><p>openSUSE Tumbleweed：这是一个滚动发布的版本，意味着用户可以获得最新的软件包和技术更新，无需等待新版本发布。Tumbleweed适合喜欢尝鲜、追求最新软件特性的开发者和爱好者。由于其滚动更新的特性，系统始终处于最新状态，但也可能包含较新的、未经长时间测试的软件包。</p></li></ul><h4 id="国产系统系列"><a href="#国产系统系列" class="headerlink" title="国产系统系列"></a><strong>国产系统系列</strong></h4><ul><li><p>优麒麟（UbuntuKylin）：基于Ubuntu的发行版，由中国CCN开源创新联合实验室与天津麒麟信息技术有限公司主导开发。它集成了大量符合中国用户习惯的软件和服务，如WPS Office、搜狗输入法等。</p></li><li><p>统一操作系统（UOS）：由多家中国企业如中国电子、武汉深之度、南京诚迈、中兴新支点等联合打造的Linux发行版，旨在提供一个统一、高效、安全的国产操作系统平台，广泛应用于政府、金融、教育等多个领域。</p></li><li><p>深度操作系统（Deepin）：由武汉深之度科技有限公司开发，以其美观的用户界面和良好的用户体验著称，特别适合桌面用户。Deepin操作系统内置了深度商店、深度音乐、深度影院等一整套自主开发的应用程序。</p></li><li><p>中标麒麟（NeoKylin）：由原中标软件和银河麒麟合并而成，主要面向中国政府和企业的服务器市场，提供高安全性、可靠性的解决方案。中标麒麟系统在政府机关、国防、能源、金融等行业有广泛应用。</p></li><li><p>红旗Linux：由中科红旗软件公司发行，属于Debian系，具有较长的历史，在国内有一定的市场份额，尤其在政府和教育行业有应用。</p></li></ul><h2 id="1-2-linux的目录结构"><a href="#1-2-linux的目录结构" class="headerlink" title="1.2 linux的目录结构"></a>1.2 linux的目录结构</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/：这是Linux文件系统的根目录，是所有其他目录的起点。</span><br><span class="line">/bin：此目录存放着用户二进制文件，也就是可执行文件。系统所需要的那些命令位于此目录或/sbin目录下。</span><br><span class="line">/boot：这个目录存放启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。</span><br><span class="line">/dev：此目录包含了Linux系统中所有的设备文件。如硬盘用系统的第一块硬盘称为/dev/hda，第二块称为/dev/hdb等；光驱称为/dev/hdc等。</span><br><span class="line">/etc：这个目录是整个Linux系统最为关键的一个目录，几乎所有的系统配置文件都在这里。例如用户账户和密码文件、各种服务的配置文件等。</span><br><span class="line">/home：此目录是用户的宿主目录，是用户自己的文件存放目录。每个用户都有自己的目录，名称通常是以用户的账号命名的。</span><br><span class="line">/lib：这个目录存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。</span><br><span class="line">/media：Linux系统会自动识别一些设备，例如U盘、光驱等，当识别后，Linux会把识别的设备挂载到这个目录下。</span><br><span class="line">/mnt：临时挂载文件系统的目录，系统管理员可以临时将别的文件系统挂在这个目录下。</span><br><span class="line">/opt：这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。</span><br><span class="line">/proc：此目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。</span><br><span class="line">/root：这是系统管理员（root）的家目录。</span><br><span class="line">/sbin：s就是Super User的意思，是超级用户使用的命令。这里存放的是系统管理员使用的系统管理程序。</span><br><span class="line">/srv：该目录存放一些服务启动之后需要提取的数据。</span><br><span class="line">/sys：这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。该文件系统是内核设备树的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。</span><br><span class="line">/tmp：这个目录是用来存放一些临时文件的。</span><br><span class="line">/usr：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。</span><br><span class="line">/var：这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。</span><br></pre></td></tr></table></figure><p>2.基础命令</p><p>man 命令</p><p>如：man ls</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd,ls</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">df,du,</span><br></pre></td></tr></table></figure><p>head,tail</p><p>history</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shutdown –h now</span><br><span class="line">init 0</span><br><span class="line">halt</span><br></pre></td></tr></table></figure><p>mkdir,touch创建文件和文件夹</p><p>sc,scp,mv复制 跨主机复制 ，移动</p><p>echo,sudo,cat输入，提权，查看文件内容</p><p>pwd，当前文件路径</p><p>yum,apt,dnf,yarn 软件源</p><p>less,more翻页</p><p>vim,vi 编辑文本</p><p>wget,curl 请求</p><p>awk,sed,grep</p><p>|,</p><p>tar,unzip,</p><p>systemctl</p><p>chmod</p><p>lscpu查看cpu信息</p><p>men,find</p><p>检查网口<br>ss -lntup |grep 80<br>#检查进程<br>ps -ef |grep nginx</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-基础知识&quot;&gt;&lt;a href=&quot;#1-基础知识&quot; class=&quot;headerlink&quot; title=&quot;1 基础知识&quot;&gt;&lt;/a&gt;1 基础知识&lt;/h1&gt;&lt;h2 id=&quot;1-1-linux发行版&quot;&gt;&lt;a href=&quot;#1-1-linux发行版&quot; class=&quot;head</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>vscode ssh连接报错</title>
    <link href="http://example.com/2024/04/25/windows/vscode/"/>
    <id>http://example.com/2024/04/25/windows/vscode/</id>
    <published>2024-04-24T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:23.601Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">运行命令 remote-explorer.configureSsh 错误: 发生了系统错误 (EPERM: operation not permitted, mkdir &#x27;C:\Users\Administrator&#x27;)。这可能是由提交 remote-explorer.configureSsh 的扩展引起的。</span><br></pre></td></tr></table></figure><p>解决方法</p><p>将vscode以管理员运行即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;运行命令 remote-explorer.configureSsh 错误: 发生了系统错误 (EPERM</summary>
      
    
    
    
    <category term="windows" scheme="http://example.com/categories/windows/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="windows" scheme="http://example.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>shell脚本</title>
    <link href="http://example.com/2024/04/16/linux/shell%E8%84%9A%E6%9C%AC/"/>
    <id>http://example.com/2024/04/16/linux/shell%E8%84%9A%E6%9C%AC/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.533Z</updated>
    
    <content type="html"><![CDATA[<h4 id="批量获取ip地址的"><a href="#批量获取ip地址的" class="headerlink" title="批量获取ip地址的"></a>批量获取ip地址的</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip a s ens33 | awk -F &#x27;[ /]+&#x27; &#x27;NR==3&#123;print $3&#125;&#x27;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;批量获取ip地址的&quot;&gt;&lt;a href=&quot;#批量获取ip地址的&quot; class=&quot;headerlink&quot; title=&quot;批量获取ip地址的&quot;&gt;&lt;/a&gt;批量获取ip地址的&lt;/h4&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;t</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="linux - 笔记" scheme="http://example.com/tags/linux-%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>nfs安装与配置</title>
    <link href="http://example.com/2024/04/16/linux/nfs/"/>
    <id>http://example.com/2024/04/16/linux/nfs/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:25.150Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查看系统是否已安装NFS"><a href="#查看系统是否已安装NFS" class="headerlink" title="查看系统是否已安装NFS"></a>查看系统是否已安装NFS</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -qa | grep nfs</span><br><span class="line">rpm -qa | grep rpcbind</span><br></pre></td></tr></table></figure><h1 id="安装nfs相关服务软件包"><a href="#安装nfs相关服务软件包" class="headerlink" title="安装nfs相关服务软件包"></a>安装nfs相关服务软件包</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install -y nfs-utils rpcbind</span><br></pre></td></tr></table></figure><h1 id="验证系统是否成功安装NFS"><a href="#验证系统是否成功安装NFS" class="headerlink" title="验证系统是否成功安装NFS"></a>验证系统是否成功安装NFS</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@node2 ~]# rpm -qa | grep nfs</span><br><span class="line">libnfsidmap-0.25-19.el7.x86_64</span><br><span class="line">nfs-utils-1.3.0-0.68.el7.2.x86_64</span><br><span class="line">[root@node2 ~]# rpm -qa | grep rpcbind</span><br><span class="line">rpcbind-0.2.0-49.el7.x86_64</span><br></pre></td></tr></table></figure><h1 id="创建共享存储文件夹"><a href="#创建共享存储文件夹" class="headerlink" title="创建共享存储文件夹"></a>创建共享存储文件夹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p /pythons/nfs</span><br></pre></td></tr></table></figure><h1 id="配置nfs"><a href="#配置nfs" class="headerlink" title="配置nfs"></a>配置nfs</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 输入以下内容，格式为：nfs共享目录 nfs客户端地址1(param1, param2,...) nfs客户端地址2(param1, param2,...)</span><br><span class="line"># 如: /data/nfs 10.0.0.200/24(rw,async,no_root_squash)</span><br><span class="line"># 固定网段所有IP可挂载</span><br><span class="line">echo &quot;/pythons/nfs *(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"># 固定网段固定IP区间可挂载</span><br><span class="line">echo &quot;/data/nfs 10.0.0.200/24(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"></span><br><span class="line"># 所有客户端可挂载</span><br><span class="line">echo &quot;/data/nfs *(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</span><br><span class="line"># 启动服务</span><br><span class="line"># 先启动rpc服务，再启动nfs服务</span><br><span class="line"># 加入开始自启动</span><br><span class="line">systemctl enable rpcbind &amp;&amp; systemctl start rpcbind</span><br><span class="line">systemctl enable nfs &amp;&amp; systemctl start nfs</span><br><span class="line"> </span><br><span class="line">#使nfs配置生效</span><br><span class="line">exportfs -r</span><br><span class="line"> </span><br><span class="line"># 查看服务状态</span><br><span class="line">systemctl status rpcbind</span><br><span class="line">systemctl status nfs</span><br></pre></td></tr></table></figure><h3 id="rsync报错解决rsync-mkstemp-failed-Permission-denied-13"><a href="#rsync报错解决rsync-mkstemp-failed-Permission-denied-13" class="headerlink" title="rsync报错解决rsync: mkstemp *******  failed: Permission denied (13)"></a>rsync报错解决rsync: mkstemp *******  failed: Permission denied (13)</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@backup tmp]#rsync -avz /etc/hostname rsync_backup@10.0.0.41::data</span><br><span class="line">Password: </span><br><span class="line">sending incremental file list</span><br><span class="line">hostname</span><br><span class="line">rsync: mkstemp <span class="string">&quot;.hostname.Qo7WQD&quot;</span> (<span class="keyword">in</span> data) failed: Permission denied (13)</span><br><span class="line"></span><br><span class="line">sent 101 bytes  received 122 bytes  63.71 bytes/sec</span><br><span class="line">total size is 7  speedup is 0.03</span><br><span class="line">rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1179) [sender=3.1.2]</span><br></pre></td></tr></table></figure><h4 id="1-data文件夹权限问题"><a href="#1-data文件夹权限问题" class="headerlink" title="1.data文件夹权限问题"></a>1.data文件夹权限问题</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@backup data]# <span class="built_in">ls</span> -ld</span><br><span class="line">drwxr-xr-x. 2 root root 6 Apr 13 01:16 .</span><br></pre></td></tr></table></figure><p>使用 <strong>sudo chmod 777 &#x2F;data</strong>即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;查看系统是否已安装NFS&quot;&gt;&lt;a href=&quot;#查看系统是否已安装NFS&quot; class=&quot;headerlink&quot; title=&quot;查看系统是否已安装NFS&quot;&gt;&lt;/a&gt;查看系统是否已安装NFS&lt;/h1&gt;&lt;figure class=&quot;highlight plaintex</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>docker安装和配置</title>
    <link href="http://example.com/2024/04/16/linux/dokcer/"/>
    <id>http://example.com/2024/04/16/linux/dokcer/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.497Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>基于centos7的安装与配置<br>yum install -y yum-utils device-mapper-persistentdata lvm2<br>#2.下载官方的docker yum源文件<br>yum-config-manager –add-repo <a href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a><br>#3.替换yum源地址 docker-ce.repo<br>#4.安装docker-ce<br>yum install -y docker-ce<br>systemctl enable –now docker<br>docker version<br>#配置镜像加速<br>yum-config-manager –add-repo <a href="http://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo">http://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo</a><br>yum install -y yum-utils<br>yum-config-manager –add-repo <a href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a><br>sed -i ‘s+<a href="https://download.docker.com+https//mirrors.tuna.tsinghua.edu.cn/docker-ce+">https://download.docker.com+https://mirrors.tuna.tsinghua.edu.cn/docker-ce+</a>‘ &#x2F;etc&#x2F;yum.repos.d&#x2F;docker-ce.repo</p></blockquote><p>sudo mkdir -p &#x2F;etc&#x2F;docker<br>cat &gt; &#x2F;etc&#x2F;docker&#x2F;daemon.json &lt;&lt;’EOF’<br>{<br>  “registry-mirrors”: [<br>    “<a href="https://registry.docker-cn.com/">https://registry.docker-cn.com</a>“,<br>    “<a href="http://hub-mirror.c.163.com/">http://hub-mirror.c.163.com</a>“,<br>    “<a href="https://dockerhub.azk8s.cn/">https://dockerhub.azk8s.cn</a>“,<br>    “<a href="https://mirror.ccs.tencentyun.com/">https://mirror.ccs.tencentyun.com</a>“,<br>    “<a href="https://registry.cn-hangzhou.aliyuncs.com/">https://registry.cn-hangzhou.aliyuncs.com</a>“,<br>    “<a href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a>“,<br>    “<a href="https://docker.m.daocloud.io/">https://docker.m.daocloud.io</a>“,<br>    “<a href="https://noohub.ru/">https://noohub.ru</a>“,<br>    “<a href="https://huecker.io/">https://huecker.io</a>“,<br>    “<a href="https://dockerhub.timeweb.cloud/">https://dockerhub.timeweb.cloud</a>“<br>  ]<br>}</p><p>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p><p>docker search 搜索镜像, 优先选官方,stars数量多<br>docker pull 拉取镜像(下载镜像)，注意版本<br>docker push 推送镜像(上传镜像)<br>docker load 导入镜像 例子:<br>    docker load -i docker_nginx.tar.gz docker save<br>导出镜像 例子:<br>    docker save centos:7 -o docker_centos7.tar.gz<br>docker images 查看镜像列表<br>docker rmi 删除镜像<br>docker tag 给镜像打标签</p><p>docker ps 查看容器列表 -a 查看所有容器<br>docker run 创建并运行容器<br>    例子:docker run -d -it -p 80:80 nginx:latest docker<br>create 创建容器<br>name docker start 启动容器<br>docker stop 停止容器<br>docker restart 重启容器<br>docker kill 强制停止容器<br>docker rm 删除容器 批量删除所有容器<br>docker rm -f <code>docker ps -a -q</code> docker exec 进入正在运行的容器(分配一个新终端) 例子:<br>    docker exec -it 容器id&#x2F;容器名字 &#x2F;bin&#x2F;bash(&#x2F;bin&#x2F;sh) docker attach 进入正在运行的容器(使用相同的终端),偷偷离开 的快捷键ctrl +p,ctrl +q<br>inspect stats</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">前台运行 nginx -g &#x27;daemon off;&#x27; nginx前台运行. /usr/sbin/php-fpm nodaemonize php前台运行. /usr/sbin/sshd -D  ssh前台运行. java -jar xxx.jar  java前台运行.</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@docker01 ~]# docker ps |awk &#x27;NR&gt;1&#123;print $1&#125;&#x27;</span><br><span class="line">a78b89faa502</span><br><span class="line">7f7b245ea594</span><br><span class="line">[root@docker01 ~]# docker ps -q</span><br><span class="line">a78b89faa502</span><br><span class="line">7f7b245ea594</span><br></pre></td></tr></table></figure><p>docker run -d name “oldboy_mysql5.7” -e MYSQL_ROOT_PASSWORD&#x3D;1 mysql:5.7-debian</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;基于centos7的安装与配置&lt;br&gt;yum install -y yum-utils device-mapper-persistentdata lvm2&lt;br&gt;#2.下载官方的docker yum源文件&lt;br&gt;yum-config-manager</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
    <category term="centos7" scheme="http://example.com/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>ansible安装和配置</title>
    <link href="http://example.com/2024/04/16/linux/ansible/"/>
    <id>http://example.com/2024/04/16/linux/ansible/</id>
    <published>2024-04-15T16:00:00.000Z</published>
    <updated>2024-12-11T14:51:24.235Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、ansible安装和配置"><a href="#一、ansible安装和配置" class="headerlink" title="一、ansible安装和配置"></a>一、ansible安装和配置</h1><blockquote><p>Ansible 是一款 IT 自动化工具。主要应用场景有配置系统、软件部署、持续发布及不停服平滑滚动更新的高级任务编排。</p></blockquote><h2 id="1-1-检查epel是否安装，没安装即安装"><a href="#1-1-检查epel是否安装，没安装即安装" class="headerlink" title="1.1 检查epel是否安装，没安装即安装"></a>1.1 检查epel是否安装，没安装即安装</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum list | grep epel-release</span><br><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure><h2 id="1-2-配置epel清华镜像源"><a href="#1-2-配置epel清华镜像源" class="headerlink" title="1.2 配置epel清华镜像源"></a>1.2 配置epel清华镜像源</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sed -e &#x27;s!^metalink=!#metalink=!g&#x27;     -e &#x27;s!^#baseurl=!baseurl=!g&#x27;     -e &#x27;s!https\?://download\.fedoraproject\.org/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -e &#x27;s!https\?://download\.example/pub/epel!https://mirrors.tuna.tsinghua.edu.cn/epel!g&#x27;     -i /etc/yum.repos.d/epel&#123;,-testing&#125;.repo</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure><h2 id="1-3-安装ansible"><a href="#1-3-安装ansible" class="headerlink" title="1.3 安装ansible"></a>1.3 安装ansible</h2>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install ansible –y</span><br></pre></td></tr></table></figure><h3 id="1-3-1-修改配置ansible配置文件"><a href="#1-3-1-修改配置ansible配置文件" class="headerlink" title="1.3.1 修改配置ansible配置文件"></a>1.3.1 修改配置ansible配置文件</h3><blockquote><p> <strong>vim &#x2F;etc&#x2F;ansible&#x2F;ansible.cfg</strong> 修改这个文件即可</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">71:host_key_checking = False </span><br><span class="line">111:log_path = /var/log/ansible.log </span><br></pre></td></tr></table></figure><h3 id="1-3-2-添加ansible的主机清单"><a href="#1-3-2-添加ansible的主机清单" class="headerlink" title="1.3.2 添加ansible的主机清单"></a>1.3.2 添加ansible的主机清单</h3><blockquote><p> <strong>vim &#x2F;etc&#x2F;ansible&#x2F;hosts</strong> 修改这个文件即可</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[web] </span><br><span class="line">172.16.1.7 </span><br><span class="line">[backup] </span><br><span class="line">172.16.1.41 </span><br><span class="line">[nfs] </span><br><span class="line">172.16.1.31</span><br></pre></td></tr></table></figure><h1 id="二、ansible命令模块"><a href="#二、ansible命令模块" class="headerlink" title="二、ansible命令模块"></a>二、ansible命令模块</h1><p>这是 <a href="https://docs.ansible.com/ansible/latest/module_plugin_guide/index.html">官方文档链接</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible-doc -l ##查看ansible已安装的模块</span><br><span class="line">ansible-doc 模块名 ##能看到模块详细信息</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m command -a &quot;hostname&quot;</span><br></pre></td></tr></table></figure><table><thead><tr><th><strong>all</strong></th><th><strong>指定所有主机,可以改为可以替换<code>all</code>为其他主机组的名称或者ip地址</strong></th></tr></thead><tbody><tr><td><strong>-m</strong></td><td><strong>指定要使用的模块</strong></td></tr><tr><td><strong>command</strong></td><td><strong>使用的模块</strong></td></tr><tr><td><strong>-a</strong></td><td><strong>传递给模块的参数</strong></td></tr><tr><td><strong>“hostname”</strong></td><td><strong>shell远程主机上执行的具体命令</strong></td></tr></tbody></table><h2 id="2-1-command模块"><a href="#2-1-command模块" class="headerlink" title="2.1 command模块"></a><strong>2.1 command模块</strong></h2><ul><li><strong>默认的模块，适合执行简单命令，不支持特殊符号</strong></li></ul><blockquote><p> <strong>2.1.1 例子：获取ip地址和主机名</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m command -a &quot;ip a s ens33&quot;</span><br><span class="line">ansible all -m command -a &quot;hostname&quot;</span><br></pre></td></tr></table></figure><h2 id="2-2-shell模块"><a href="#2-2-shell模块" class="headerlink" title="2.2 shell模块"></a><strong>2.2 shell模块</strong></h2><ul><li><strong>与command 类似，但是支持特殊符号</strong></li></ul><blockquote><h2 id="2-2-1-例子：ansible批量获取ip地址"><a href="#2-2-1-例子：ansible批量获取ip地址" class="headerlink" title="2.2.1 例子：ansible批量获取ip地址"></a><strong>2.2.1 例子：ansible批量获取ip地址</strong></h2></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m shell -a &quot;ip a s ens33 | awk -F &#x27;[ /]+&#x27; &#x27;NR==3&#123;print \$3&#125;&#x27;&quot;</span><br></pre></td></tr></table></figure><h2 id="2-3-script模块"><a href="#2-3-script模块" class="headerlink" title="2.3 script模块"></a><strong>2.3 script模块</strong></h2><ul><li><strong>分发脚本和运行脚本</strong></li></ul><blockquote><p> <strong>2.3.1例子 给前面几个还是比较相似的,分发脚本</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@m01 server_sh]# cat ansible_no.sh </span><br><span class="line">#!/bin/bash</span><br><span class="line">hostname</span><br><span class="line">hostname -I</span><br><span class="line">hostname -i</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ansible all -m script -a &#x27;/root/server_sh/ansible_no.sh&#x27;</span><br></pre></td></tr></table></figure><h2 id="2-4-file模块"><a href="#2-4-file模块" class="headerlink" title="2.4 file模块"></a><strong>2.4 file模块</strong></h2><ul><li><strong>管理文件,管理目录,软连接</strong></li><li>详细看这个<a href="https://docs.ansible.com/ansible/2.9/modules/file_module.html">https://docs.ansible.com/ansible/2.9/modules/file_module.html</a></li></ul><blockquote><p> <strong>参数：ansible all -m file -a ‘path&#x3D;&#x2F;opt&#x2F;li.txt state&#x3D;touch’</strong></p></blockquote><table><thead><tr><th align="left"></th><th align="center"><strong>选项</strong></th></tr></thead><tbody><tr><td align="left"><strong>path 路径</strong></td><td align="center"><strong>文件或者目录的路径</strong></td></tr><tr><td align="left"><strong>state状态</strong></td><td align="center"><strong>➖touch创建文件<br />➖directory创建目录<br />➖absent删除目标文件<br />➖file(默认)更新文件<br /> ➖hard创建或更改硬链接与src一起使用<br />➖link创建或更改软链接与src一起使用<br /></strong></td></tr><tr><td align="left"><strong>src</strong></td><td align="center"><strong>要链接到的文件的路径</strong></td></tr><tr><td align="left"><strong>owner</strong></td><td align="center"><strong>设备目标文件的所属主</strong></td></tr><tr><td align="left"><strong>mode</strong></td><td align="center"><strong>生成的文件或目录应具有的权限</strong></td></tr><tr><td align="left"><strong>grounp</strong></td><td align="center"><strong>设备目标文件的所属组</strong></td></tr></tbody></table><blockquote><p>2.4.1 创建文件</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/opt/ceshi.txt state=touch&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.2 创建目录</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/app/a/b/ state=directory&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.3 软连接</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;src=/etc/hosts path=/opt/hosts state=link&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.4 创建文件,给予700权限,指定用户(前提:创建指定用户)</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/ans-backup/ owner=oldbo y group=oldboy mode=700 state=directory&#x27;</span><br></pre></td></tr></table></figure><blockquote><p>2.4.5 删除文件夹</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m file -a &#x27;path=/ans-backup/ state=absent&#x27;</span><br></pre></td></tr></table></figure><h2 id="2-5-copy"><a href="#2-5-copy" class="headerlink" title="2.5 copy"></a><strong>2.5 copy</strong></h2><ul><li><strong>远程分发文件,修改权限,所有者,备份 服务</strong> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ansible all -m copy -a &#x27;src=/etc/hosts dest=/etc/hosts backup=yes&#x27;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-6-systemd"><a href="#2-6-systemd" class="headerlink" title="2.6 systemd"></a><strong>2.6 systemd</strong></h2><ul><li><strong>服务管理</strong></li></ul><h2 id="2-7-service-服务管理-了解-软件包"><a href="#2-7-service-服务管理-了解-软件包" class="headerlink" title="2.7 service 服务管理(了解) 软件包"></a><strong>2.7 service 服务管理(了解) 软件包</strong></h2><h2 id="2-8-yum源-yum-repository"><a href="#2-8-yum源-yum-repository" class="headerlink" title="2.8 yum源 yum_repository"></a><strong>2.8 yum源 yum_repository</strong></h2><h2 id="2-9-yum命令"><a href="#2-9-yum命令" class="headerlink" title="2.9 yum命令"></a><strong>2.9 yum命令</strong></h2><h2 id="get-url下载软件-系统管理"><a href="#get-url下载软件-系统管理" class="headerlink" title="get_url下载软件 系统管理"></a><strong>get_url下载软件 系统管理</strong></h2><h2 id="mount模块-挂载"><a href="#mount模块-挂载" class="headerlink" title="mount模块 挂载"></a><strong>mount模块 挂载</strong></h2><h2 id="cron模块-定时任务-用户管理"><a href="#cron模块-定时任务-用户管理" class="headerlink" title="cron模块 定时任务 用户管理"></a><strong>cron模块 定时任务 用户管理</strong></h2><h2 id="group模块-管理用户组"><a href="#group模块-管理用户组" class="headerlink" title="group模块 管理用户组"></a><strong>group模块 管理用户组</strong></h2><h2 id="user模块-管理用户"><a href="#user模块-管理用户" class="headerlink" title="user模块 管理用户"></a><strong>user模块 管理用户</strong></h2><h2 id="压缩解压-unarchive"><a href="#压缩解压-unarchive" class="headerlink" title="压缩解压(unarchive) ,"></a><strong>压缩解压(unarchive) ,</strong></h2><h2 id="rsync模块-synchronize"><a href="#rsync模块-synchronize" class="headerlink" title="rsync模块(synchronize),"></a><strong>rsync模块(synchronize),</strong></h2><h2 id="数据库模块-mysql-db-mysql-user"><a href="#数据库模块-mysql-db-mysql-user" class="headerlink" title="数据库模块(mysql_db,mysql_user)"></a><strong>数据库模块(mysql_db,mysql_user)</strong></h2><h2 id="ansible管理docker-k8s-zabbix-grafana"><a href="#ansible管理docker-k8s-zabbix-grafana" class="headerlink" title="ansible管理docker k8s zabbix grafana"></a><strong>ansible管理docker k8s zabbix grafana</strong></h2><h2 id="用于调试模块-ping-模块检查"><a href="#用于调试模块-ping-模块检查" class="headerlink" title="用于调试模块 ping 模块检查"></a><strong>用于调试模块 ping 模块检查</strong></h2><h2 id="ansible与其他节点连通性"><a href="#ansible与其他节点连通性" class="headerlink" title="ansible与其他节点连通性."></a><strong>ansible与其他节点连通性.</strong></h2><h2 id="debug-模块-用于检查-显示-变量"><a href="#debug-模块-用于检查-显示-变量" class="headerlink" title="debug 模块 用于检查&#x2F;显示 变量"></a><strong>debug 模块 用于检查&#x2F;显示 变量</strong></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;一、ansible安装和配置&quot;&gt;&lt;a href=&quot;#一、ansible安装和配置&quot; class=&quot;headerlink&quot; title=&quot;一、ansible安装和配置&quot;&gt;&lt;/a&gt;一、ansible安装和配置&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Ansible 是</summary>
      
    
    
    
    <category term="linux" scheme="http://example.com/categories/linux/"/>
    
    
    <category term="笔记" scheme="http://example.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
</feed>
